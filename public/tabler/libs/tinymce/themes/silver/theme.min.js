!function(){"use strict";const Ey=Object.getPrototypeOf,B0=(e,t,n)=>{var s;return!!n(e,t.prototype)||(null===(s=e.constructor)||void 0===s?void 0:s.name)===t.name},tl=e=>t=>(e=>{const t=typeof e;return null===e?"null":"object"===t&&Array.isArray(e)?"array":"object"===t&&B0(e,String,(e,t)=>t.isPrototypeOf(e))?"string":t})(t)===e,sl=e=>t=>typeof t===e,d2=e=>t=>e===t,L=tl("string"),os=tl("object"),f3=e=>((e,t)=>os(e)&&B0(e,t,(e,t)=>Ey(e)===t))(e,Object),bs=tl("array"),qr=d2(null),Tn=sl("boolean"),ts=d2(void 0),Or=e=>e==null,Wt=e=>!Or(e),At=sl("function"),Ss=sl("number"),ga=(e,t)=>{if(bs(e)){for(let n=0,s=e.length;n<s;++n)if(!t(e[n]))return!1;return!0}return!1},c=()=>{},gd=(e,t)=>(...n)=>e(t.apply(null,n)),n=e=>()=>e,z=e=>e,o5=(e,t)=>e===t;function Nt(e,...t){return(...n)=>{const s=t.concat(n);return e.apply(null,s)}}const Ta=e=>t=>!e(t),Pd=e=>()=>{throw new Error(e)},Pg=e=>e(),U=n(!1),Oe=n(!0);Jp=tinymce.util.Tools.resolve("tinymce.ThemeManager");class e{constructor(e,t){this.tag=e,this.value=t}static some(t){return new e(!0,t)}static none(){return e.singletonNone}fold(e,t){return this.tag?t(this.value):e()}isSome(){return this.tag}isNone(){return!this.tag}map(t){return this.tag?e.some(t(this.value)):e.none()}bind(t){return this.tag?t(this.value):e.none()}exists(e){return this.tag&&e(this.value)}forall(e){return!this.tag||e(this.value)}filter(t){return!this.tag||t(this.value)?this:e.none()}getOr(e){return this.tag?this.value:e}or(e){return this.tag?this:e}getOrThunk(e){return this.tag?this.value:e()}orThunk(e){return this.tag?this:e()}getOrDie(e){if(this.tag)return this.value;throw new Error(e??"Called getOrDie on None")}static from(t){return Wt(t)?e.some(t):e.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(e){this.tag&&e(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}}e.singletonNone=new e(!1);const Ec=Array.prototype.slice,z7=Array.prototype.indexOf,Pb=Array.prototype.push,A6=(e,t)=>z7.call(e,t),x6=(t,n)=>{const s=A6(t,n);return-1===s?e.none():e.some(s)},_e=(e,t)=>A6(e,t)>-1,nn=(e,t)=>{for(let n=0,s=e.length;n<s;n++)if(t(e[n],n))return!0;return!1},Du=(e,t)=>{const n=[];for(let s=0;s<e;s++)n.push(t(s));return n},Pf=(e,t)=>{const n=[];for(let s=0;s<e.length;s+=t){const o=Ec.call(e,s,s+t);n.push(o)}return n},a=(e,t)=>{const n=e.length,s=new Array(n);for(let o=0;o<n;o++){const i=e[o];s[o]=t(i,o)}return s},h=(e,t)=>{for(let n=0,s=e.length;n<s;n++)t(e[n],n)},n8=(e,t)=>{const n=[],s=[];for(let o=0,a=e.length;o<a;o++){const i=e[o];(t(i,o)?n:s).push(i)}return{pass:n,fail:s}},K=(e,t)=>{const n=[];for(let s=0,i=e.length;s<i;s++){const o=e[s];t(o,s)&&n.push(o)}return n},To=(e,t,n)=>(((e,t)=>{for(let n=e.length-1;n>=0;n--)t(e[n],n)})(e,(e,s)=>{n=t(n,e,s)}),n),Ie=(e,t,n)=>(h(e,(e,s)=>{n=t(n,e,s)}),n),ne=(t,n)=>((t,n,s)=>{for(let o=0,a=t.length;o<a;o++){const i=t[o];if(n(i,o))return e.some(i);if(s(i,o))break}return e.none()})(t,n,U),zo=(t,n)=>{for(let s=0,o=t.length;s<o;s++)if(n(t[s],s))return e.some(s);return e.none()},Se=e=>{const t=[];for(let n=0,s=e.length;n<s;++n){if(!bs(e[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+e);Pb.apply(t,e[n])}return t},le=(e,t)=>Se(a(e,t)),Ho=(e,t)=>{for(let n=0,s=e.length;n<s;++n)if(!0!==t(e[n],n))return!1;return!0},xa=e=>{const t=Ec.call(e,0);return t.reverse(),t},Hs=(e,t)=>K(e,e=>!_e(t,e)),W2=(e,t)=>{const n={};for(let s=0,i=e.length;s<i;s++){const o=e[s];n[String(o)]=t(o,s)}return n},JO=e=>[e],T2=(e,t)=>{const n=Ec.call(e,0);return n.sort(t),n},fr=(t,n)=>n>=0&&n<t.length?e.some(t[n]):e.none(),Zn=e=>fr(e,0),d4=e=>fr(e,e.length-1),gx=At(Array.from)?Array.from:e=>Ec.call(e),wn=(t,n)=>{for(let e=0;e<t.length;e++){const s=n(t[e],e);if(s.isSome())return s}return e.none()},ce=Object.keys,Ux=Object.hasOwnProperty,Re=(e,t)=>{const n=ce(e);for(let s=0,i=n.length;s<i;s++){const o=n[s];t(e[o],o)}},je=(e,t)=>P0(e,(e,n)=>({k:n,v:t(e,n)})),P0=(e,t)=>{const n={};return Re(e,(e,s)=>{const o=t(e,s);n[o.k]=o.v}),n},f4=e=>(t,n)=>{e[n]=t},A0=(e,t,n,s)=>{Re(e,(e,o)=>{(t(e,o)?n:s)(e,o)})},t3=(e,t)=>{const n={};return A0(e,t,f4(n),c),n},Kr=(e,t)=>{const n=[];return Re(e,(e,s)=>{n.push(t(e,s))}),n},Y1=(t,n)=>{const s=ce(t);for(let o=0,r=s.length;o<r;o++){const i=s[o],a=t[i];if(n(a,i,t))return e.some(a)}return e.none()},H1=e=>Kr(e,z),f=(t,n)=>R(t,n)?e.from(t[n]):e.none(),R=(e,t)=>Ux.call(e,t),Gt=(e,t)=>R(e,t)&&void 0!==e[t]&&null!==e[t],sn=(e,t,n=o5)=>e.exists(e=>n(e,t)),so=e=>{const t=[],n=e=>{t.push(e)};for(let t=0;t<e.length;t++)e[t].each(n);return t},ic=(t,n,s)=>t.isSome()&&n.isSome()?e.some(s(t.getOrDie(),n.getOrDie())):e.none(),Li=(t,n)=>t?e.some(n):e.none(),T8=(e,t,n)=>""===t||e.length>=t.length&&e.substr(n,n+t.length)===t,Ze=(e,t,n=0,s)=>{const o=e.indexOf(t,n);return-1!==o&&(!!ts(s)||o+t.length<=s)},cc=(e,t)=>T8(e,t,e.length-t.length),Cj=($0=/^\s+|\s+$/g,e=>e.replace($0,"")),zu=e=>e.length>0,zi=e=>void 0!==e.style&&At(e.style.getPropertyValue),hc=e=>{if(e==null)throw new Error("Node cannot be null or undefined");return{dom:e}},C9=(e,t)=>{const n=(t||document).createElement("div");if(n.innerHTML=e,!n.hasChildNodes()||n.childNodes.length>1){const t="HTML does not have a single root node";throw console.error(t,e),new Error(t)}return hc(n.childNodes[0])},ii=(e,t)=>{const n=(t||document).createElement(e);return hc(n)},yg=(e,t)=>{const n=(t||document).createTextNode(e);return hc(n)},l=hc,gv="undefined"!=typeof window?window:Function("return this;")(),kg=(e,t)=>((e,t)=>{let n=t??gv;for(let t=0;t<e.length&&n!=null;++t)n=n[e[t]];return n})(e.split("."),t),Py=Object.getPrototypeOf,Ix=e=>{const t=kg("ownerDocument.defaultView",e);return os(e)&&((e=>((e,t)=>{const n=((e,t)=>kg(e,t))(e,t);if(n==null)throw new Error(e+" not available on this browser");return n})("HTMLElement",e))(t).prototype.isPrototypeOf(e)||/^HTML\w*Element$/.test(Py(e).constructor.name))},qn=e=>e.dom.nodeName.toLowerCase(),kc=e=>t=>(e=>e.dom.nodeType)(t)===e,Ot=kc(1),to=kc(3),N9=kc(9),Z9=kc(11),tp=e=>t=>Ot(t)&&qn(t)===e,P1=(e,t)=>{const n=e.dom;if(1!==n.nodeType)return!1;{const e=n;if(void 0!==e.matches)return e.matches(t);if(void 0!==e.msMatchesSelector)return e.msMatchesSelector(t);if(void 0!==e.webkitMatchesSelector)return e.webkitMatchesSelector(t);if(void 0!==e.mozMatchesSelector)return e.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")}},$3=e=>1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType||0===e.childElementCount,G=(e,t)=>e.dom===t.dom,Zr=(e,t)=>{const n=e.dom,s=t.dom;return n!==s&&n.contains(s)},rn=e=>l(e.dom.ownerDocument),Qr=e=>N9(e)?e:rn(e),B1=e=>l(Qr(e).dom.documentElement),Vi=e=>l(Qr(e).dom.defaultView),Cn=t=>e.from(t.dom.parentNode).map(l),Ki=t=>e.from(t.dom.parentElement).map(l),n0=t=>e.from(t.dom.offsetParent).map(l),On=e=>a(e.dom.childNodes,l),Us=(t,n)=>{const s=t.dom.childNodes;return e.from(s[n]).map(l)},J0=(e,t)=>({element:e,offset:t}),X2=(e,t)=>{const n=On(e);return n.length>0&&t<n.length?J0(n[t],0):J0(e,t)},Q1=e=>Z9(e)&&Wt(e.dom.host),U3=At(Element.prototype.attachShadow)&&At(Node.prototype.getRootNode),bw=n(U3),Tt=U3?e=>l(e.dom.getRootNode()):Qr,Ka=e=>Q1(e)?e:l(Qr(e).dom.body),Hh=t=>{const n=Tt(t);return Q1(n)?e.some(n):e.none()},X_=e=>l(e.dom.host),Xt=e=>{const t=to(e)?e.dom.parentNode:e.dom;if(t==null||null===t.ownerDocument)return!1;const o=t.ownerDocument;return Hh(l(t)).fold(()=>o.body.contains(t),(n=Xt,s=X_,e=>n(s(e))));var n,s},Hn=()=>q_(l(document)),q_=e=>{const t=e.dom.body;if(t==null)throw new Error("Body is not available yet");return l(t)},Tm=(e,t,n)=>{if(!(L(n)||Tn(n)||Ss(n)))throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",n,":: Element ",e),new Error("Attribute value was not simple");e.setAttribute(t,n+"")},_=(e,t,n)=>{Tm(e.dom,t,n)},Um=(e,t)=>{const n=e.dom;Re(t,(e,t)=>{Tm(n,t,e)})},Ne=(e,t)=>{const n=e.dom.getAttribute(t);return null===n?void 0:n},_t=(t,n)=>e.from(Ne(t,n)),Km=(e,t)=>{const n=e.dom;return!!n&&!!n.hasAttribute&&n.hasAttribute(t)},ve=(e,t)=>{e.dom.removeAttribute(t)},s1=(e,t,n)=>{if(!L(n))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",n,":: Element ",e),new Error("CSS value must be a string: "+n);zi(e)&&e.style.setProperty(t,n)},Wf=(e,t)=>{zi(e)&&e.style.removeProperty(t)},y=(e,t,n)=>{const s=e.dom;s1(s,t,n)},Go=(e,t)=>{const n=e.dom;Re(t,(e,t)=>{s1(n,t,e)})},yc=(e,t)=>{const n=e.dom;Re(t,(e,t)=>{e.fold(()=>{Wf(n,t)},e=>{s1(n,t,e)})})},ft=(e,t)=>{const n=e.dom,s=window.getComputedStyle(n).getPropertyValue(t);return""!==s||Xt(e)?s:I6(n,t)},I6=(e,t)=>zi(e)?e.style.getPropertyValue(t):"",Le=(t,n)=>{const s=t.dom,o=I6(s,n);return e.from(o).filter(e=>e.length>0)},B6=e=>{const n={},t=e.dom;if(zi(t))for(let e=0;e<t.style.length;e++){const s=t.style.item(e);n[s]=t.style[s]}return n},Fp=(e,t,n)=>{const s=ii(e);return y(s,t,n),Le(s,t).isSome()},I=(e,t)=>{const n=e.dom;Wf(n,t),sn(_t(e,"style").map(Cj),"")&&ve(e,"style")},Ai=e=>e.dom.offsetWidth,Mg=(e,t)=>{const n=n=>{const s=t(n);if(s<=0||null===s){const t=ft(n,e);return parseFloat(t)||0}return s},s=(e,t)=>Ie(t,(t,n)=>{const s=ft(e,n),o=void 0===s?0:parseInt(s,10);return isNaN(o)?t:t+o},0);return{set:(t,n)=>{if(!Ss(n)&&!n.match(/^[0-9]+$/))throw new Error(e+".set accepts only positive integer values. Value was "+n);const s=t.dom;zi(s)&&(s.style[e]=n+"px")},get:n,getOuter:n,aggregate:s,max:(e,t,n)=>{const o=s(e,n);return t>o?t-o:0}}},Jd=Mg("height",e=>{const t=e.dom;return Xt(e)?t.getBoundingClientRect().height:t.offsetHeight}),Pe=e=>Jd.get(e),Ks=e=>Jd.getOuter(e),_5=(e,t)=>({left:e,top:t,translate:(n,s)=>_5(e+n,t+s)}),ee=_5,Ja=(e,t)=>void 0!==e?e:void 0!==t?t:0,ls=e=>{const o=e.dom.ownerDocument,t=o.body,n=o.defaultView,s=o.documentElement;if(t===e.dom)return ee(t.offsetLeft,t.offsetTop);const i=Ja(n?.pageYOffset,s.scrollTop),a=Ja(n?.pageXOffset,s.scrollLeft),r=Ja(s.clientTop,t.clientTop),c=Ja(s.clientLeft,t.clientLeft);return Dd(e).translate(a-c,i-r)},Dd=e=>{const t=e.dom,n=t.ownerDocument.body;return n===t?ee(n.offsetLeft,n.offsetTop):Xt(e)?(e=>{const t=e.getBoundingClientRect();return ee(t.left,t.top)})(t):ee(0,0)},Xa=Mg("width",e=>e.dom.offsetWidth),et=e=>Xa.get(e),Ea=e=>Xa.getOuter(e),vs=e=>{let t,n=!1;return(...s)=>(n||(n=!0,t=e.apply(null,s)),t)},E7=()=>kd(0,0),kd=(e,t)=>({major:e,minor:t}),Na={nu:kd,detect:(e,t)=>{const n=String(t).toLowerCase();return 0===e.length?E7():((e,t)=>{const n=((e,t)=>{for(let n=0;n<e.length;n++){const s=e[n];if(s.test(t))return s}})(e,t);if(!n)return{major:0,minor:0};const s=e=>Number(t.replace(n,"$"+e));return kd(s(1),s(2))})(e,n)},unknown:E7},b7=(e,t)=>{const n=String(t).toLowerCase();return ne(e,e=>e.search(n))},yd=/.*?version\/ ?([0-9]+)\.([0-9]+).*/,$n=e=>t=>Ze(t,e),W7=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:e=>Ze(e,"edge/")&&Ze(e,"chrome")&&Ze(e,"safari")&&Ze(e,"applewebkit")},{name:"Chromium",brand:"Chromium",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,yd],search:e=>Ze(e,"chrome")&&!Ze(e,"chromeframe")},{name:"IE",versionRegexes:[/.*?msie ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:e=>Ze(e,"msie")||Ze(e,"trident")},{name:"Opera",versionRegexes:[yd,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:$n("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/ ?([0-9]+)\.([0-9]+).*/],search:$n("firefox")},{name:"Safari",versionRegexes:[yd,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:e=>(Ze(e,"safari")||Ze(e,"mobile/"))&&Ze(e,"applewebkit")}],Sv=[{name:"Windows",search:$n("win"),versionRegexes:[/.*?windows nt ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:e=>Ze(e,"iphone")||Ze(e,"ipad"),versionRegexes:[/.*?version\/ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:$n("android"),versionRegexes:[/.*?android ?([0-9]+)\.([0-9]+).*/]},{name:"macOS",search:$n("mac os x"),versionRegexes:[/.*?mac os x ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:$n("linux"),versionRegexes:[]},{name:"Solaris",search:$n("sunos"),versionRegexes:[]},{name:"FreeBSD",search:$n("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:$n("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],t5={browsers:n(W7),oses:n(Sv)},Zg="Edge",Og="Chromium",vg="Opera",Wp="Firefox",Op="Safari",ap=e=>{const n=e.current,s=e.version,t=e=>()=>n===e;return{current:n,version:s,isEdge:t(Zg),isChromium:t(Og),isIE:t("IE"),isOpera:t(vg),isFirefox:t(Wp),isSafari:t(Op)}},Sb=()=>ap({current:void 0,version:Na.unknown()}),Mj=ap,Cm=(n(Zg),n(Og),n("IE"),n(vg),n(Wp),n(Op),"Windows"),hm="Android",cm="Linux",am="macOS",F2="Solaris",l8="FreeBSD",M4="ChromeOS",O0=e=>{const n=e.current,s=e.version,t=e=>()=>n===e;return{current:n,version:s,isWindows:t(Cm),isiOS:t("iOS"),isAndroid:t(hm),isMacOS:t(am),isLinux:t(cm),isSolaris:t(F2),isFreeBSD:t(l8),isChromeOS:t(M4)}},tC=()=>O0({current:void 0,version:Na.unknown()}),eC=O0,qx=(n(Cm),n("iOS"),n(hm),n(cm),n(am),n(F2),n(l8),n(M4),e=>window.matchMedia(e).matches);let Wx=vs(()=>((e,t,s)=>{const o=t5.browsers(),r=t5.oses(),i=t.bind(e=>((e,t)=>wn(t.brands,t=>{const n=t.brand.toLowerCase();return ne(e,e=>{var t;return n===(null===(t=e.brand)||void 0===t?void 0:t.toLowerCase())}).map(e=>({current:e.name,version:Na.nu(parseInt(t.version,10),0)}))}))(o,e)).orThunk(()=>((e,t)=>b7(e,t).map(e=>{const n=Na.detect(e.versionRegexes,t);return{current:e.name,version:n}}))(o,e)).fold(Sb,Mj),a=((e,t)=>b7(e,t).map(e=>{const n=Na.detect(e.versionRegexes,t);return{current:e.name,version:n}}))(r,e).fold(tC,eC),c=((e,t,s,o)=>{const i=e.isiOS()&&!0===/ipad/i.test(s),a=e.isiOS()&&!i,r=e.isiOS()||e.isAndroid(),u=r||o("(pointer:coarse)"),c=i||!a&&r&&o("(min-device-width:768px)"),l=a||r&&!c,d=t.isSafari()&&e.isiOS()&&!1===/safari/i.test(s),h=!l&&!c&&!d;return{isiPad:n(i),isiPhone:n(a),isTablet:n(c),isPhone:n(l),isTouch:n(u),isAndroid:e.isAndroid,isiOS:e.isiOS,isWebView:n(d),isDesktop:n(h)}})(a,i,e,s);return{browser:i,os:a,deviceType:c}})(navigator.userAgent,e.from(navigator.userAgentData),qx));const bo=()=>Wx(),r2=t=>{const o=l((t=>{if(bw()&&Wt(t.target)){const e=l(t.target);if(Ot(e)&&(e=>Wt(e.dom.shadowRoot))(e)&&t.composed&&t.composedPath){const e=t.composedPath();if(e)return Zn(e)}}return e.from(t.target)})(t).getOr(t.target)),n=()=>t.stopPropagation(),s=()=>t.preventDefault(),i=gd(s,n);return((e,t,n,s,o,i,a)=>({target:e,x:t,y:n,stop:s,prevent:o,kill:i,raw:a}))(o,t.clientX,t.clientY,n,s,i,t)},l2=(e,t,n,s,o)=>{const i=((e,t)=>n=>{e(n)&&t(r2(n))})(n,s);return e.dom.addEventListener(t,i,o),{unbind:Nt(Ax,e,t,i,o)}},Ax=(e,t,n,s)=>{e.dom.removeEventListener(t,n,s)},ki=(e,t)=>{Cn(e).each(n=>{n.dom.insertBefore(t.dom,e.dom)})},xx=(t,n)=>{const s=(t=>e.from(t.dom.nextSibling).map(l))(t);s.fold(()=>{Cn(t).each(e=>{Ht(e,n)})},e=>{ki(e,n)})},mx=(e,t)=>{const n=(e=>Us(e,0))(e);n.fold(()=>{Ht(e,t)},n=>{e.dom.insertBefore(t.dom,n.dom)})},Ht=(e,t)=>{e.dom.appendChild(t.dom)},V2=(e,t)=>{h(t,t=>{Ht(e,t)})},gl=e=>{e.dom.textContent="",h(On(e),e=>{Ln(e)})},Ln=e=>{const t=e.dom;null!==t.parentNode&&t.parentNode.removeChild(t)},bn=e=>{const t=void 0!==e?e.dom:document,n=t.body.scrollLeft||t.documentElement.scrollLeft,s=t.body.scrollTop||t.documentElement.scrollTop;return ee(n,s)},H3=(e,t,n)=>{const s=(void 0!==n?n.dom:document).defaultView;s&&s.scrollTo(e,t)},eh=(e,t,n,s)=>({x:e,y:t,width:n,height:s,right:e+n,bottom:t+s}),lh=t=>{const s=void 0===t?window:t,o=s.document,n=bn(l(o));return(t=>{const n=void 0===t?window:t;return bo().browser.isFirefox()?e.none():e.from(n.visualViewport)})(s).fold(()=>{const e=s.document.documentElement,t=e.clientWidth,o=e.clientHeight;return eh(n.left,n.top,t,o)},e=>eh(Math.max(e.pageLeft,n.left),Math.max(e.pageTop,n.top),e.width,e.height))},jl=()=>l(document),em=(e,t)=>e.view(t).fold(n([]),t=>{const n=e.owner(t),s=em(e,n);return[t].concat(s)});tm=Object.freeze({__proto__:null,view:t=>{var n;return(t.dom===document?e.none():e.from(null===(n=t.dom.defaultView)||void 0===n?void 0:n.frameElement)).map(l)},owner:e=>rn(e)});const Cl=t=>{const s=jl(),n=bn(s),o=((t,n)=>{const s=n.owner(t),o=em(n,s);return e.some(o)})(t,tm);return o.fold(Nt(ls,t),e=>{const s=Dd(t),o=To(e,(e,t)=>{const n=Dd(t);return{left:e.left+n.left,top:e.top+n.top}},{left:0,top:0});return ee(o.left+s.left+n.left,o.top+s.top+n.top)})},Ve=(e,t,n,s)=>({x:e,y:t,width:n,height:s,right:e+n,bottom:t+s}),it=e=>{const t=ls(e),n=Ea(e),s=Ks(e);return Ve(t.left,t.top,n,s)},Is=e=>{const t=Cl(e),n=Ea(e),s=Ks(e);return Ve(t.left,t.top,n,s)},Sn=()=>lh(window),lm=t=>{const s=e=>e(t),o=n(t),i=()=>a,a={tag:!0,inner:t,fold:(e,n)=>n(t),isValue:Oe,isError:U,map:e=>x.value(e(t)),mapError:i,bind:s,exists:s,forall:s,getOr:o,or:i,getOrThunk:o,orThunk:i,getOrDie:o,each:e=>{e(t)},toOptional:()=>e.some(t)};return a},um=t=>{const n=()=>s,s={tag:!1,inner:t,fold:(e)=>e(t),isValue:U,isError:Oe,map:n,mapError:e=>x.error(e(t)),bind:n,exists:U,forall:Oe,getOr:z,or:z,getOrThunk:Pg,orThunk:Pg,getOrDie:Pd(String(t)),each:c,toOptional:e.none};return s},x={value:lm,error:um,fromOption:(e,t)=>e.fold(()=>um(t),lm)};!function(e){e[e.Error=0]="Error",e[e.Value=1]="Value"}(Ct||(Ct={}));const Tl=(e,t,n)=>e.stype===Ct.Error?t(e.serror):n(e.svalue),m8=e=>({stype:Ct.Value,svalue:e}),z8=e=>({stype:Ct.Error,serror:e}),ho=m8,fo=z8,uy=Tl,nf=(e,t,n,s)=>({tag:"field",key:e,newKey:t,presence:n,prop:s}),$l=(e,t,n)=>{switch(e.tag){case"field":return t(e.key,e.newKey,e.presence,e.prop);case"custom":return n(e.newKey,e.instantiator)}},Lf=e=>(...t)=>{if(0===t.length)throw new Error("Can't merge zero objects");const n={};for(let s=0;s<t.length;s++){const o=t[s];for(const t in o)R(o,t)&&(n[t]=e(n[t],o[t]))}return n},te=Lf((e,t)=>f3(e)&&f3(t)?te(e,t):t),Sj=Lf((e,t)=>t),Vr=e=>({tag:"defaultedThunk",process:e}),Ra=e=>Vr(n(e)),Kl=e=>({tag:"mergeWithThunk",process:e}),Hf=e=>{const t=(e=>{const t=[],n=[];return h(e,e=>{Tl(e,e=>n.push(e),e=>t.push(e))}),{values:t,errors:n}})(e);return t.errors.length>0?(n=t.errors,gd(fo,Se)(n)):ho(t.values);var n},ql=e=>os(e)&&ce(e).length>100?" removed due to size":JSON.stringify(e,null,2),Yi=(e,t)=>fo([{path:e,getErrorInfo:t}]),Uo=e=>({extract:(t,s)=>{return o=e(s),i=e=>((e,t)=>Yi(e,n(t)))(t,e),o.stype===Ct.Error?i(o.serror):o;var o,i},toString:n("val")}),s6=Uo(ho),a6=(e,t,n,s)=>s(f(e,t).getOrThunk(()=>n(e))),Qb=(t,s,o,i,a)=>{const r=e=>a.extract(s.concat([i]),e),c=t=>t.fold(()=>ho(e.none()),t=>{const r=a.extract(s.concat([i]),t);return n=r,o=e.some,n.stype===Ct.Value?{stype:Ct.Value,svalue:o(n.svalue)}:n;var n,o});switch(t.tag){case"required":return((e,t,n,s)=>f(t,n).fold(()=>((e,t,n)=>Yi(e,()=>'Could not find valid *required* value for "'+t+'" in '+ql(n)))(e,n,t),s))(s,o,i,r);case"defaultedThunk":return a6(o,i,t.process,r);case"option":return((e,t,n)=>n(f(e,t)))(o,i,c);case"defaultedOptionThunk":return((e,t,n,s)=>s(f(e,t).map(t=>!0===t?n(e):t)))(o,i,t.process,c);case"mergeWithThunk":return a6(o,i,n({}),e=>{const n=te(t.process(o),e);return r(n)})}},v6=e=>({extract:(t,n)=>e().extract(t,n),toString:()=>e().toString()}),Tb=e=>ce(t3(e,Wt)),gt=e=>{const t=m(e),s=To(e,(e,t)=>$l(t,t=>te(e,{[t]:!0}),n(e)),{});return{extract:(e,n)=>{const i=Tn(n)?[]:Tb(n),o=K(i,e=>!Gt(s,e));return 0===o.length?t.extract(e,n):((e,t)=>Yi(e,()=>"There are unsupported fields: ["+t.join(", ")+"] specified"))(e,o)},toString:t.toString}},m=e=>({extract:(t,n)=>((e,t,n)=>{const s={},o=[];for(const i of n)$l(i,(n,i,a,r)=>{const c=Qb(a,e,t,n,r);uy(c,e=>{o.push(...e)},e=>{s[i]=e})},(e,n)=>{s[e]=n(t)});return o.length>0?fo(o):ho(s)})(t,n,e),toString:()=>{const t=a(e,e=>$l(e,(e,t,n,s)=>e+" -> "+s.toString(),(e)=>"state("+e+")"));return`obj{
`+t.join(`
`)+"}"}}),Cs=e=>({extract:(t,n)=>{const s=a(n,(n,s)=>e.extract(t.concat(["["+s+"]"]),n));return Hf(s)},toString:()=>"array("+e.toString()+")"}),td=(e,t)=>{const n=void 0!==t?t:z;return{extract:(t,s)=>{const o=[];for(const a of e){const i=a.extract(t,s);if(i.stype===Ct.Value)return{stype:Ct.Value,svalue:n(i.svalue)};o.push(i)}return Hf(o)},toString:()=>"oneOf("+a(e,e=>e.toString()).join(", ")+")"}},ub=(e,t)=>({extract:(n,s)=>{const r=ce(s),c=((t,n)=>Cs(Uo(e)).extract(t,n))(n,r);return i=e=>{const o=a(e,e=>nf(e,e,{tag:"required",process:{}},t));return m(o).extract(n,s)},(o=c).stype===Ct.Value?i(o.svalue):o;var o,i},toString:()=>"setOf("+t.toString()+")"}),od=gd(Cs,m),ln=n(s6),yr=(e,t)=>Uo(n=>{const s=typeof n;return e(n)?ho(n):fo(`Expected type: ${t} but got: ${s}`)}),br=yr(Ss,"number"),Ee=yr(L,"string"),ca=yr(Tn,"boolean"),rd=yr(At,"function"),Qp=e=>{if(Object(e)!==e)return!0;switch({}.toString.call(e).slice(8,-1)){case"Boolean":case"Number":case"String":case"Date":case"RegExp":case"Blob":case"FileList":case"ImageData":case"ImageBitmap":case"ArrayBuffer":return!0;case"Array":case"Object":return Object.keys(e).every(t=>Qp(e[t]));default:return!1}},D9=Uo(e=>Qp(e)?ho(e):fo("Expected value to be acceptable for sending via postMessage")),dr=(e,t)=>({extract:(n,s)=>f(s,e).fold(()=>((e,t)=>Yi(e,()=>'Choice schema did not contain choice key: "'+t+'"'))(n,e),e=>((e,t,n,s)=>f(n,s).fold(()=>((e,t,n)=>Yi(e,()=>'The chosen schema: "'+n+'" did not exist in branches: '+ql(t)))(e,n,s),n=>n.extract(e.concat(["branch: "+s]),t)))(n,s,t,e)),toString:()=>"chooseOn("+e+"). Possible values: "+ce(t)}),ma=e=>Uo(t=>e(t).fold(fo,ho)),Zp=(e,t)=>ub(t=>e(t).fold(z8,m8),t),X=(e,t,n)=>{return s=((e,t,n)=>((e,t)=>e.stype===Ct.Error?{stype:Ct.Error,serror:t(e.serror)}:e)(t.extract([e],n),e=>({input:n,errors:e})))(e,t,n),Tl(s,x.error,x.value);var s},an=e=>e.fold(e=>{throw new Error(Bo(e))},z),Ge=(e,t,n)=>an(X(e,t,n)),Bo=e=>`Errors: 
`+(e=>{const t=e.length>10?e.slice(0,10).concat([{path:[],getErrorInfo:n("... (only showing first ten failures)")}]):e;return a(t,e=>"Failed path: ("+e.path.join(" > ")+`)
`+e.getErrorInfo())})(e.errors).join(`
`)+`

Input object: `+ql(e.input),lt=(e,t)=>dr(e,je(t,m)),xe=nf,We=(e,t)=>({tag:"custom",newKey:e,instantiator:t}),jd=e=>ma(t=>_e(e,t)?x.value(t):x.error(`Unsupported value: "${t}", choose one of "${e.join(", ")}".`)),s=e=>xe(e,e,{tag:"required",process:{}},ln()),vt=(e,t)=>xe(e,e,{tag:"required",process:{}},t),B7=e=>vt(e,br),he=e=>vt(e,Ee),pi=(e,t)=>xe(e,e,{tag:"required",process:{}},jd(t)),Rt=e=>vt(e,rd),Os=(e,t)=>xe(e,e,{tag:"required",process:{}},m(t)),j7=(e,t)=>xe(e,e,{tag:"required",process:{}},od(t)),St=(e,t)=>xe(e,e,{tag:"required",process:{}},Cs(t)),D=e=>xe(e,e,{tag:"option",process:{}},ln()),Rn=(e,t)=>xe(e,e,{tag:"option",process:{}},t),Fa=e=>Rn(e,br),nt=e=>Rn(e,Ee),m7=(e,t)=>Rn(e,jd(t)),Ia=e=>Rn(e,rd),s7=(e,t)=>Rn(e,Cs(t)),bt=(e,t)=>Rn(e,m(t)),t=(e,t)=>xe(e,e,Ra(t),ln()),Mt=(e,t,n)=>xe(e,e,Ra(t),n),Kd=(e,t)=>Mt(e,t,br),Dn=(e,t)=>Mt(e,t,Ee),zn=(e,t,n)=>Mt(e,t,jd(n)),ht=(e,t)=>Mt(e,t,ca),ue=(e,t)=>Mt(e,t,rd),rr=(e,t,n)=>Mt(e,t,Cs(n)),Yc=(e,t,n)=>Mt(e,t,m(n)),v=e=>{let t=e;return{get:()=>t,set:e=>{t=e}}},Ft=e=>{if(!bs(e))throw new Error("cases must be an array");if(0===e.length)throw new Error("there must be at least one case");const t=[],n={};return h(e,(s,o)=>{const r=ce(s);if(1!==r.length)throw new Error("one and only one name per case");const i=r[0],a=s[i];if(void 0!==n[i])throw new Error("duplicate key detected:"+i);if("cata"===i)throw new Error("cannot have a case named cata (sorry)");if(!bs(a))throw new Error("case arguments must be an array");t.push(i),n[i]=(...n)=>{const s=n.length;if(s!==a.length)throw new Error("Wrong number of arguments to case "+i+". Expected "+a.length+" ("+a+"), got "+s);return{fold:(...t)=>{if(t.length!==e.length)throw new Error("Wrong number of arguments to fold. Expected "+e.length+", got "+t.length);return t[o].apply(null,n)},match:e=>{const s=ce(e);if(t.length!==s.length)throw new Error("Wrong number of arguments to match. Expected: "+t.join(",")+`
Actual: `+s.join(","));if(!Ho(t,e=>_e(s,e)))throw new Error("Not all branches were specified when using match. Specified: "+s.join(", ")+`
Required: `+t.join(", "));return e[i].apply(null,n)},log:e=>{console.log(e,{constructors:t,constructor:i,params:n})}}}}),n};Ft([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]);const jo=(e,t)=>((e,t)=>({[e]:t}))(e,t),xo=e=>(e=>{const t={};return h(e,e=>{t[e.key]=e.value}),t})(e),v5=e=>At(e)?e:U,d5=(t,n,s)=>{let o=t.dom;const i=v5(s);for(;o.parentNode;){o=o.parentNode;const e=l(o),t=n(e);if(t.isSome())return t;if(i(e))break}return e.none()},Qd=(t,n,s)=>{const i=n(t),o=v5(s);return i.orThunk(()=>o(t)?e.none():d5(t,n,o))},a5=(e,t)=>G(e.element,t.event.target),Uv={can:Oe,abort:U,run:c},Mo=e=>{if(!Gt(e,"can")&&!Gt(e,"abort")&&!Gt(e,"run"))throw new Error("EventHandler defined by: "+JSON.stringify(e,null,2)+" does not have can, abort, or run!");return{...Uv,...e}},Ce=n,Nn=Ce("touchstart"),ta=Ce("touchmove"),Ji=Ce("touchend"),Fg=Ce("touchcancel"),It=Ce("mousedown"),Rr=Ce("mousemove"),tu=Ce("mouseout"),ou=Ce("mouseup"),As=Ce("mouseover"),Ms=Ce("focusin"),E9=Ce("focusout"),$i=Ce("keydown"),k9=Ce("keyup"),ao=Ce("input"),Bi=Ce("change"),Hi=Ce("click"),F9=Ce("transitioncancel"),Di=Ce("transitionend"),z9=Ce("transitionstart"),I9=Ce("selectstart"),oe=e=>n("alloy."+e),V9={tap:oe("tap")},rs=oe("focus"),mu=oe("blur.post"),fu=oe("paste.post"),Ns=oe("receive"),ut=oe("execute"),Ei=oe("focus.item"),xi=V9.tap,W9=oe("longpress"),Tc=oe("sandbox.close"),vu=oe("typeahead.cancel"),Ic=oe("system.init"),G9=oe("system.touchmove"),X9=oe("system.touchend"),ju=oe("system.scroll"),nr=oe("system.resize"),Vs=oe("system.attached"),mi=oe("system.detached"),di=oe("system.dismissRequested"),yp=oe("system.repositionRequested"),jp=oe("focusmanager.shifted"),_u=oe("slotcontainer.visibility"),gp=oe("change.tab"),rp=oe("dismiss.tab"),np=oe("highlight"),Ou=oe("dehighlight"),T=(e,t)=>{Au(e,e.element,t,{})},p=(e,t,n)=>{Au(e,e.element,t,n)},Js=e=>{T(e,ut())},ku=(e,t,n)=>{Au(e,t,n,{})},Au=(e,t,n,s)=>{const o={target:t,...s};e.getSystem().triggerEvent(n,t,o)},L6=(e,t,n,s)=>{e.getSystem().triggerEvent(n,t,s.event)},$=e=>xo(e),z6=(e,t)=>({key:e,value:Mo({abort:t})}),j6=e=>({key:e,value:Mo({run:(e,t)=>{t.event.prevent()}})}),o=(e,t)=>({key:e,value:Mo({run:t})}),Su=(e,t,n)=>({key:e,value:Mo({run:(e,s)=>{t.apply(void 0,[e,s].concat(n))}})}),ac=e=>t=>({key:e,value:Mo({run:(e,n)=>{a5(e,n)&&t(e,n)}})}),Yo=(e,t,n)=>((e,t)=>o(e,(n,s)=>{n.getSystem().getByUid(t).each(t=>{L6(t,t.element,e,s)})}))(e,t.partUids[n]),Fu=(e,t)=>o(e,(e,n)=>{const s=n.event,o=e.getSystem().getByDom(s.target).getOrThunk(()=>Qd(s.target,t=>e.getSystem().getByDom(t).toOptional(),U).getOr(e));t(e,o,n)}),ro=e=>o(e,(e,t)=>{t.cut()}),vj=e=>o(e,(e,t)=>{t.stop()}),Ko=(e,t)=>ac(e)(t),Q=ac(Vs()),_n=ac(mi()),bj=ac(Ic()),Vn=(lf=ut(),e=>o(lf,e)),Vu=e=>e.dom.innerHTML,Ro=(e,t)=>{const n=rn(e).dom,s=l(n.createDocumentFragment()),o=((e,t)=>{const n=(t||document).createElement("div");return n.innerHTML=e,On(l(n))})(t,n);V2(s,o),gl(e),Ht(e,s)},Lj=e=>Q1(e)?"#shadow-root":(e=>{const t=ii("div"),n=l(e.dom.cloneNode(!0));return Ht(t,n),Vu(t)})((e=>((e)=>l(e.dom.cloneNode(!1)))(e))(e)),xs=e=>Lj(e),Uj=$([((e)=>({key:e,value:Mo({can:(e,t)=>{const n=t.event,s=n.originator,o=n.target;return!((e,t,n)=>G(t,e.element)&&!G(t,n))(e,s,o)||(console.warn(rs()+` did not get interpreted by the desired target. 
Originator: `+xs(s)+`
Target: `+xs(o)+`
Check the `+rs()+" event handlers"),!1)}})}))(rs())]);J8=Object.freeze({__proto__:null,events:Uj});let G8=0;const d=e=>{const t=(new Date).getTime(),n=Math.floor(1e9*Math.random());return G8++,e+"_"+n+G8+String(t)},ay=n("alloy-id-"),my=n("data-alloy-id"),fy=ay(),w8=my(),l1=(e,t)=>{Object.defineProperty(e.dom,w8,{value:t,writable:!0})},aa=t=>{const n=Ot(t)?t.dom[w8]:null;return e.from(n)},Co=e=>d(e),wy=z,mr=e=>{const o=t=>`The component must be in a context to execute: ${t}`+(e?`
`+xs(e().element)+" is not in context.":""),t=e=>()=>{throw new Error(o(e))},s=e=>()=>{console.warn(o(e))};return{debugInfo:n("fake"),triggerEvent:s("triggerEvent"),triggerFocus:s("triggerFocus"),triggerEscape:s("triggerEscape"),broadcast:s("broadcast"),broadcastOn:s("broadcastOn"),broadcastEvent:s("broadcastEvent"),build:t("build"),buildOrPatch:t("buildOrPatch"),addToWorld:t("addToWorld"),removeFromWorld:t("removeFromWorld"),addToGui:t("addToGui"),removeFromGui:t("removeFromGui"),getByUid:t("getByUid"),getByDom:t("getByDom"),isConnected:U}},xy=mr(),d1=e=>a(e,e=>cc(e,"/*")?e.substring(0,e.length-"/*".length):e),u1=(e,t)=>{const n=e.toString(),s=n.indexOf(")")+1,o=n.indexOf("("),i=n.substring(o+1,s-1).split(/,\s*/);return e.toFunctionAnnotation=()=>({name:t,parameters:d1(i)}),e},lr=d("alloy-premade"),s8=e=>(Object.defineProperty(e.element.dom,lr,{value:e.uid,writable:!0}),jo(lr,e)),e8=e=>f(e,lr),or=e=>((e,t)=>{const n=t.toString(),s=n.indexOf(")")+1,o=n.indexOf("("),i=n.substring(o+1,s-1).split(/,\s*/);return e.toFunctionAnnotation=()=>({name:"OVERRIDE",parameters:d1(i.slice(1))}),e})((t,...n)=>e(t.getApis(),t,...n),e),en={init:()=>jt({readState:n("No State required")})},jt=e=>e,$m=(e,t)=>{const n={};return Re(e,(e,s)=>{Re(e,(e,o)=>{const i=f(n,o).getOr([]);n[o]=i.concat([t(s,e)])})}),n},Zt=e=>({classes:ts(e.classes)?[]:e.classes,attributes:ts(e.attributes)?{}:e.attributes,styles:ts(e.styles)?{}:e.styles}),g1=e=>e.cHandler,A_=(e,t)=>({name:e,handler:t}),M_=(e,t)=>{const n={};return h(e,e=>{n[e.name()]=e.handlers(t)}),n},F_=(e,t,n)=>{const s=t[n];return s?((e,t,n,s)=>{try{const t=T2(n,(t,n)=>{const a=t.name,r=n.name,o=s.indexOf(a),i=s.indexOf(r);if(-1===o)throw new Error("The ordering for "+e+" does not have an entry for "+a+`.
Order specified: `+JSON.stringify(s,null,2));if(-1===i)throw new Error("The ordering for "+e+" does not have an entry for "+r+`.
Order specified: `+JSON.stringify(s,null,2));return o<i?-1:i<o?1:0});return x.value(t)}catch(e){return x.error([e])}})("Event: "+n,0,e,s).map(e=>(e=>{const t=((e)=>(...t)=>Ie(e,(e,n)=>e&&(e=>e.can)(n).apply(void 0,t),!0))(e),n=((e)=>(...t)=>Ie(e,(e,n)=>e||(e=>e.abort)(n).apply(void 0,t),!1))(e);return{can:t,abort:n,run:(...t)=>{h(e,e=>{e.run.apply(void 0,t)})}}})(a(e,e=>e.handler))):((e,t)=>x.error(["The event ("+e+`) has more than one behaviour that listens to it.
When this occurs, you must specify an event ordering for the behaviours in your spec (e.g. [ "listing", "toggling" ]).
The behaviours that can trigger it are: `+JSON.stringify(a(t,e=>e.name),null,2)]))(n,e)},D_=(e,t)=>((e,t)=>{const n=(e=>{const t=[],n=[];return h(e,e=>{e.fold(e=>{t.push(e)},e=>{n.push(e)})}),{errors:t,values:n}})(e);return n.errors.length>0?(s=n.errors,x.error(Se(s))):((e,t)=>0===e.length?x.value(t):x.value(te(t,Sj.apply(void 0,e))))(n.values,t);var s})(Kr(e,(e,n)=>(1===e.length?x.value(e[0].handler):F_(e,t,n)).map(s=>{const o=(e=>{const t=(e=>At(e)?{can:Oe,abort:U,run:e}:e)(e);return(e,n,...s)=>{const o=[e,n].concat(s);t.abort.apply(void 0,o)?n.stop():t.can.apply(void 0,o)&&t.run.apply(void 0,o)}})(s),i=e.length>1?K(t[n],t=>nn(e,e=>e.name===t)).join(" > "):e[0].name;return jo(n,((e,t)=>({handler:e,purpose:t}))(o,i))})),{}),uo="alloy.base.behaviour",B_=m([xe("dom","dom",{tag:"required",process:{}},m([s("tag"),t("styles",{}),t("classes",[]),t("attributes",{}),D("value"),D("innerHtml")])),s("components"),s("uid"),t("events",{}),t("apis",{}),xe("eventOrder","eventOrder",(V3={[ut()]:["disabling",uo,"toggling","typeaheadevents"],[rs()]:[uo,"focusing","keying"],[Ic()]:[uo,"disabling","toggling","representing"],[ao()]:[uo,"representing","streaming","invalidating"],[mi()]:[uo,"representing","item-events","tooltipping"],[It()]:["focusing",uo,"item-type-events"],[Nn()]:["focusing",uo,"item-type-events"],[As()]:["item-type-events","tooltipping"],[Ns()]:["receiving","reflecting","tooltipping"]},Kl(n(V3))),ln()),D("domModification")]),V_=e=>e.events,O1=(e,t)=>{const n=Ne(e,t);return void 0===n||""===n?[]:n.split(" ")},Ma=e=>void 0!==e.dom.classList,qh=e=>O1(e,"class"),me=(e,t)=>{Ma(e)?e.dom.classList.add(t):((e,t)=>{((e,t,n)=>{const s=O1(e,t).concat([n]);_(e,t,s.join(" "))})(e,"class",t)})(e,t)},ie=(e,t)=>{Ma(e)?e.dom.classList.remove(t):((e,t)=>{((e,t,n)=>{const s=K(O1(e,t),e=>e!==n);s.length>0?_(e,t,s.join(" ")):ve(e,t)})(e,"class",t)})(e,t),(e=>{0===(Ma(e)?e.dom.classList:qh(e)).length&&ve(e,"class")})(e)},mt=(e,t)=>Ma(e)&&e.dom.classList.contains(t),zs=(e,t)=>{h(t,t=>{me(e,t)})},mn=(e,t)=>{h(t,t=>{ie(e,t)})},Bn=e=>e.dom.value,Lo=(e,t)=>{if(void 0===t)throw new Error("Value.set was undefined");e.dom.value=t},Lh=(e,t,n)=>{n.fold(()=>Ht(e,t),e=>{G(e,t)||(ki(e,t),Ln(e))})},zh=(e,t,n)=>{const s=a(t,n),o=On(e);return h(o.slice(s.length),Ln),s},Th=(e,t,n,s)=>{const o=Us(e,t),i=s(n,o),a=((e,t,n)=>Us(e,t).map(e=>{if(n.exists(t=>!G(t,e))){const s=n.map(qn).getOr("span"),t=ii(s);return ki(e,t),t}return e}))(e,t,o);return Lh(e,i.element,a),i},Eh=(e,t)=>{const n=ce(e),s=ce(t);return{toRemove:Hs(s,n),toSet:((e)=>{const s={},o={};return A0(e,(e,n)=>!R(t,n)||e!==t[n],f4(s),f4(o)),{t:s,f:o}})(e).t}},aw=(e,t)=>{const{class:u,style:m,...s}=(e=>Ie(e.dom.attributes,(e,t)=>(e[t.name]=t.value,e),{}))(t),{toSet:o,toRemove:i}=Eh(e.attributes,s),a=B6(t),{toSet:r,toRemove:c}=Eh(e.styles,a),n=(e=>Ma(e)?(e=>{const t=e.dom.classList,n=new Array(t.length);for(let e=0;e<t.length;e++){const s=t.item(e);null!==s&&(n[e]=s)}return n})(e):qh(e))(t),l=Hs(n,e.classes),d=Hs(e.classes,n);return h(i,e=>ve(t,e)),Um(t,o),zs(t,d),mn(t,l),h(c,e=>I(t,e)),Go(t,r),e.innerHtml.fold(()=>{const n=e.domChildren;((e,t)=>{zh(e,t,(t,n)=>{const s=Us(e,n);return Lh(e,t,s),t})})(t,n)},e=>{Ro(t,e)}),(()=>{const s=t,n=e.value.getOrUndefined();n!==Bn(s)&&Lo(s,n??"")})(),t},rw=e=>{const o=(e=>{const t=f(e,"behaviours").getOr({});return le(ce(t),e=>{const n=t[e];return Wt(n)?[n.me]:[]})})(e);return((e,o)=>((e,o)=>{const i=a(o,e=>bt(e.name(),[s("config"),t("state",en)])),r=X("component.behaviours",m(i),e.behaviours).fold(t=>{throw new Error(Bo(t)+`
Complete spec:
`+JSON.stringify(e,null,2))},z);return{list:o,data:je(r,e=>{const t=e.map(e=>({config:e.config,state:e.state.init(e.config)}));return n(t)})}})(e,o))(e,o)},lw=(t,n)=>{const m=()=>u,o=v(xy),i=an((e=>X("custom.definition",B_,e))(t)),r=rw(t),c=(e=>e.list)(r),s=(e=>e.data)(r),f=((e,t,n)=>{const r={...(i=e).dom,uid:i.uid,domChildren:a(i.components,e=>e.element)};var s,o,i;const c=(e=>e.domModification.fold(()=>Zt({}),Zt))(e),l={"alloy.base.modification":c},d=t.length>0?((e,t,n,s)=>{const i={...t};h(n,t=>{i[t.name()]=t.exhibit(e,s)});const o=$m(i,(e,t)=>({name:e,modification:t})),a=e=>To(e,(e,t)=>({...t.modification,...e}),{}),r=To(o.classes,(e,t)=>t.modification.concat(e),[]),c=a(o.attributes),l=a(o.styles);return Zt({classes:r,attributes:c,styles:l})})(n,l,t,r):c;return s=r,o=d,{...s,attributes:{...s.attributes,...o.attributes},styles:{...s.styles,...o.styles},classes:s.classes.concat(o.classes)}})(i,c,s),l=((t,n)=>{const s=n.filter(e=>qn(e)===t.tag&&!(e=>e.innerHtml.isSome()&&e.domChildren.length>0)(t)&&!(e=>R(e.dom,lr))(e)).bind(n=>((t,n)=>{try{const s=aw(t,n);return e.some(s)}catch{return e.none()}})(t,n)).getOrThunk(()=>(e=>{const t=ii(e.tag);Um(t,e.attributes),zs(t,e.classes),Go(t,e.styles),e.innerHtml.each(e=>Ro(t,e));const n=e.domChildren;return V2(t,n),e.value.each(e=>{Lo(t,e)}),t})(t));return l1(s,t.uid),s})(f,n),p=((e,t,n)=>{const s={"alloy.base.behaviour":V_(e)};return((e,t,n,s)=>{const o=((e,t,n)=>{const s={...n,...M_(t,e)};return $m(s,A_)})(e,n,s);return D_(o,t)})(n,e.eventOrder,t,s).getOrDie()})(i,c,s),d=v(i.components),u={uid:t.uid,getSystem:o.get,config:e=>{const n=s;return(At(n[e.name()])?n[e.name()]:()=>{throw new Error("Could not find "+e.name()+" in "+JSON.stringify(t,null,2))})()},hasConfigured:e=>At(s[e.name()]),spec:t,readState:e=>s[e]().map(e=>e.state.readState()).getOr("not enabled"),getApis:()=>i.apis,connect:e=>{o.set(e)},disconnect:()=>{o.set(mr(m))},element:l,syncComponents:()=>{const e=On(l),t=le(e,e=>o.get().getByDom(e).fold(()=>[],JO));d.set(t)},components:d.get,events:p};return u},be=e=>{const t=yg(e);return uh({element:t})},uh=t=>{const o=Ge("external.component",gt([s("element"),D("uid")]),t),i=v(mr()),a=o.uid.getOrThunk(()=>Co("external"));l1(o.element,a);const r={uid:a,getSystem:i.get,config:e.none,hasConfigured:U,connect:e=>{i.set(e)},disconnect:()=>{i.set(mr(()=>r))},getApis:()=>({}),element:o.element,spec:t,readState:n("No state"),syncComponents:c,components:n([]),events:{}};return s8(r)},pw=Co,T1=(e,t)=>e8(e).getOrThunk(()=>((e,t)=>{const{events:s,...n}=wy(e),o=((e,t)=>{const n=f(e,"components").getOr([]);return t.fold(()=>a(n,qe),e=>a(n,(t,n)=>T1(t,Us(e,n))))})(n,t),i={...n,events:{...J8,...s},components:o};return x.value(lw(i,t))})((e=>R(e,"uid"))(e)?e:{uid:pw(""),...e},t).getOrDie()),qe=t=>T1(t,e.none()),Pt=s8;W1=(t,n,s,o,i)=>t(s,o)?e.some(s):At(i)&&i(s)?e.none():n(s,o,i);const R3=(t,n,s)=>{let o=t.dom;const i=At(s)?s:U;for(;o.parentNode;){o=o.parentNode;const t=l(o);if(n(t))return e.some(t);if(i(t))break}return e.none()},D3=(e,t,n)=>W1((e,t)=>t(e),R3,e,t,n),b3=(e,t,n)=>D3(e,t,n).isSome(),sr=(e,t,n)=>R3(e,e=>P1(e,t),n),NO=(e,t)=>((e)=>ne(e.dom.childNodes,e=>{return n=l(e),P1(n,t);var n}).map(l))(e),pe=(t,n)=>((t,n)=>{const s=void 0===n?document:n.dom;return $3(s)?e.none():e.from(s.querySelector(t)).map(l)})(n,t),hn=(e,t,n)=>W1((e,t)=>P1(e,t),sr,e,t,n),fa="aria-controls",G2=()=>{const e=d(fa);return{id:e,link:t=>{_(t,fa,e)},unlink:e=>{ve(e,fa)}}},Ps=(e,t)=>b3(t,t=>G(t,e.element),U)||((e,t)=>(e=>D3(e,e=>{if(!Ot(e))return!1;const t=Ne(e,"id");return void 0!==t&&t.indexOf(fa)>-1}).bind(e=>{const t=Ne(e,"id"),n=Tt(e);return pe(n,`[${fa}="${t}"]`)}))(t).exists(t=>Ps(e,t)))(e,t);!function(e){e[e.STOP=0]="STOP",e[e.NORMAL=1]="NORMAL",e[e.LOGGING=2]="LOGGING"}($o||($o={}));const s4=v({}),QO=["alloy/data/Fields","alloy/debugging/Debugging"],o4=(t,n,s)=>((t,n,s)=>{switch(f(s4.get(),t).orThunk(()=>{const n=ce(s4.get());return wn(n,n=>t.indexOf(n)>-1?e.some(s4.get()[n]):e.none())}).getOr($o.NORMAL)){case $o.NORMAL:return s(ux());case $o.LOGGING:{const e=((e,t)=>{const n=[],s=(new Date).getTime();return{logEventCut:(e,t,s)=>{n.push({outcome:"cut",target:t,purpose:s})},logEventStopped:(e,t,s)=>{n.push({outcome:"stopped",target:t,purpose:s})},logNoParent:(e,t,s)=>{n.push({outcome:"no-parent",target:t,purpose:s})},logEventNoHandlers:(e,t)=>{n.push({outcome:"no-handlers-left",target:t})},logEventResponse:(e,t,s)=>{n.push({outcome:"response",purpose:s,target:t})},write:()=>{const o=(new Date).getTime();_e(["mousemove","mouseover","mouseout",Ic()],e)||console.log(e,{event:e,time:o-s,target:t.dom,sequence:a(n,e=>_e(["cut","stopped","response"],e.outcome)?"{"+e.purpose+"} "+e.outcome+" at ("+xs(e.target)+")":e.outcome)})}}})(t,n),o=s(e);return e.write(),o}case $o.STOP:return!0}})(t,n,s),ux=n({logEventCut:c,logEventStopped:c,logNoParent:c,logEventNoHandlers:c,logEventResponse:c,write:c}),M2=n([s("menu"),s("selectedMenu")]),l4=n([s("item"),s("selectedItem")]);n(m(l4().concat(M2())));const fx=n(m(l4())),_x=Os("initSize",[s("numColumns"),s("numRows")]),jr=()=>Os("markers",[s("backgroundMenu")].concat(M2()).concat(l4())),$s=e=>Os("markers",a(e,s)),_r=(e,t,n)=>((()=>{const e=new Error;if(void 0!==e.stack){const t=e.stack.split(`
`);ne(t,e=>e.indexOf("alloy")>0&&!nn(QO,t=>e.indexOf(t)>-1)).getOr("unknown")}})(),xe(t,t,n,ma(e=>x.value((...t)=>e.apply(void 0,t))))),C=e=>_r(0,e,Ra(c)),ot=t=>_r(0,t,Ra(e.none)),Xs=e=>_r(0,e,{tag:"required",process:{}}),m4=e=>_r(0,e,{tag:"required",process:{}}),W=(e,t)=>We(e,n(t)),W0=e=>We(e,z),D0=n(_x),Ae=(e,t,n,s,o,i,a,r=!1)=>({x:e,y:t,bubble:n,direction:s,placement:o,restriction:i,label:`${a}-${o}`,alwaysFit:r}),js=Ft([{southeast:[]},{southwest:[]},{northeast:[]},{northwest:[]},{south:[]},{north:[]},{east:[]},{west:[]}]),Fr=js.southeast,j4=js.southwest,_4=js.northeast,Gc=js.northwest,F4=js.south,S2=js.north,N2=js.east,U2=js.west,Xo=(e,t,n,s)=>{const o=e+t;return o>s?n:o<n?s:o},zt=(e,t,n)=>Math.min(Math.max(e,t),n),Me=(e,t)=>W2(["left","right","top","bottom"],n=>f(t,n).map(t=>((e,t)=>{switch(t){case 1:return e.x;case 0:return e.x+e.width;case 2:return e.y;case 3:return e.y+e.height}})(e,t))),us="layout",Y2=e=>e.x,n3=(e,t)=>e.x+e.width/2-t.width/2,o3=(e,t)=>e.x+e.width-t.width,G1=(e,t)=>e.y-t.height,$1=e=>e.y+e.height,I3=(e,t)=>e.y+e.height/2-t.height/2,ze=(e,t,n)=>Ae(Y2(e),$1(e),n.southeast(),Fr(),"southeast",Me(e,{left:1,top:3}),us),De=(e,t,n)=>Ae(o3(e,t),$1(e),n.southwest(),j4(),"southwest",Me(e,{right:0,top:3}),us),Qe=(e,t,n)=>Ae(Y2(e),G1(e,t),n.northeast(),_4(),"northeast",Me(e,{left:1,bottom:2}),us),Xe=(e,t,n)=>Ae(o3(e,t),G1(e,t),n.northwest(),Gc(),"northwest",Me(e,{right:0,bottom:2}),us),dt=(e,t,n)=>Ae(n3(e,t),G1(e,t),n.north(),S2(),"north",Me(e,{bottom:2}),us),ke=(e,t,n)=>Ae(n3(e,t),$1(e),n.south(),F4(),"south",Me(e,{top:3}),us),R1=(e,t,n)=>Ae((e=>e.x+e.width)(e),I3(e,t),n.east(),N2(),"east",Me(e,{left:0}),us),L1=(e,t,n)=>Ae(((e,t)=>e.x-t.width)(e,t),I3(e,t),n.west(),U2(),"west",Me(e,{right:1}),us),X3=()=>[ze,De,Qe,Xe,ke,dt,R1,L1],Nh=()=>[De,ze,Xe,Qe,ke,dt,R1,L1],Ph=()=>[Qe,Xe,ze,De,dt,ke],r8=()=>[Xe,Qe,De,ze,dt,ke],r1=()=>[ze,De,Qe,Xe,ke,dt],i1=()=>[De,ze,Xe,Qe,ke,dt];Cf=Object.freeze({__proto__:null,events:e=>$([o(Ns(),(t,n)=>{const s=e.channels,i=ce(s),o=n,a=((e,t)=>t.universal?e:K(e,e=>_e(t.channels,e)))(i,o);h(a,e=>{const n=s[e],i=n.schema,a=Ge("channel["+e+`] data
Receiver: `+xs(t.element),i,o.data);n.onReceive(t,a)})})])}),o6=[vt("channels",Zp(x.value,gt([Xs("onReceive"),t("schema",ln())])))];const Tu=(e,t,n)=>bj((s)=>{n(s,e,t)}),ej=e=>({key:e,value:void 0}),h6=(t,s,o,i,a,r,c)=>{const l=t=>Gt(t,o)?t[o]():e.none(),u=je(a,(e,t)=>((e,t,s)=>((e,t,n)=>{const s=n.toString(),i=s.indexOf(")")+1,a=s.indexOf("("),o=s.substring(a+1,i-1).split(/,\s*/);return e.toFunctionAnnotation=()=>({name:t,parameters:d1(o.slice(0,1).concat(o.slice(3)))}),e})((o,...i)=>{const a=[o].concat(i);return o.config({name:n(e)}).fold(()=>{throw new Error("We could not find any behaviour configuration for: "+e+". Using API: "+s)},e=>{const n=Array.prototype.slice.call(a,1);return t.apply(void 0,[o,e.config,e.state].concat(n))})},s,t))(o,e,t)),d={...je(r,(e,t)=>u1(e,t)),...u,revoke:Nt(ej,o),config:e=>{const n=Ge(o+"-config",t,e);return{key:o,value:{config:n,me:d,configAsRaw:vs(()=>Ge(o+"-config",t,e)),initialConfig:e,state:c}}},schema:n(s),exhibit:(e,t)=>ic(l(e),f(i,"exhibit"),(e,n)=>n(t,e.config,e.state)).getOrThunk(()=>Zt({})),name:n(o),handlers:e=>l(e).map(e=>f(i,"events").getOr(()=>({}))(e.config,e.state)).getOr({})};return d},i=e=>xo(e),rb=gt([s("fields"),s("name"),t("active",{}),t("apis",{}),t("state",en),t("extra",{})]),we=e=>{const t=Ge("Creating behaviour: "+e.name,rb,e);return((e,t,n,s,o,i)=>{const r=gt(e),c=bt(t,[("config",a=e,Rn("config",gt(a)))]);var a;return h6(r,c,t,n,s,o,i)})(t.fields,t.name,t.active,t.apis,t.extra,t.state)},U9=gt([s("branchKey"),s("branches"),s("name"),t("active",{}),t("apis",{}),t("state",en),t("extra",{})]),kp=e=>{const t=Ge("Creating behaviour: "+e.name,U9,e);return((e,t,n,s,o,i)=>{const a=e,r=bt(t,[Rn("config",e)]);return h6(a,r,t,n,s,o,i)})(lt(t.branchKey,t.branches),t.name,t.active,t.apis,t.extra,t.state)},R9=n(void 0),Vt=we({fields:o6,name:"receiving",active:Cf});dg=Object.freeze({__proto__:null,exhibit:(e,t)=>Zt({classes:[],styles:t.useFixed()?{}:{position:"relative"}})});const Xn=e=>e.dom.focus(),jg=e=>{const t=Tt(e).dom;return e.dom===t.activeElement},Wn=(t=jl())=>e.from(t.dom.activeElement).map(l),Jt=e=>Wn(Tt(e)).filter(t=>e.dom.contains(t.dom)),Hd=(t,n)=>{const s=Tt(n),o=Wn(s).bind(t=>{const s=e=>G(t,e);return s(n)?e.some(n):((t,n)=>{const s=t=>{for(let o=0;o<t.childNodes.length;o++){const i=l(t.childNodes[o]);if(n(i))return e.some(i);const a=s(t.childNodes[o]);if(a.isSome())return a}return e.none()};return s(t.dom)})(n,s)}),i=t(n);return o.each(e=>{Wn(s).filter(t=>G(t,e)).fold(()=>{Xn(e)},c)}),i},cn=(e,t,n,s,o)=>{const i=e=>e+"px";return{position:e,left:t.map(i),top:n.map(i),right:s.map(i),bottom:o.map(i)}},H5=(t,n)=>{yc(t,(t=>({...t,position:e.some(t.position)}))(n))},wd=Ft([{none:[]},{relative:["x","y","width","height"]},{fixed:["x","y","width","height"]}]),f7=(t,n,s,o,i,a)=>{const d=n.rect,m=d.x-s,f=d.y-o,p=i-(m+d.width),g=a-(f+d.height),c=e.some(m),l=e.some(f),u=e.some(p),h=e.some(g),r=e.none();return n.direction.fold(()=>cn(t,c,l,r,r),()=>cn(t,r,l,u,r),()=>cn(t,c,r,r,h),()=>cn(t,r,r,u,h),()=>cn(t,c,l,r,r),()=>cn(t,c,r,r,h),()=>cn(t,c,l,r,r),()=>cn(t,r,l,u,r))},Ng=(t,n)=>t.fold(()=>{const t=n.rect;return cn("absolute",e.some(t.x),e.some(t.y),e.none(),e.none())},(e,t,s,o)=>f7("absolute",n,e,t,s,o),(e,t,s,o)=>f7("fixed",n,e,t,s,o)),fd=(e,t)=>{const n=Nt(Cl,t),s=e.fold(n,n,()=>{const e=bn();return Cl(t).translate(-e.left,-e.top)}),o=Ea(t),i=Ks(t);return Ve(s.left,s.top,o,i)},kj=(e,t)=>t.fold(()=>e.fold(Sn,Sn,Ve),t=>e.fold(t,t,()=>{const n=t(),s=I8(e,n.x,n.y);return Ve(s.left,s.top,n.width,n.height)})),I8=(e,t,s)=>{const o=ee(t,s);return e.fold(n(o),n(o),()=>{const e=bn();return o.translate(-e.left,-e.top)})};wd.none;const ry=wd.relative,x_=wd.fixed,Sl="data-alloy-placement",k2=e=>_t(e,Sl),Hc=Ft([{fit:["reposition"]},{nofit:["reposition","visibleW","visibleH","isVisible"]}]),bx=(e,t,s,o)=>{const a=e.bubble,r=a.offset,l=((e,t,n)=>{const s=(s,o)=>t[s].map(t=>{const i="top"===s||"bottom"===s,r=i?n.top:n.left,a=("left"===s||"top"===s?Math.max:Math.min)(t,o)+r;return i?zt(a,e.y,e.bottom):zt(a,e.x,e.right)}).getOr(o),o=s("left",e.x),i=s("top",e.y),a=s("right",e.right),r=s("bottom",e.bottom);return Ve(o,i,a-o,r-i)})(o,e.restriction,r),y=e.x+r.left,u=e.y+r.top,c=Ve(y,u,t,s),{originInBounds:g,sizeInBounds:p,visibleW:m,visibleH:f}=((e,t)=>{const{x:n,y:s,right:a,bottom:r}=t,{x:o,y:i,right:c,bottom:l,width:d,height:u}=e;return{originInBounds:o>=n&&o<=a&&i>=s&&i<=r,sizeInBounds:c<=a&&c>=n&&l<=r&&l>=s,visibleW:Math.min(d,o>=n?a-o:c-n),visibleH:Math.min(u,i>=s?r-i:l-s)}})(c,l),h=g&&p,i=h?c:((e,t)=>{const{x:a,y:l,right:c,bottom:i}=t,{x:d,y:u,width:o,height:r}=e,h=Math.max(a,c-o),m=Math.max(l,i-r),n=zt(d,a,h),s=zt(u,l,m),f=Math.min(n+o,c)-n,p=Math.min(s+r,i)-s;return Ve(n,s,f,p)})(c,l),v=i.width>0&&i.height>0,{maxWidth:b,maxHeight:j}=((e,t,s)=>{const a=n(t.bottom-s.y),o=n(s.bottom-t.y),r=((e,t,n,s)=>e.fold(t,t,s,s,t,s,n,n))(e,o,o,a),c=n(t.right-s.x),i=n(s.right-t.x),l=((e,t,n,s)=>e.fold(t,s,t,s,n,n,t,s))(e,i,i,c);return{maxWidth:l,maxHeight:r}})(e.direction,i,o),d={rect:i,maxHeight:j,maxWidth:b,direction:e.direction,placement:e.placement,classes:{on:a.classesOn,off:a.classesOff},layout:e.label,testY:u};return h||e.alwaysFit?Hc.fit(d):Hc.nofit(d,m,f,v)},cl=t=>{const n=v(e.none()),s=()=>n.get().each(t);return{clear:()=>{s(),n.set(e.none())},isSet:()=>n.get().isSome(),get:()=>n.get(),set:t=>{s(),n.set(e.some(t))}}},ui=()=>cl(e=>e.unbind()),q=()=>{const e=cl(c);return{...e,on:t=>e.get().each(t)}},f2=Oe,Ke=(e,t,n)=>((e,t,n,s)=>l2(e,t,n,s,!1))(e,t,f2,n),V0=(e,t,n)=>((e,t,n,s)=>l2(e,t,n,s,!0))(e,t,f2,n),F0=r2,Ep=["top","bottom","right","left"],uc="data-alloy-transition-timer",TC=(e,t,n,s,o,i)=>{const a=((e,t,n)=>n.exists(n=>{const s=e.mode;return"all"===s||n[s]!==t[s]}))(s,o,i);if(a||((e,t)=>((e,t)=>Ho(t,t=>mt(e,t)))(e,t.classes))(e,s)){y(e,"position",n.position);const r=fd(t,e),c=Ng(t,{...o,rect:r}),i=W2(Ep,e=>c[e]);((e,t)=>{const n=e=>parseFloat(e).toFixed(3);return Y1(t,(t,s)=>!((e,t,n=o5)=>ic(e,t,n).getOr(e.isNone()&&t.isNone()))(e[s].map(n),t.map(n))).isSome()})(n,i)&&(yc(e,i),a&&((e,t)=>{zs(e,t.classes),_t(e,uc).each(t=>{clearTimeout(parseInt(t,10)),ve(e,uc)}),((e,t)=>{const o=ui(),i=ui();let n;const a=t=>{var n;const s=null!==(n=t.raw.pseudoElement)&&void 0!==n?n:"";return G(t.target,e)&&!zu(s)&&_e(Ep,t.raw.propertyName)},s=s=>{if(Or(s)||a(s)){o.clear(),i.clear();const a=s?.raw.type;(Or(a)||a===Di())&&(clearTimeout(n),ve(e,uc),mn(e,t.classes))}},r=Ke(e,z9(),t=>{a(t)&&(r.unbind(),o.set(Ke(e,Di(),s)),i.set(Ke(e,F9(),s)))}),c=(e=>{const t=t=>{const n=ft(e,t).split(/\s*,\s*/);return K(n,zu)},n=e=>{if(L(e)&&/^[\d.]+/.test(e)){const t=parseFloat(e);return cc(e,"ms")?t:1e3*t}return 0},s=t("transition-delay"),o=t("transition-duration");return Ie(o,(e,t,o)=>{const i=n(s[o])+n(t);return Math.max(e,i)},0)})(e);requestAnimationFrame(()=>{n=setTimeout(s,c+17),_(e,uc,n)})})(e,t)})(e,s),Ai(e))}else mn(e,s.classes)},C0=(e,t)=>{((e,t)=>{const n=Jd.max(e,t,["margin-top","border-top-width","padding-top","padding-bottom","border-bottom-width","margin-bottom"]);y(e,"max-height",n+"px")})(e,Math.floor(t))},aC=n((e,t)=>{C0(e,t),Go(e,{"overflow-x":"hidden","overflow-y":"auto"})}),gi=n((e,t)=>{C0(e,t)}),z0=(e,t,n)=>void 0===e[t]?n:e[t],Zx=(e,t,s,o)=>{const i=((e,t,s,o)=>{I(t,"max-height"),I(t,"max-width");const a={width:Ea(i=t),height:Ks(i)};var i;return((e,t,s,o,i,a)=>{const r=o.width,c=o.height,l=(t,l,d,u,h)=>{const f=t(s,o,i,e,a),m=bx(f,r,c,a);return m.fold(n(m),(e,t,n,s)=>(h===s?n>u||t>d:!h&&s)?m:Hc.nofit(l,d,u,h))};return Ie(t,(e,t)=>{const s=Nt(l,t);return e.fold(n(e),s)},Hc.nofit({rect:s,maxHeight:o.height,maxWidth:o.width,direction:Fr(),placement:"southeast",classes:{on:[],off:[]},layout:"none",testY:s.y},-1,-1,!1)).fold(z,z)})(t,o.preference,e,a,s,o.bounds)})(e,t,s,o);return((e,t,n)=>{const s=Ng(n.origin,t);n.transition.each(o=>{TC(e,n.origin,s,o,t,n.lastPlacement)}),H5(e,s)})(t,i,o),((e,t)=>{((e,t)=>{_(e,Sl,t)})(e,t.placement)})(t,i),((e,t)=>{const n=t.classes;mn(e,n.off),zs(e,n.on)})(t,i),((e,t,n)=>{(0,n.maxHeightFunction)(e,t.maxHeight)})(t,i,o),((e,t,n)=>{(0,n.maxWidthFunction)(e,t.maxWidth)})(t,i,o),{layout:i.layout,placement:i.placement}},Qx=["valignCentre","alignLeft","alignRight","alignCentre","top","bottom","left","right","inset"],hi=(e,t,n,s=1)=>{const i=e*s,a=t*s,r=e=>f(n,e).getOr([]),o=(e,t,n)=>{const s=Hs(Qx,n);return{offset:ee(e,t),classesOn:le(n,r),classesOff:le(s,r)}};return{southeast:()=>o(-e,t,["top","alignLeft"]),southwest:()=>o(e,t,["top","alignRight"]),south:()=>o(-e/2,t,["top","alignCentre"]),northeast:()=>o(-e,-t,["bottom","alignLeft"]),northwest:()=>o(e,-t,["bottom","alignRight"]),north:()=>o(-e/2,-t,["bottom","alignCentre"]),east:()=>o(e,-t/2,["valignCentre","left"]),west:()=>o(-e,-t/2,["valignCentre","right"]),insetNortheast:()=>o(i,a,["top","alignLeft","inset"]),insetNorthwest:()=>o(-i,a,["top","alignRight","inset"]),insetNorth:()=>o(-i/2,a,["top","alignCentre","inset"]),insetSoutheast:()=>o(i,-a,["bottom","alignLeft","inset"]),insetSouthwest:()=>o(-i,-a,["bottom","alignRight","inset"]),insetSouth:()=>o(-i/2,-a,["bottom","alignCentre","inset"]),insetEast:()=>o(-i,-a/2,["valignCentre","right","inset"]),insetWest:()=>o(i,-a/2,["valignCentre","left","inset"])}},Uc=()=>hi(0,0,{}),Wc=z,al=(e,t)=>n=>"rtl"===kx(n)?t:e,kx=e=>"rtl"===ft(e,"direction")?"rtl":"ltr";!function(e){e.TopToBottom="toptobottom",e.BottomToTop="bottomtotop"}(ns||(ns={}));const ll="data-alloy-vertical-dir",Cx=e=>b3(e,e=>Ot(e)&&Ne(e,"data-alloy-vertical-dir")===ns.BottomToTop),hs=()=>bt("layouts",[s("onLtr"),s("onRtl"),D("onBottomLtr"),D("onBottomRtl")]),Pc=(e,t,n,s,o,i,a)=>{const r=a.map(Cx).getOr(!1),c=t.layouts.map(t=>t.onLtr(e)),l=t.layouts.map(t=>t.onRtl(e)),d=r?t.layouts.bind(t=>t.onBottomLtr.map(t=>t(e))).or(c).getOr(o):c.getOr(n),u=r?t.layouts.bind(t=>t.onBottomRtl.map(t=>t(e))).or(l).getOr(i):l.getOr(s);return al(d,u)(e)};q2=[s("hotspot"),D("bubble"),t("overrides",{}),hs(),W("placement",(t,n,s)=>{const o=n.hotspot,i=fd(s,o.element),a=Pc(t.element,n,r1(),i1(),Ph(),r8(),e.some(n.hotspot.element));return e.some(Wc({anchorBox:i,bubble:n.bubble.getOr(Uc()),overrides:n.overrides,layouts:a,placer:e.none()}))})],s3=[s("x"),s("y"),t("height",0),t("width",0),t("bubble",Uc()),t("overrides",{}),hs(),W("placement",(t,n,s)=>{const o=I8(s,n.x,n.y),i=Ve(o.left,o.top,n.width,n.height),a=Pc(t.element,n,X3(),Nh(),X3(),Nh(),e.none());return e.some(Wc({anchorBox:i,bubble:n.bubble,overrides:n.overrides,layouts:a,placer:e.none()}))})];const d3=Ft([{screen:["point"]},{absolute:["point","scrollLeft","scrollTop"]}]),Nw=e=>e.fold(z,(e,t,n)=>e.translate(-t,-n)),Aw=e=>e.fold(z,z),W3=e=>Ie(e,(e,t)=>e.translate(t.left,t.top),ee(0,0)),vh=e=>{const t=a(e,Aw);return W3(t)},tw=d3.screen,Q_=d3.absolute,$h=(t,n,s)=>{const i=rn(t.element),o=bn(i),a=((t,n,s)=>{const o=Vi(s.root).dom;return e.from(o.frameElement).map(l).filter(e=>{const n=rn(e),s=rn(t.element);return G(n,s)}).map(ls)})(t,0,s).getOr(o);return Q_(a,o.left,o.top)},Uh=(t,n,s,o)=>{const i=tw(ee(t,n));return e.some(((e,t,n)=>({point:e,width:t,height:n}))(i,s,o))},Xh=(t,n,s,o,i)=>t.map(t=>{const r=[n,t.point],h=(l=()=>vh(r),d=()=>vh(r),u=()=>(e=>{const t=a(e,Nw);return W3(t)})(r),o.fold(l,d,u));var l,d,u,f,p,g,v;const b=(f=h.left,p=h.top,g=t.width,v=t.height,{x:f,y:p,width:g,height:v}),c=s.showAbove?Ph():r1(),m=s.showAbove?r8():i1(),j=Pc(i,s,c,m,c,m,e.none());return Wc({anchorBox:b,bubble:s.bubble.getOr(Uc()),overrides:s.overrides,layouts:j,placer:e.none()})});nm=[s("node"),s("root"),D("bubble"),hs(),t("overrides",{}),t("showAbove",!1),W("placement",(e,t,n)=>{const s=$h(e,0,t);return t.node.filter(Xt).bind(o=>{const i=o.dom.getBoundingClientRect(),a=Uh(i.left,i.top,i.width,i.height),r=t.node.getOr(e.element);return Xh(a,s,t,n,r)})})];const El=(e,t,n,s)=>({start:e,soffset:t,finish:n,foffset:s}),kl=Ft([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),T_=(kl.before,kl.on,kl.after,e=>e.fold(z,z,z)),Rc=Ft([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),bi={domRange:Rc.domRange,relative:Rc.relative,exact:Rc.exact,exactFromRange:e=>Rc.exact(e.start,e.soffset,e.finish,e.foffset),getWin:e=>{const t=(e=>e.match({domRange:e=>l(e.startContainer),relative:(e)=>T_(e),exact:(e)=>e}))(e);return Vi(t)},range:El},ym=(e,t,n)=>{const o=e.document.createRange();var s;return s=o,t.fold(e=>{s.setStartBefore(e.dom)},(e,t)=>{s.setStart(e.dom,t)},e=>{s.setStartAfter(e.dom)}),((e,t)=>{t.fold(t=>{e.setEndBefore(t.dom)},(t,n)=>{e.setEnd(t.dom,n)},t=>{e.setEndAfter(t.dom)})})(o,n),o},Sm=(e,t,n,s,o)=>{const i=e.document.createRange();return i.setStart(t.dom,n),i.setEnd(s.dom,o),i},Fm=e=>({left:e.left,top:e.top,right:e.right,bottom:e.bottom,width:e.width,height:e.height}),ji=Ft([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),Lm=(e,t,n)=>t(l(n.startContainer),n.startOffset,l(n.endContainer),n.endOffset),Rm=(t,s)=>((t,s)=>{const o=((t,s)=>s.match({domRange:t=>({ltr:n(t),rtl:e.none}),relative:(n,s)=>({ltr:vs(()=>ym(t,n,s)),rtl:vs(()=>e.some(ym(t,s,n)))}),exact:(n,s,o,i)=>({ltr:vs(()=>Sm(t,n,s,o,i)),rtl:vs(()=>e.some(Sm(t,o,i,n,s)))})}))(t,s);return((e,t)=>{const n=t.ltr();return n.collapsed?t.rtl().filter(e=>!1===e.collapsed).map(e=>ji.rtl(l(e.endContainer),e.endOffset,l(e.startContainer),e.startOffset)).getOrThunk(()=>Lm(0,ji.ltr,n)):Lm(0,ji.ltr,n)})(0,o)})(t,s).match({ltr:(e,n,s,o)=>{const i=t.document.createRange();return i.setStart(e.dom,n),i.setEnd(s.dom,o),i},rtl:(e,n,s,o)=>{const i=t.document.createRange();return i.setStart(s.dom,o),i.setEnd(e.dom,n),i}});ji.ltr,ji.rtl;const $e=(e,t)=>((e,t)=>{const n=void 0===t?document:t.dom;return $3(n)?[]:a(n.querySelectorAll(e),l)})(t,e),Gm=t=>{if(t.rangeCount>0){const n=t.getRangeAt(0),s=t.getRangeAt(t.rangeCount-1);return e.some(El(l(n.startContainer),n.startOffset,l(s.endContainer),s.endOffset))}return e.none()},Oy=t=>{if(null===t.anchorNode||null===t.focusNode)return Gm(t);{const n=l(t.anchorNode),s=l(t.focusNode);return((e,t,n,s)=>{const o=((e,t,n,s)=>{const o=rn(e).dom.createRange();return o.setStart(e.dom,t),o.setEnd(n.dom,s),o})(e,t,n,s),i=G(e,n)&&t===s;return o.collapsed&&!i})(n,t.anchorOffset,s,t.focusOffset)?e.some(El(n,t.anchorOffset,s,t.focusOffset)):Gm(t)}},O4=(t,n)=>(t=>{const s=t.getClientRects(),n=s.length>0?s[0]:t.getBoundingClientRect();return n.width>0||n.height>0?e.some(n).map(Fm):e.none()})(Rm(t,n)),jy=((t)=>{const s=n=>t(n)?e.from(n.dom.nodeValue):e.none();return{get:e=>{if(!t(e))throw new Error("Can only get text value of a text node");return s(e).getOr("")},getOption:s,set:(e,n)=>{if(!t(e))throw new Error("Can only set raw text value of a text node");e.dom.nodeValue=n}}})(to),Dc=(e,t)=>({element:e,offset:t}),cf=(e,t)=>to(e)?Dc(e,t):((e,t)=>{const n=On(e);if(0===n.length)return Dc(e,t);if(t<n.length)return Dc(n[t],0);{const e=n[n.length-1],t=to(e)?(e=>jy.get(e))(e).length:On(e).length;return Dc(e,t)}})(e,t),zf=(t,n)=>n.getSelection.getOrThunk(()=>()=>(t=>(t=>e.from(t.getSelection()))(t).filter(e=>e.rangeCount>0).bind(Oy))(t))().map(e=>{const t=cf(e.start,e.soffset),n=cf(e.finish,e.foffset);return bi.range(t.element,t.offset,n.element,n.offset)});Nf=[D("getSelection"),s("root"),D("bubble"),hs(),t("overrides",{}),t("showAbove",!1),W("placement",(t,n,s)=>{const o=Vi(n.root).dom,i=$h(t,0,n),a=zf(o,n).bind(t=>{const n=((t,n)=>(t=>{const n=t.getBoundingClientRect();return n.width>0||n.height>0?e.some(n).map(Fm):e.none()})(Rm(t,n)))(o,bi.exactFromRange(t)).orThunk(()=>{const e=yg("");ki(t.start,e);const n=O4(o,bi.exact(e,0,e,1));return Ln(e),n});return n.bind(e=>Uh(e.left,e.top,e.width,e.height))}),r=zf(o,n).bind(t=>Ot(t.start)?e.some(t.start):Ki(t.start)).getOr(t.element);return Xh(a,i,n,s,r)})];const zc="link-layout",If=e=>e.x+e.width,Jf=(e,t)=>e.x-t.width,l6=(e,t)=>e.y-t.height+e.height,E6=e=>e.y,k6=(e,t,n)=>Ae(If(e),E6(e),n.southeast(),Fr(),"southeast",Me(e,{left:0,top:2}),zc),$6=(e,t,n)=>Ae(Jf(e,t),E6(e),n.southwest(),j4(),"southwest",Me(e,{right:1,top:2}),zc),Q6=(e,t,n)=>Ae(If(e),l6(e,t),n.northeast(),_4(),"northeast",Me(e,{left:0,bottom:3}),zc),lp=(e,t,n)=>Ae(Jf(e,t),l6(e,t),n.northwest(),Gc(),"northwest",Me(e,{right:1,bottom:3}),zc),up=()=>[k6,$6,Q6,lp],fp=()=>[$6,k6,lp,Q6];vp=[s("item"),hs(),t("overrides",{}),W("placement",(t,n,s)=>{const o=fd(s,n.item.element),i=Pc(t.element,n,up(),fp(),up(),fp(),e.none());return e.some(Wc({anchorBox:o,bubble:Uc(),overrides:n.overrides,layouts:i,placer:e.none()}))})],bp=lt("type",{selection:Nf,node:nm,hotspot:q2,submenu:vp,makeshift:s3});const H9=[St("classes",Ee),zn("mode","all",["all","layout","placement"])],P9=[t("useFixed",U),D("getBounds")],L9=[vt("anchor",bp),bt("transition",H9)],O9=(e,t,n,s,o,i,a)=>((e,t,n,s,o,i,a,r)=>{const d=z0(a,"maxHeightFunction",aC()),u=z0(a,"maxWidthFunction",c),h=e.anchorBox,l=e.origin,m={bounds:kj(l,i),origin:l,preference:s,maxHeightFunction:d,maxWidthFunction:u,lastPlacement:o,transition:r};return Zx(h,t,n,m)})(((e,t)=>((e,t)=>({anchorBox:e,origin:t}))(e,t))(n.anchorBox,t),o.element,n.bubble,n.layouts,i,s,n.overrides,a),fg=(e,t,n,s,o,i)=>{const a=i.map(it);return wg(e,t,n,s,o,a)},wg=(e,t,s,o,i,a)=>{const c=Ge("placement.info",m(L9),i),l=c.anchor,r=o.element,d=s.get(o.uid);Hd(()=>{y(r,"position","fixed");const u=Le(r,"visibility");y(r,"visibility","hidden");const i=t.useFixed()?(()=>{const e=document.documentElement;return x_(0,0,e.clientWidth,e.clientHeight)})():(e=>{const t=ls(e.element),n=e.element.dom.getBoundingClientRect();return ry(t.left,t.top,n.width,n.height)})(e),h=l.placement,m=a.map(n).or(t.getBounds);h(e,l,i).each(t=>{const n=t.placer.getOr(O9)(e,i,t,m,o,d,c.transition);s.set(o.uid,n)}),u.fold(()=>{I(r,"visibility")},e=>{y(r,"visibility",e)}),Le(r,"left").isNone()&&Le(r,"top").isNone()&&Le(r,"right").isNone()&&Le(r,"bottom").isNone()&&sn(Le(r,"position"),"fixed")&&I(r,"position")},r)};Cg=Object.freeze({__proto__:null,position:(t,n,s,o,i)=>{fg(t,n,s,o,i,e.none())},positionWithin:fg,positionWithinBounds:wg,getMode:(e,t)=>t.useFixed()?"fixed":"absolute",reset:(e,t,n,s)=>{const o=s.element;h(["position","left","right","top","bottom"],e=>I(o,e)),(e=>{ve(e,Sl)})(o),n.clear(s.uid)}});const Ye=we({fields:P9,name:"positioning",active:dg,apis:Cg,state:Object.freeze({__proto__:null,init:()=>{let e={};return jt({readState:()=>e,clear:t=>{Wt(t)?delete e[t]:e={}},set:(t,n)=>{e[t]=n},get:t=>f(e,t)})}})}),md=e=>e.getSystem().isConnected(),yi=e=>{T(e,mi());const t=e.components();h(t,yi)},wi=e=>{const t=e.components();h(t,wi),T(e,Vs())},Qg=(e,t)=>{e.getSystem().addToWorld(t),Xt(e.element)&&wi(t)},vd=e=>{yi(e),e.getSystem().removeFromWorld(e)},c5=(e,t)=>{Ht(e.element,t.element)},Ys=(e,t)=>{p7(e,t,Ht)},p7=(e,t,n)=>{e.getSystem().addToWorld(t),n(e.element,t.element),Xt(e.element)&&wi(t),e.syncComponents()},_7=e=>{yi(e),Ln(e.element),e.getSystem().removeFromWorld(e)},Un=e=>{const t=Cn(e.element).bind(t=>e.getSystem().getByDom(t).toOptional());_7(e),t.each(e=>{e.syncComponents()})},x7=e=>{const t=e.components();h(t,_7),gl(e.element),e.syncComponents()},xd=(e,t)=>{C7(e,t,Ht)},C7=(e,t,n)=>{n(e,t.element);const s=On(t.element);h(s,e=>{t.getByDom(e).each(wi)})},$y=e=>{const t=On(e.element);h(t,t=>{e.getByDom(t).each(yi)}),Ln(e.element)},A7=(e,t,n,s)=>{n.get().each(t=>{x7(e)});const i=t.getAttachPoint(e);Ys(i,e);const o=e.getSystem().build(s);return Ys(e,o),n.set(o),o},M7=(e,t,n,s)=>{const o=A7(e,t,n,s);return t.onOpen(e,o),o},w7=(e,t,n)=>{n.get().each(s=>{x7(e),Un(e),t.onClose(e,s),n.clear()})},g7=(e,t,n)=>n.isOpen(),u7=(e,t)=>{const s=t.getAttachPoint(e);y(e.element,"position",Ye.getMode(s)),((e,t,n)=>{Le(e.element,t).fold(()=>{ve(e.element,n)},t=>{_(e.element,n,t)}),y(e.element,t,"hidden")})(e,"visibility",t.cloakVisibilityAttr)},a7=(e,t)=>{(e=>nn(["top","left","right","bottom"],t=>Le(e,t).isSome()))(e.element)||I(e.element,"position"),((e,t,n)=>{_t(e.element,n).fold(()=>I(e.element,t),n=>y(e.element,t,n))})(e,"visibility",t.cloakVisibilityAttr)};var uv=Object.freeze({__proto__:null,cloak:u7,decloak:a7,open:M7,openWhileCloaked:(e,t,n,s,o)=>{u7(e,t),M7(e,t,n,s),o(),a7(e,t)},close:w7,isOpen:g7,isPartOf:(e,t,n,s)=>g7(0,0,n)&&n.get().exists(n=>t.isPartOf(e,n,s)),getState:(e,t,n)=>n.get(),setContent:(e,t,n,s)=>n.get().map(()=>A7(e,t,n,s))}),hv=Object.freeze({__proto__:null,events:(e,t)=>$([o(Tc(),(n)=>{w7(n,e,t)})])}),mv=[C("onOpen"),C("onClose"),s("isPartOf"),s("getAttachPoint"),t("cloakVisibilityAttr","data-precloak-visibility")],fv=Object.freeze({__proto__:null,init:()=>{const e=q(),t=n("not-implemented");return jt({readState:t,isOpen:e.isSet,clear:e.clear,set:e.set,get:e.get})}});const k=we({fields:mv,name:"sandboxing",active:hv,apis:uv,state:fv}),Es=n("dismiss.popups"),ci=n("reposition.popups"),Id=n("mouse.released"),Ov=gt([t("isExtraPart",U),bt("fireEventInstead",[t("event",di())])]),Vd=e=>{const t=Ge("Dismissal",Ov,e);return{[Es()]:{schema:gt([s("target")]),onReceive:(e,n)=>{k.isOpen(e)&&(k.isPartOf(e,n.target)||t.isExtraPart(e,n.target)||t.fireEventInstead.fold(()=>k.close(e),t=>T(e,t.event)))}}}},Mv=gt([bt("fireEventInstead",[t("event",yp())]),Rt("doReposition")]),Wd=e=>{const t=Ge("Reposition",Mv,e);return{[ci()]:{onReceive:e=>{k.isOpen(e)&&t.fireEventInstead.fold(()=>t.doReposition(e),t=>T(e,t.event))}}}},Ud=(e,t,n)=>{t.store.manager.onLoad(e,t,n)},M5=(e,t,n)=>{t.store.manager.onUnload(e,t,n)};E5=Object.freeze({__proto__:null,onLoad:Ud,onUnload:M5,setValue:(e,t,n,s)=>{t.store.manager.setValue(e,t,n,s)},getValue:(e,t,n)=>t.store.manager.getValue(e,t,n),getState:(e,t,n)=>n}),O5=Object.freeze({__proto__:null,events:(e,t)=>{const n=e.resetOnDom?[Q((n)=>{Ud(n,e,t)}),_n((n)=>{M5(n,e,t)})]:[Tu(e,t,Ud)];return $(n)}});const h5=()=>{const e=v(null);return jt({set:e.set,get:e.get,isNotSet:()=>null===e.get(),clear:()=>{e.set(null)},readState:()=>({mode:"memory",value:e.get()})})},u5=()=>{const e=v({}),t=v({});return jt({readState:()=>({mode:"dataset",dataByValue:e.get(),dataByText:t.get()}),lookup:n=>f(e.get(),n).orThunk(()=>f(t.get(),n)),update:n=>{const i=e.get(),a=t.get(),s={},o={};h(n,e=>{s[e.value]=e,f(e,"meta").each(t=>{f(t,"text").each(t=>{o[t]=e})})}),e.set({...i,...s}),t.set({...a,...o})},clear:()=>{e.set({}),t.set({})}})};r5=Object.freeze({__proto__:null,memory:h5,dataset:u5,manual:()=>jt({readState:c}),init:e=>e.store.manager.state(e)});const e5=(e,t,n,s)=>{const o=t.store;n.update([s]),o.setValue(e,s),t.onSetValue(e,s)};var Qv=[D("initialValue"),s("getFallbackEntry"),s("getDataKey"),s("setValue"),W("manager",{setValue:e5,getValue:(e,t,n)=>{const s=t.store,o=s.getDataKey(e);return n.lookup(o).getOrThunk(()=>s.getFallbackEntry(o))},onLoad:(e,t,n)=>{t.store.initialValue.each(s=>{e5(e,t,n,s)})},onUnload:(e,t,n)=>{n.clear()},state:u5})],e9=[s("getValue"),t("setValue",c),D("initialValue"),W("manager",{setValue:(e,t,n,s)=>{t.store.setValue(e,s),t.onSetValue(e,s)},getValue:(e,t)=>t.store.getValue(e),onLoad:(e,t)=>{t.store.initialValue.each(n=>{t.store.setValue(e,n)})},onUnload:c,state:en.init})],l9=[D("initialValue"),W("manager",{setValue:(e,t,n,s)=>{n.set(s),t.onSetValue(e,s)},getValue:(e,t,n)=>n.get(),onLoad:(e,t,n)=>{t.store.initialValue.each(e=>{n.isNotSet()&&n.set(e)})},onUnload:(e,t,n)=>{n.clear()},state:h5})],b9=[Mt("store",{mode:"memory"},lt("mode",{memory:l9,manual:e9,dataset:Qv})),C("onSetValue"),t("resetOnDom",!1)];const r=we({fields:b9,name:"representing",active:O5,apis:E5,extra:{setValueFrom:(e,t)=>{const n=r.getValue(t);r.setValue(e,n)}},state:r5}),fe=(e,t)=>Yc(e,{},a(t,t=>{return n=t.name(),s="Cannot configure "+t.name()+" for "+e,xe(n,n,{tag:"option",process:{}},Uo(e=>fo("The field: "+n+" is forbidden. "+s)));var n,s}).concat([We("dump",z)])),iu=e=>e.dump,ye=(e,t)=>({...i(t),...e.dump}),si=fe,ni=ye,Yp="placeholder",jc=Ft([{single:["required","valueThunk"]},{multiple:["required","valueThunks"]}]),uu=e=>R(e,"uiType"),$p=(e,t,s,o)=>((e,t,s,o)=>uu(s)&&s.uiType===Yp?((e,t,s,o)=>e.exists(e=>e!==s.owner)?jc.single(!0,n(s)):f(o,s.name).fold(()=>{throw new Error("Unknown placeholder component: "+s.name+`
Known: [`+ce(o)+`]
Namespace: `+e.getOr("none")+`
Spec: `+JSON.stringify(s,null,2))},e=>e.replace()))(e,0,s,o):jc.single(!1,n(s)))(e,0,s,o).fold((n,i)=>{const a=uu(s)?i(t,s.config,s.validated):i(t),r=f(a,"components").getOr([]),c=le(r,n=>$p(e,t,n,o));return[{...a,components:c}]},(e,n)=>{if(uu(s)){const e=n(t,s.config,s.validated);return s.validated.preprocess.getOr(z)(e)}return n(t)}),Ip=jc.single,$9=jc.multiple,Ap=n(Yp),bc=Ft([{required:["data"]},{external:["data"]},{optional:["data"]},{group:["data"]}]),vc=t("factory",{sketch:z}),bu=t("schema",[]),gc=s("name"),yu=xe("pname","pname",Vr(e=>"<alloy."+d(e.name)+">"),ln()),tb=We("schema",()=>[D("preprocess")]),pc=t("defaults",n({})),fc=t("overrides",n({})),Ob=m([vc,bu,gc,yu,pc,fc]),kb=m([vc,bu,gc,pc,fc]),Ab=m([vc,bu,gc,yu,pc,fc]),zb=m([vc,tb,gc,s("unit"),yu,pc,fc]),P6=t=>t.fold(e.some,e.none,e.some,e.some),f6=e=>{const t=e=>e.name;return e.fold(t,t,t,t)},mc=(e,t)=>n=>{const s=Ge("Converting part type",t,n);return e(s)},Fe=mc(bc.required,Ob),Lt=mc(bc.external,kb),wt=mc(bc.optional,Ab),dc=mc(bc.group,zb),Nu=n("entirety");t6=Object.freeze({__proto__:null,required:Fe,external:Lt,optional:wt,group:dc,asNamedPart:P6,name:f6,asCommon:e=>e.fold(z,z,z,z),original:Nu});const Ru=(e,t,n,s)=>te(t.defaults(e,n,s),n,{uid:e.partUids[t.name]},t.overrides(e,n,s)),Pu=(e,t)=>{const n={};return h(t,t=>{P6(t).each(t=>{const s=pj(e,t.pname);n[t.name]=n=>{const o=Ge("Part: "+t.name+" in "+e,m(t.schema),n);return{...s,config:n,validated:o}}})}),n},pj=(e,t)=>({uiType:Ap(),owner:e,name:t}),Iu=(e,t,n)=>({uiType:Ap(),owner:e,name:t,config:n,validated:{}}),Xf=t=>le(t,t=>t.fold(e.none,e.some,e.none,e.none).map(e=>Os(e.name,e.schema.concat([W0(Nu())]))).toArray()),Vf=e=>a(e,f6),$u=(e,t,s)=>((e,t,s)=>{const o={},i={};return h(s,e=>{e.fold(e=>{o[e.pname]=Ip(!0,(t,n,s)=>e.factory.sketch(Ru(t,e,n,s)))},e=>{const s=t.parts[e.name];i[e.name]=n(e.factory.sketch(Ru(t,e,s[Nu()]),s))},e=>{o[e.pname]=Ip(!1,(t,n,s)=>e.factory.sketch(Ru(t,e,n,s)))},e=>{o[e.pname]=$9(!0,(t,n,s)=>{const o=t[e.name];return a(o,n=>e.factory.sketch(te(e.defaults(t,n,s),n,e.overrides(t,n))))})})}),{internals:n(o),externals:n(i)}})(0,t,s),Wu=(t,s,o)=>((e,t,s,o)=>{const i=je(o,(e,t)=>((e,t)=>{let s=!1;return{name:n(e),required:()=>t.fold((e)=>e,(e)=>e),used:()=>s,replace:()=>{if(s)throw new Error("Trying to use the same placeholder more than once: "+e);return s=!0,t}}})(t,e)),a=((e,t,n,s)=>le(n,n=>$p(e,t,n,s)))(e,t,s,i);return Re(i,n=>{if(!1===n.used()&&n.required())throw new Error("Placeholder: "+n.name()+` was not found in components list
Namespace: `+e.getOr("none")+`
Components: `+JSON.stringify(t.components,null,2))}),a})(e.some(t),s,s.components,o),P=(e,t,n)=>{const s=t.partUids[n];return e.getSystem().getByUid(s).toOptional()},kn=(e,t,n)=>P(e,t,n).getOrDie("Could not find part: "+n),bf=(e,t,s)=>{const o={},i=t.partUids,a=e.getSystem();return h(s,e=>{o[e]=n(a.getByUid(i[e]))}),o},df=(e,t)=>{const s=e.getSystem();return je(t.partUids,(e)=>n(s.getByUid(e)))},rf=e=>ce(e.partUids),Xu=(e,t,s)=>{const o={},i=t.partUids,a=e.getSystem();return h(s,e=>{o[e]=n(a.getByUid(i[e]).getOrDie())}),o},af=(e,t)=>{const n=Vf(t);return xo(a(n,t=>({key:t,value:e+"-"+t})))},Zu=e=>xe("partUids","partUids",Kl(t=>af(t.uid,e)),ln());sf=Object.freeze({__proto__:null,generate:Pu,generateOne:Iu,schemas:Xf,names:Vf,substitutes:$u,components:Wu,defaultUids:af,defaultUidsSchema:Zu,getAllParts:df,getAllPartNames:rf,getPart:P,getPartOrDie:kn,getParts:bf,getPartsOrDie:Xu});const ef=(e,n,o,i,a)=>{const r=((e,n)=>(e.length>0?[Os("parts",e)]:[]).concat([s("uid"),t("dom",{}),t("components",[]),W0("originalSpec"),t("debug.sketcher",{})]).concat(n))(i,a);return Ge(e+" [SpecSchema]",gt(r.concat(n)),o)},t1=(e,t,n,s,o)=>{const a=q8(o),c=Xf(n),l=Zu(n),i=ef(e,t,a,c,[l]),r=$u(0,i,n);return s(i,Wu(e,i,r.internals()),a,r.externals())},q8=e=>(e=>R(e,"uid"))(e)?e:{...e,uid:Co("uid")},oy=gt([s("name"),s("factory"),s("configFields"),t("apis",{}),t("extraApis",{})]),iy=gt([s("name"),s("factory"),s("configFields"),s("partFields"),t("apis",{}),t("extraApis",{})]),pt=e=>{const t=Ge("Sketcher for "+e.name,oy,e),n=je(t.apis,or),s=je(t.extraApis,(e,t)=>u1(e,t));return{name:t.name,configFields:t.configFields,sketch:e=>((e,t,n,s)=>{const o=q8(s);return n(ef(e,t,o,[],[]),o)})(t.name,t.configFields,t.factory,e),...n,...s}},Be=e=>{const t=Ge("Sketcher for "+e.name,iy,e),n=Pu(t.name,t.partFields),s=je(t.apis,or),o=je(t.extraApis,(e,t)=>u1(e,t));return{name:t.name,partFields:t.partFields,configFields:t.configFields,sketch:e=>t1(t.name,t.configFields,t.partFields,t.factory,e),parts:n,...s,...o}},ti=e=>tp("input")(e)&&"radio"!==Ne(e,"type")||tp("textarea")(e);p8=Object.freeze({__proto__:null,getCurrent:(e,t)=>t.find(e)});const _y=[s("find")],O=we({fields:_y,name:"composing",apis:p8}),ky=["input","button","textarea","select"],i8=(e,t)=>{(t.disabled()?b1:j1)(e,t)},m1=(e,t)=>!0===t.useNative&&_e(ky,qn(e.element)),zy=e=>{_(e.element,"disabled","disabled")},__=e=>{ve(e.element,"disabled")},C_=e=>{_(e.element,"aria-disabled","true")},k_=e=>{_(e.element,"aria-disabled","false")},b1=(e,t)=>{t.disableClass.each(t=>{me(e.element,t)}),(m1(e,t)?zy:C_)(e),t.onDisabled(e)},j1=(e,t)=>{t.disableClass.each(t=>{ie(e.element,t)}),(m1(e,t)?__:k_)(e),t.onEnabled(e)},rm=(e,t)=>m1(e,t)?(e=>Km(e.element,"disabled"))(e):(e=>"true"===Ne(e.element,"aria-disabled"))(e);var S_=Object.freeze({__proto__:null,enable:j1,disable:b1,isDisabled:rm,onLoad:i8,set:(e,t,n,s)=>{(s?b1:j1)(e,t)}}),P_=Object.freeze({__proto__:null,exhibit:(e,t)=>Zt({classes:t.disabled()?t.disableClass.toArray():[]}),events:(e,t)=>$([z6(ut(),(t)=>rm(t,e)),Tu(e,t,i8)])}),$_=[ue("disabled",U),t("useNative",!0),D("disableClass"),C("onDisabled"),C("onEnabled")];const g=we({fields:$_,name:"disabling",active:P_,apis:S_}),Rh=(e,t,n,s)=>{const o=$e(e.element,"."+t.highlightClass);h(o,n=>{nn(s,e=>G(e.element,n))||(ie(n,t.highlightClass),e.getSystem().getByDom(n).each(n=>{t.onDehighlight(e,n),T(n,Ou())}))})},Ri=(e,t,n,s)=>{Rh(e,t,0,[s]),k1(e,t,n,s)||(me(s.element,t.highlightClass),t.onHighlight(e,s),T(s,np()))},k1=(e,t,n,s)=>mt(s.element,t.highlightClass),Mh=(e,t)=>pe(e.element,"."+t.itemClass).bind(t=>e.getSystem().getByDom(t).toOptional()),Ah=(t,n)=>{const o=$e(t.element,"."+n.itemClass);return(o.length>0?e.some(o[o.length-1]):e.none()).bind(e=>t.getSystem().getByDom(e).toOptional())},dh=(e,t,n,s)=>{const o=$e(e.element,"."+t.itemClass);return zo(o,e=>mt(e,t.highlightClass)).bind(t=>{const n=Xo(t,s,0,o.length-1);return e.getSystem().getByDom(o[n]).toOptional()})},sh=(e,t)=>{const s=$e(e.element,"."+t.itemClass);return so(a(s,t=>e.getSystem().getByDom(t).toOptional()))};J3=Object.freeze({__proto__:null,dehighlightAll:(e,t)=>Rh(e,t,0,[]),dehighlight:(e,t,n,s)=>{k1(e,t,n,s)&&(ie(s.element,t.highlightClass),t.onDehighlight(e,s),T(s,Ou()))},highlight:Ri,highlightFirst:(e,t,n)=>{Mh(e,t).each(s=>{Ri(e,t,n,s)})},highlightLast:(e,t,n)=>{Ah(e,t).each(s=>{Ri(e,t,n,s)})},highlightAt:(t,n,s,o)=>{((t,n,s,o)=>{const i=$e(t.element,"."+n.itemClass);return e.from(i[o]).fold(()=>x.error(new Error("No element found with index "+o)),t.getSystem().getByDom)})(t,n,0,o).fold(e=>{throw e},e=>{Ri(t,n,s,e)})},highlightBy:(e,t,n,s)=>{const o=sh(e,t);ne(o,s).each(s=>{Ri(e,t,n,s)})},isHighlighted:k1,getHighlighted:(e,t)=>pe(e.element,"."+t.highlightClass).bind(t=>e.getSystem().getByDom(t).toOptional()),getFirst:Mh,getLast:Ah,getPrevious:(e,t)=>dh(e,t,0,-1),getNext:(e,t)=>dh(e,t,0,1),getCandidates:sh}),Z3=[s("highlightClass"),s("itemClass"),C("onHighlight"),C("onDehighlight")];const F=we({fields:Z3,name:"highlighting",apis:J3}),_w=[8],ws=[9],En=[13],ec=[27],at=[32],Jr=[37],Ii=[38],Yr=[39],ei=[40],Ow=(e,t,n)=>{const s=xa(e.slice(0,t)),o=xa(e.slice(t+1));return ne(s.concat(o),n)},Ew=(e,t,n)=>{const s=xa(e.slice(0,t));return ne(s,n)},kw=(e,t,n)=>{const s=e.slice(0,t),o=e.slice(t+1);return ne(o.concat(s),n)},OO=(e,t,n)=>{const s=e.slice(t+1);return ne(s,n)},E=e=>t=>{const n=t.raw;return _e(e,n.which)},dn=e=>t=>Ho(e,e=>e(t)),Zo=e=>!0===e.raw.shiftKey,LO=e=>!0===e.raw.ctrlKey,Ui=Ta(Zo),S=(e,t)=>({matches:e,classification:t}),e3=(e,t,n)=>{t.exists(e=>n.exists(t=>G(t,e)))||p(e,jp(),{prevFocus:t,newFocus:n})},t4=()=>{const e=e=>Jt(e.element);return{get:e,set:(t,n)=>{const s=e(t);t.getSystem().triggerFocus(n,t.element);const o=e(t);e3(t,s,o)}}},PO=()=>{const e=e=>F.getHighlighted(e).map(e=>e.element);return{get:e,set:(t,n)=>{const s=e(t);t.getSystem().getByDom(n).fold(c,e=>{F.highlight(t,e)});const o=e(t);e3(t,s,o)}}};!function(e){e.OnFocusMode="onFocus",e.OnEnterOrSpaceMode="onEnterOrSpace",e.OnApiMode="onApi"}($r||($r={}));const co=(n,s,i,a,r)=>{const c=(e,t,n,s,o)=>{return(i=n(e,t,s,o),a=t.event,ne(i,e=>e.matches(a)).map(e=>e.classification)).bind(n=>n(e,t,s,o));var i,a},l={schema:()=>n.concat([t("focusManager",t4()),Mt("focusInside","onFocus",ma(e=>_e(["onFocus","onEnterOrSpace","onApi"],e)?x.value(e):x.error("Invalid value for focusInside"))),W("handler",l),W("state",s),W("sendFocusIn",r)]),processKey:c,toEvents:(t,n)=>{const s=t.focusInside!==$r.OnFocusMode?e.none():r(t).map(e=>o(rs(),(s,o)=>{e(s,t,n),o.stop()})),l=[o($i(),(e,s)=>{c(e,s,i,t,n).fold(()=>{((e,s)=>{const o=E(at.concat(En))(s.event);t.focusInside===$r.OnEnterOrSpaceMode&&o&&a5(e,s)&&r(t).each(o=>{o(e,t,n),s.stop()})})(e,s)},e=>{s.stop()})}),o(k9(),(e,s)=>{c(e,s,a,t,n).each(e=>{s.stop()})})];return $(s.toArray().concat(l))}};return l},$2=s=>{const a=[D("onEscape"),D("onEnter"),t("selector",'[data-alloy-tabstop="true"]:not(:disabled)'),t("firstTabstop",0),t("useTabstopAt",Oe),D("visibilitySelector")].concat([s]),o=(e,t)=>{const n=e.visibilitySelector.bind(e=>hn(t,e)).getOr(t);return Pe(n)>0},r=(t,n)=>{((t,n)=>{const s=$e(t.element,n.selector),i=K(s,e=>o(n,e));return e.from(i[n.firstTabstop])})(t,n).each(e=>{n.focusManager.set(t,e)})},i=(t,n,s,i)=>{const a=$e(t.element,s.selector);return((e,t)=>t.focusManager.get(e).bind(e=>hn(e,t.selector)))(t,s).bind(n=>zo(a,Nt(G,n)).bind(n=>((t,n,s,i,a)=>a(n,s,e=>((e,t)=>o(e,t)&&e.useTabstopAt(t))(i,e)).fold(()=>i.cyclic?e.some(!0):e.none(),n=>(i.focusManager.set(t,n),e.some(!0))))(t,a,n,s,i)))},c=n([S(dn([Zo,E(ws)]),(e,t,n)=>{const s=n.cyclic?Ow:Ew;return i(e,0,n,s)}),S(E(ws),(e,t,n)=>{const s=n.cyclic?kw:OO;return i(e,0,n,s)}),S(dn([Ui,E(En)]),(e,t,n)=>n.onEnter.bind(n=>n(e,t)))]),l=n([S(E(ec),(e,t,n)=>n.onEscape.bind(n=>n(e,t)))]);return co(a,en.init,c,l,()=>e.some(r))};H2=$2(We("cyclic",U)),L2=$2(We("cyclic",Oe));const qi=(t,n,s)=>ti(s)&&E(at)(n.event)?e.none():((t,n,s)=>(ku(t,s,ut()),e.some(!0)))(t,0,s),qo=()=>e.some(!0),hx=[t("execute",qi),t("useSpace",!1),t("useEnter",!0),t("useControlEnter",!1),t("useDown",!1)],h2=(e,t,n)=>n.execute(e,t,e.element);u2=co(hx,en.init,(e,t,n)=>{const o=n.useSpace&&!ti(e.element)?at:[],i=n.useEnter?En:[],a=n.useDown?ei:[],r=o.concat(i).concat(a);return[S(E(r),h2)].concat(n.useControlEnter?[S(dn([LO,E(En)]),h2)]:[])},(e,t,n)=>n.useSpace&&!ti(e.element)?[S(E(at),qo)]:[],()=>e.none());const Q0=()=>{const e=q();return jt({readState:()=>e.get().map(e=>({numRows:String(e.numRows),numColumns:String(e.numColumns)})).getOr({numRows:"?",numColumns:"?"}),setGridSize:(t,n)=>{e.set({numRows:t,numColumns:n})},getNumRows:()=>e.get().map(e=>e.numRows),getNumColumns:()=>e.get().map(e=>e.numColumns)})};R0=Object.freeze({__proto__:null,flatgrid:Q0,init:e=>e.state(e)});const T0=e=>(t,n,s,o)=>{const i=e(t.element);return G4(i,t,n,s,o)},g4=(e,t)=>{const n=al(e,t);return T0(n)},v4=(e,t)=>{const n=al(t,e);return T0(n)},b4=e=>(t,n,s,o)=>G4(e,t,n,s,o),G4=(e,t,n,s,o)=>s.focusManager.get(t).bind(n=>e(t.element,n,s,o)).map(e=>(s.focusManager.set(t,e),!0)),V4=b4,I4=b4,Nr=b4,f8=e=>!(e=>e.offsetWidth<=0&&e.offsetHeight<=0)(e.dom),x4=(e,t,n)=>{const s=$e(e,n);return((e)=>zo(e,e=>G(e,t)).map(t=>({index:t,candidates:e})))(K(s,f8))},C4=(e,t)=>zo(e,e=>G(t,e)),E4=(t,n,s,o)=>o(Math.floor(n/s),n%s).bind(n=>{const o=n.row*s+n.column;return o>=0&&o<t.length?e.some(t[o]):e.none()}),k4=(t,n,s,o,i)=>E4(t,n,o,(n,a)=>{const r=n===s-1?t.length-n*o:o,c=Xo(a,i,0,r-1);return e.some({row:n,column:c})}),A4=(t,n,s,o,i)=>E4(t,n,o,(n,a)=>{const r=Xo(n,i,0,s-1),c=r===s-1?t.length-r*o:o,l=zt(a,0,c-1);return e.some({row:r,column:l})}),QC=[s("selector"),t("execute",qi),ot("onEscape"),t("captureTab",!1),D0()],GC=(e,t)=>{pe(e.element,t.selector).each(n=>{t.focusManager.set(e,n)})},Dr=e=>(t,n,s,o)=>x4(t,n,s.selector).bind(t=>e(t.candidates,t.index,o.getNumRows().getOr(s.initSize.numRows),o.getNumColumns().getOr(s.initSize.numColumns))),T4=(t,n,s)=>s.captureTab?e.some(!0):e.none(),z4=Dr((e,t,n,s)=>k4(e,t,n,s,-1)),D4=Dr((e,t,n,s)=>k4(e,t,n,s,1)),YC=Dr((e,t,n,s)=>A4(e,t,n,s,-1)),qC=Dr((e,t,n,s)=>A4(e,t,n,s,1)),KC=n([S(E(Jr),g4(z4,D4)),S(E(Yr),v4(z4,D4)),S(E(Ii),V4(YC)),S(E(ei),I4(qC)),S(dn([Zo,E(ws)]),T4),S(dn([Ui,E(ws)]),T4),S(E(at.concat(En)),(e,t,n)=>((e,t)=>t.focusManager.get(e).bind(e=>hn(e,t.selector)))(e,n).bind(s=>n.execute(e,t,s)))]),UC=n([S(E(ec),(e,t,n)=>n.onEscape(e,t)),S(E(at),qo)]);H4=co(QC,Q0,KC,UC,()=>e.some(GC));const zr=(t,n,s,o)=>{const i=(t,n,s)=>{const a=Xo(n,o,0,s.length-1);return a===t?e.none():(r=s[a],"button"===qn(r)&&"disabled"===Ne(r,"disabled")?i(t,a,s):e.from(s[a]));var r};return x4(t,s,n).bind(e=>{const t=e.index,n=e.candidates;return i(t,t,n)})},$C=[s("selector"),t("getInitial",e.none),t("execute",qi),ot("onEscape"),t("executeOnMove",!1),t("allowVertical",!0)],y4=(e,t,n)=>((e,t)=>t.focusManager.get(e).bind(e=>hn(e,t.selector)))(e,n).bind(s=>n.execute(e,t,s)),VC=(e,t)=>{t.getInitial(e).orThunk(()=>pe(e.element,t.selector)).each(n=>{t.focusManager.set(e,n)})},W4=(e,t,n)=>zr(e,n.selector,t,-1),U4=(e,t,n)=>zr(e,n.selector,t,1),K4=t=>(n,s,o,i)=>t(n,s,o,i).bind(()=>o.executeOnMove?y4(n,s,o):e.some(!0)),BC=n([S(E(at),qo),S(E(ec),(e,t,n)=>n.onEscape(e,t))]);Y4=co($C,en.init,(e,t,n)=>{const o=Jr.concat(n.allowVertical?Ii:[]),i=Yr.concat(n.allowVertical?ei:[]);return[S(E(o),K4(g4(W4,U4))),S(E(i),K4(v4(W4,U4))),S(E(En),y4),S(E(at),y4)]},BC,()=>e.some(VC));const Tr=(t,n,s)=>e.from(t[n]).bind(t=>e.from(t[s]).map(e=>({rowIndex:n,columnIndex:s,cell:e}))),X4=(e,t,n,s)=>{const o=e[t].length,i=Xo(n,s,0,o-1);return Tr(e,t,i)},Q4=(e,t,n,s)=>{const o=Xo(n,s,0,e.length-1),i=e[o].length,a=zt(t,0,i-1);return Tr(e,o,a)},Z4=(e,t,n,s)=>{const o=e[t].length,i=zt(n+s,0,o-1);return Tr(e,t,i)},J4=(e,t,n,s)=>{const o=zt(n+s,0,e.length-1),i=e[o].length,a=zt(t,0,i-1);return Tr(e,o,a)},IC=[Os("selectors",[s("row"),s("cell")]),t("cycles",!0),t("previousSelector",e.none),t("execute",qi)],HC=(e,t)=>{t.previousSelector(e).orThunk(()=>{const n=t.selectors;return pe(e.element,n.cell)}).each(n=>{t.focusManager.set(e,n)})},Sr=(e,t)=>(n,s,o)=>{const i=o.cycles?e:t;return hn(s,o.selectors.row).bind(e=>{const t=$e(e,o.selectors.cell);return C4(t,s).bind(t=>{const s=$e(n,o.selectors.row);return C4(s,e).bind(e=>{const n=((e,t)=>a(e,e=>$e(e,t.selectors.cell)))(s,o);return i(n,e,t).map(e=>e.cell)})})})},s0=Sr((e,t,n)=>X4(e,t,n,-1),(e,t,n)=>Z4(e,t,n,-1)),o0=Sr((e,t,n)=>X4(e,t,n,1),(e,t,n)=>Z4(e,t,n,1)),PC=Sr((e,t,n)=>Q4(e,n,t,-1),(e,t,n)=>J4(e,n,t,-1)),RC=Sr((e,t,n)=>Q4(e,n,t,1),(e,t,n)=>J4(e,n,t,1)),LC=n([S(E(Jr),g4(s0,o0)),S(E(Yr),v4(s0,o0)),S(E(Ii),V4(PC)),S(E(ei),I4(RC)),S(E(at.concat(En)),(e,t,n)=>Jt(e.element).bind(s=>n.execute(e,t,s)))]),NC=n([S(E(at),qo)]);l0=co(IC,en.init,LC,NC,()=>e.some(HC));const DC=[s("selector"),t("execute",qi),t("moveOnTab",!1)],u0=(e,t,n)=>n.focusManager.get(e).bind(s=>n.execute(e,t,s)),zC=(e,t)=>{pe(e.element,t.selector).each(n=>{t.focusManager.set(e,n)})},m0=(e,t,n)=>zr(e,n.selector,t,-1),f0=(e,t,n)=>zr(e,n.selector,t,1),FC=n([S(E(Ii),Nr(m0)),S(E(ei),Nr(f0)),S(dn([Zo,E(ws)]),(t,n,s,o)=>s.moveOnTab?Nr(m0)(t,n,s,o):e.none()),S(dn([Ui,E(ws)]),(t,n,s,o)=>s.moveOnTab?Nr(f0)(t,n,s,o):e.none()),S(E(En),u0),S(E(at),u0)]),MC=n([S(E(at),qo)]);v0=co(DC,en.init,FC,MC,()=>e.some(zC));const SC=[ot("onSpace"),ot("onEnter"),ot("onShiftEnter"),ot("onLeft"),ot("onRight"),ot("onTab"),ot("onShiftTab"),ot("onUp"),ot("onDown"),ot("onEscape"),t("stopSpaceKeyup",!1),D("focusIn")];j0=co(SC,en.init,(e,t,n)=>[S(E(at),n.onSpace),S(dn([Ui,E(En)]),n.onEnter),S(dn([Zo,E(En)]),n.onShiftEnter),S(dn([Zo,E(ws)]),n.onShiftTab),S(dn([Ui,E(ws)]),n.onTab),S(E(Ii),n.onUp),S(E(ei),n.onDown),S(E(Jr),n.onLeft),S(E(Yr),n.onRight),S(E(at),n.onSpace)],(e,t,n)=>[...n.stopSpaceKeyup?[S(E(at),qo)]:[],S(E(ec),n.onEscape)],e=>e.focusIn);const AC=H2.schema(),kC=L2.schema(),EC=Y4.schema(),hC=H4.schema(),uC=l0.schema(),dC=u2.schema(),lC=v0.schema(),cC=j0.schema(),u=kp({branchKey:"mode",branches:Object.freeze({__proto__:null,acyclic:AC,cyclic:kC,flow:EC,flatgrid:hC,matrix:uC,execution:dC,menu:lC,special:cC}),name:"keying",active:{events:(e,t)=>e.handler.toEvents(e,t)},apis:{focusIn:(e,t,n)=>{t.sendFocusIn(t).fold(()=>{e.getSystem().triggerFocus(e.element,e.element)},s=>{s(e,t,n)})},setGridSize:(e,t,n,s,o)=>{(e=>Gt(e,"setGridSize"))(n)?n.setGridSize(s,o):console.error("Layout does not support setGridSize")}},state:R0}),S0=(e,t)=>{Hd(()=>{((e,t,n)=>{const o=e.components();(e=>{h(e.components(),e=>Ln(e.element)),gl(e.element),e.syncComponents()})(e);const s=n(t),i=Hs(o,s);h(i,t=>{yi(t),e.getSystem().removeFromWorld(t)}),h(s,t=>{md(t)?c5(e,t):(e.getSystem().addToWorld(t),c5(e,t),Xt(e.element)&&wi(t))}),e.syncComponents()})(e,t,()=>a(t,e.getSystem().build))},e.element)},M0=(e,t)=>{Hd(()=>{((n,s)=>{const i=n.components(),r=le(s,e=>e8(e).toArray());h(i,e=>{_e(r,e)||vd(e)});const a=((e,t,n)=>zh(e,t,(t,s)=>Th(e,s,t,n)))(e.element,t,e.getSystem().buildOrPatch),c=Hs(i,a);h(c,e=>{md(e)&&vd(e)}),h(a,e=>{md(e)||Qg(n,e)}),n.syncComponents()})(e,t)},e.element)},oC=(e,t,n,s)=>{vd(t);const o=Th(e.element,n,s,e.getSystem().buildOrPatch);Qg(e,o),e.syncComponents()},p4=(e,t,n)=>{const s=e.getSystem().build(n);p7(e,s,t)},sC=(e,t,n,s)=>{Un(t),p4(e,(e,t)=>((e,t,n)=>{Us(e,n).fold(()=>{Ht(e,t)},e=>{ki(e,t)})})(e,t,n),s)},Ar=(e)=>e.components(),N0=(t,n,s,o,i)=>{const a=Ar(t);return e.from(a[o]).map(e=>(i.fold(()=>Un(e),s=>{(n.reuseDom?oC:sC)(t,e,o,s)}),e))};L0=Object.freeze({__proto__:null,append:(e,t,n,s)=>{p4(e,Ht,s)},prepend:(e,t,n,s)=>{p4(e,mx,s)},remove:(e,t,n,s)=>{const o=Ar(e),i=ne(o,e=>G(s.element,e.element));i.each(Un)},replaceAt:N0,replaceBy:(e,t,n,s,o)=>{const i=Ar(e);return zo(i,s).bind(n=>N0(e,t,0,n,o))},set:(e,t,n,s)=>(t.reuseDom?M0:S0)(e,s),contents:Ar});const j=we({fields:[ht("reuseDom",!0)],name:"replacing",apis:L0}),w=(e,t)=>{const o=((e,t)=>{const o=$(t);return we({fields:[s("enabled")],name:e,active:{events:n(o)}})})(e,t);return{key:e,value:{config:{},me:o,configAsRaw:n({}),initialConfig:{},state:en}}},H0=(e,t)=>{t.ignore||(Xn(e.element),t.onFocus(e))};var nC=Object.freeze({__proto__:null,focus:H0,blur:(e,t)=>{t.ignore||(e=>{e.dom.blur()})(e.element)},isFocused:e=>jg(e.element)}),Jx=Object.freeze({__proto__:null,exhibit:(e,t)=>{const n=t.ignore?{}:{attributes:{tabindex:"-1"}};return Zt(n)},events:e=>$([o(rs(),(t,n)=>{H0(t,e),n.stop()})].concat(e.stopMousedown?[o(It(),(e,t)=>{t.event.prevent()})]:[]))}),Xx=[C("onFocus"),t("stopMousedown",!1),t("ignore",!1)];const b=we({fields:Xx,name:"focusing",active:Jx,apis:nC}),Qi=(e,t,n,s)=>{const o=n.get();n.set(s),((e,t,n)=>{t.toggleClass.each(t=>{n.get()?me(e.element,t):ie(e.element,t)})})(e,t,n),((e,t,n)=>{const s=t.aria;s.update(e,s,n.get())})(e,t,n),o!==s&&t.onToggled(e,s)},U0=(e,t,n)=>{Qi(e,t,n,!n.get())},K0=(e,t,n)=>{Qi(e,t,n,t.selected)};q0=Object.freeze({__proto__:null,onLoad:K0,toggle:U0,isOn:(e,t,n)=>n.get(),on:(e,t,n)=>{Qi(e,t,n,!0)},off:(e,t,n)=>{Qi(e,t,n,!1)},set:Qi}),Y0=Object.freeze({__proto__:null,exhibit:()=>Zt({}),events:(e,t)=>{const i=(n=e,s=t,o=U0,Vn(e=>{o(e,n,s)}));var n,s,o;const a=Tu(e,t,K0);return $(Se([e.toggleOnExecute?[i]:[],[a]]))}});const G0=(e,t,n)=>{_(e.element,"aria-expanded",n)};X0=[t("selected",!1),D("toggleClass"),t("toggleOnExecute",!0),C("onToggled"),Mt("aria",{mode:"none"},lt("mode",{pressed:[t("syncWithExpanded",!1),W("update",(e,t,n)=>{_(e.element,"aria-pressed",n),t.syncWithExpanded&&G0(e,0,n)})],checked:[W("update",(e,t,n)=>{_(e.element,"aria-checked",n)})],expanded:[W("update",G0)],selected:[W("update",(e,t,n)=>{_(e.element,"aria-selected",n)})],none:[W("update",c)]}))];const A=we({fields:X0,name:"toggling",active:Y0,apis:q0,state:(!1,{init:()=>{const e=v(!1);return{get:()=>e.get(),set:t=>e.set(t),clear:()=>e.set(!1),readState:()=>e.get()}}})}),Z0=()=>{const e=(e,t)=>{t.stop(),Js(e)};return[o(Hi(),e),o(xi(),e),ro(Nn()),ro(It())]},wr=e=>$(Se([e.map(e=>Vn((t,n)=>{e(t),n.stop()})).toArray(),Z0()])),e2="alloy.item-hover",t2="alloy.item-focus",n2="alloy.item-toggled",s2=e=>{(Jt(e.element).isNone()||b.isFocused(e))&&(b.isFocused(e)||b.focus(e),p(e,e2,{item:e}))},o2=e=>{p(e,t2,{item:e})},i2=n(e2),Bx=n(t2),Hx=n(n2),Px=e=>e.toggling.map(e=>e.exclusive?"menuitemradio":"menuitemcheckbox").getOr("menuitem"),Lx=[s("data"),s("components"),s("dom"),t("hasSubmenu",!1),D("toggling"),si("itemBehaviours",[A,b,u,r]),t("ignoreFocus",!1),t("domModification",{}),W("builder",e=>({dom:e.dom,domModification:{...e.domModification,attributes:{role:Px(e),...e.domModification.attributes,"aria-haspopup":e.hasSubmenu,...e.hasSubmenu?{"aria-expanded":!1}:{}}},behaviours:ni(e.itemBehaviours,[e.toggling.fold(A.revoke,e=>A.config((e=>({aria:{mode:"checked"},...t3(e,(e,t)=>"exclusive"!==t),onToggled:(t,n)=>{At(e.onToggled)&&e.onToggled(t,n),((e,t)=>{p(e,n2,{item:e,state:t})})(t,n)}}))(e))),b.config({ignore:e.ignoreFocus,stopMousedown:e.ignoreFocus,onFocus:e=>{o2(e)}}),u.config({mode:"execution"}),r.config({store:{mode:"memory",initialValue:e.data}}),w("item-type-events",[...Z0(),o(As(),s2),o(Ei(),b.focus)])]),components:e.components,eventOrder:e.eventOrder})),t("eventOrder",{})],Nx=[s("dom"),s("components"),W("builder",e=>({dom:e.dom,components:e.components,events:$([vj(Ei())])}))],h4=n("item-widget"),u4=n([Fe({name:"widget",overrides:e=>({behaviours:i([r.config({store:{mode:"manual",getValue:t=>e.data,setValue:c}})])})})]),Fx=[s("uid"),s("data"),s("components"),s("dom"),t("autofocus",!1),t("ignoreFocus",!1),si("widgetBehaviours",[r,b,u]),t("domModification",{}),Zu(u4()),W("builder",t=>{const i=$u(h4(),t,u4()),a=Wu(h4(),t,i.internals()),n=e=>P(e,t,"widget").map(e=>(u.focusIn(e),e)),s=(n,s)=>ti(s.event.target)?e.none():t.autofocus?(s.setSource(n.element),e.none()):e.none();return{dom:t.dom,components:a,domModification:t.domModification,events:$([Vn((e,t)=>{n(e).each(e=>{t.stop()})}),o(As(),s2),o(Ei(),(e)=>{t.autofocus?n(e):b.focus(e)})]),behaviours:ni(t.widgetBehaviours,[r.config({store:{mode:"memory",initialValue:t.data}}),b.config({ignore:t.ignoreFocus,onFocus:e=>{o2(e)}}),u.config({mode:"special",focusIn:t.autofocus?e=>{n(e)}:R9(),onLeft:s,onRight:s,onEscape:(n,s)=>b.isFocused(n)||t.autofocus?t.autofocus?(s.setSource(n.element),e.none()):e.none():(b.focus(n),e.some(!0))})])}})],Sx=lt("type",{widget:Fx,item:Lx,separator:Nx}),Ox=n([dc({factory:{sketch:e=>{const t=Ge("menu.spec item",Sx,e);return t.builder(t)}},name:"items",unit:"item",defaults:(e,t)=>R(t,"uid")?t:{...t,uid:Co("item")},overrides:(e,t)=>({type:t.type,ignoreFocus:e.fakeFocus,domModification:{classes:[e.markers.item]}})})]),wx=n([s("value"),s("items"),s("dom"),s("components"),t("eventOrder",{}),fe("menuBehaviours",[F,r,O,u]),Mt("movement",{mode:"menu",moveOnTab:!0},lt("mode",{grid:[D0(),W("config",(e,t)=>({mode:"flatgrid",selector:"."+e.markers.item,initSize:{numColumns:t.initSize.numColumns,numRows:t.initSize.numRows},focusManager:e.focusManager}))],matrix:[W("config",(e,t)=>({mode:"matrix",selectors:{row:t.rowSelector,cell:"."+e.markers.item},previousSelector:t.previousSelector,focusManager:e.focusManager})),s("rowSelector"),t("previousSelector",e.none)],menu:[t("moveOnTab",!0),W("config",(e,t)=>({mode:"menu",selector:"."+e.markers.item,moveOnTab:t.moveOnTab,focusManager:e.focusManager}))]})),vt("markers",fx()),t("fakeFocus",!1),t("focusManager",t4()),C("onHighlight"),C("onDehighlight")]),v2=n("alloy.menu-focus"),Bs=Be({name:"Menu",configFields:wx(),partFields:Ox(),factory:(t,n)=>({uid:t.uid,dom:t.dom,markers:t.markers,behaviours:ye(t.menuBehaviours,[F.config({highlightClass:t.markers.selectedItem,itemClass:t.markers.item,onHighlight:t.onHighlight,onDehighlight:t.onDehighlight}),r.config({store:{mode:"memory",initialValue:t.value}}),O.config({find:e.some}),u.config(t.movement.config(t,t.movement))]),events:$([o(Bx(),(e,t)=>{const n=t.event;e.getSystem().getByDom(n.target).each(n=>{F.highlight(e,n),t.stop(),p(e,v2(),{menu:e,item:n})})}),o(i2(),(e,t)=>{const n=t.event.item;F.highlight(e,n)}),o(Hx(),(e,t)=>{const{item:n,state:s}=t.event;s&&"menuitemradio"===Ne(n.element,"role")&&((e,t)=>{const n=$e(e.element,'[role="menuitemradio"][aria-checked="true"]');h(n,n=>{G(n,t.element)||e.getSystem().getByDom(n).each(e=>{A.off(e)})})})(e,n)})]),components:n,eventOrder:t.eventOrder,domModification:{attributes:{role:"menu"}}})}),j2=(t,n,s,o)=>f(s,o).bind(o=>f(t,o).bind(o=>{const i=j2(t,n,s,o);return e.some([o].concat(i))})).getOr([]),y2=t=>"prepared"===t.type?e.some(t.menu):e.none(),yx=()=>{const s=v({}),t=v({}),n=v({}),o=q(),a=v({}),i=e=>r(e).bind(y2),r=e=>f(t.get(),e),c=e=>f(s.get(),e);return{setMenuBuilt:(e,n)=>{t.set({...t.get(),[e]:{type:"prepared",menu:n}})},setContents:(e,i,r,c)=>{o.set(e),s.set(r),t.set(i),a.set(c);const l=((e,t)=>{const n={};Re(e,(e,t)=>{h(e,e=>{n[e]=t})});const o=t,s=P0(t,(e,t)=>({k:e,v:t})),i=je(s,(e,t)=>[t].concat(j2(n,o,s,t)));return je(n,e=>f(i,e).getOr([e]))})(c,r);n.set(l)},expand:e=>f(s.get(),e).map(t=>{const s=f(n.get(),e).getOr([]);return[t].concat(s)}),refresh:e=>f(n.get(),e),collapse:t=>f(n.get(),t).bind(t=>t.length>1?e.some(t.slice(1)):e.none()),lookupMenu:r,lookupItem:c,otherMenus:e=>{const t=a.get();return Hs(ce(t),e)},getPrimary:()=>o.get().bind(i),getMenus:()=>t.get(),clear:()=>{s.set({}),t.set({}),n.set({}),o.clear()},isClear:()=>o.get().isNone(),getTriggeringPath:(t,a)=>{const r=K(c(t).toArray(),e=>i(e).isSome());return f(n.get(),t).bind(t=>{const n=xa(r.concat(t));return(t=>{const n=[];for(let s=0;s<t.length;s++){const o=t[s];if(!o.isSome())return e.none();n.push(o.getOrDie())}return e.some(n)})(le(n,(t,r)=>((e,t,n)=>i(e).bind(o=>(e=>Y1(s.get(),(t)=>t===e))(e).bind(e=>t(e).map(e=>({triggeredMenu:o,triggeringItem:e,triggeringPath:n})))))(t,a,n.slice(0,r+1)).fold(()=>sn(o.get(),t)?[]:[e.none()],t=>[e.some(t)])))})}}},jx=y2,O2=d("tiered-menu-item-highlight"),x2=d("tiered-menu-item-dehighlight");!function(e){e[e.HighlightMenuAndItem=0]="HighlightMenuAndItem",e[e.HighlightJustMenu=1]="HighlightJustMenu",e[e.HighlightNone=2]="HighlightNone"}(Ue||(Ue={}));const px=n("collapse-item"),Ls=pt({name:"TieredMenu",configFields:[m4("onExecute"),m4("onEscape"),Xs("onOpenMenu"),Xs("onOpenSubmenu"),C("onRepositionMenu"),C("onCollapseMenu"),t("highlightOnOpen",Ue.HighlightMenuAndItem),Os("data",[s("primary"),s("menus"),s("expansions")]),t("fakeFocus",!1),C("onHighlightItem"),C("onDehighlightItem"),C("onHover"),jr(),s("dom"),t("navigateOnHover",!0),t("stayInDom",!1),fe("tmenuBehaviours",[u,F,O,j]),t("eventOrder",{})],apis:{collapseMenu:(e,t)=>{e.collapseMenu(t)},highlightPrimary:(e,t)=>{e.highlightPrimary(t)},repositionMenus:(e,t)=>{e.repositionMenus(t)}},factory:(t)=>{const C=q(),s=yx(),i=e=>r.getValue(e).value,A=e=>je(t.data.menus,(e)=>le(e.items,e=>"separator"===e.type?[]:[e.data.value])),E=F.highlight,f=(e,n)=>{E(e,n),F.getHighlighted(n).orThunk(()=>F.getFirst(n)).each(s=>{t.fakeFocus?F.highlight(n,s):ku(e,s.element,Ei())})},w=(t,n)=>so(a(n,n=>t.lookupMenu(n).bind(t=>"prepared"===t.type?e.some(t.menu):e.none()))),x=(e,n,s)=>{const o=w(n,n.otherMenus(s));h(o,n=>{mn(n.element,[t.markers.backgroundMenu]),t.stayInDom||j.remove(e,n)})},m=(e,n)=>{const s=(e=>C.get().getOrThunk(()=>{const n={},s=$e(e.element,`.${t.markers.item}`),o=K(s,e=>"true"===Ne(e,"aria-haspopup"));return h(o,t=>{e.getSystem().getByDom(t).each(e=>{const t=i(e);n[t]=e})}),C.set(n),n}))(e);Re(s,(e,t)=>{const s=_e(n,t);_(e.element,"aria-expanded",s)})},v=(n,s,o)=>e.from(o[0]).bind(i=>s.lookupMenu(i).bind(i=>{if("notbuilt"===i.type)return e.none();{const a=i.menu,r=w(s,o.slice(1));return h(r,e=>{me(e.element,t.markers.backgroundMenu)}),Xt(a.element)||j.append(n,Pt(a)),mn(a.element,[t.markers.backgroundMenu]),f(n,a),x(n,s,o),e.some(a)}}));let l;!function(e){e[e.HighlightSubmenu=0]="HighlightSubmenu",e[e.HighlightParent=1]="HighlightParent"}(l||(l={}));const b=(n,o,a=l.HighlightSubmenu)=>{if(o.hasConfigured(g)&&g.isDisabled(o))return e.some(o);{const r=i(o);return s.expand(r).bind(i=>(m(n,i),e.from(i[0]).bind(r=>s.lookupMenu(r).bind(c=>{const d=((e,t,n)=>{if("notbuilt"===n.type){const o=e.getSystem().build(n.nbMenu());return s.setMenuBuilt(t,o),o}return n.menu})(n,r,c);return Xt(d.element)||j.append(n,Pt(d)),t.onOpenSubmenu(n,o,d,xa(i)),a===l.HighlightSubmenu?(F.highlightFirst(d),v(n,s,i)):(F.dehighlightAll(d),e.some(o))}))))}},d=(e,n)=>{const o=i(n);return s.collapse(o).bind(o=>(m(e,o),v(e,s,o).map(s=>(t.onCollapseMenu(e,n,s),s))))},y=e=>(n,s)=>hn(s.getSource(),`.${t.markers.item}`).bind(t=>n.getSystem().getByDom(t).toOptional().bind(t=>e(n,t).map(Oe))),S=$([o(v2(),(e,t)=>{const n=t.event.item;s.lookupItem(i(n)).each(()=>{const n=t.event.menu;F.highlight(e,n);const o=i(t.event.item);s.refresh(o).each(t=>x(e,s,t))})}),Vn((e,n)=>{const s=n.event.target;e.getSystem().getByDom(s).each(n=>{0===i(n).indexOf("collapse-item")&&d(e,n),b(e,n,l.HighlightSubmenu).fold(()=>{t.onExecute(e,n)},c)})}),Q((e)=>{(e=>{const n=((e,n,s)=>je(s,(s,o)=>{const i=()=>Bs.sketch({...s,value:o,markers:t.markers,fakeFocus:t.fakeFocus,onHighlight:(e,t)=>{p(e,O2,{menuComp:e,itemComp:t})},onDehighlight:(e,t)=>{p(e,x2,{menuComp:e,itemComp:t})},focusManager:t.fakeFocus?PO():t4()});return o===n?{type:"prepared",menu:e.getSystem().build(i())}:{type:"notbuilt",nbMenu:i}}))(e,t.data.primary,t.data.menus),o=A();return s.setContents(t.data.primary,n,t.data.expansions,o),s.getPrimary()})(e).each(n=>{j.append(e,Pt(n)),t.onOpenMenu(e,n),t.highlightOnOpen===Ue.HighlightMenuAndItem?f(e,n):t.highlightOnOpen===Ue.HighlightJustMenu&&E(e,n)})}),o(O2,(e,n)=>{t.onHighlightItem(e,n.event.menuComp,n.event.itemComp)}),o(x2,(e,n)=>{t.onDehighlightItem(e,n.event.menuComp,n.event.itemComp)}),...t.navigateOnHover?[o(i2(),(e,n)=>{const o=n.event.item;((e,t)=>{const n=i(t);s.refresh(n).bind(t=>(m(e,t),v(e,s,t)))})(e,o),b(e,o,l.HighlightParent),t.onHover(e,o)})]:[]]),k=e=>F.getHighlighted(e).bind(F.getHighlighted),M={collapseMenu:e=>{k(e).each(t=>{d(e,t)})},highlightPrimary:e=>{s.getPrimary().each(t=>{f(e,t)})},repositionMenus:n=>{const o=s.getPrimary().bind(t=>k(n).bind(t=>{const n=i(t),o=H1(s.getMenus()),r=so(a(o,jx));return s.getTriggeringPath(n,t=>((t,n,s)=>wn(n,t=>{if(!t.getSystem().isConnected())return e.none();const n=F.getCandidates(t);return ne(n,e=>i(e)===s)}))(0,r,t))}).map(e=>({primary:t,triggeringPath:e})));o.fold(()=>{(t=>e.from(t.components()[0]).filter(e=>"menu"===Ne(e.element,"role")))(n).each(e=>{t.onRepositionMenu(n,e,[])})},({primary:e,triggeringPath:s})=>{t.onRepositionMenu(n,e,s)})}};return{uid:t.uid,dom:t.dom,markers:t.markers,behaviours:ye(t.tmenuBehaviours,[u.config({mode:"special",onRight:y((t,n)=>ti(n.element)?e.none():b(t,n,l.HighlightSubmenu)),onLeft:y((t,n)=>ti(n.element)?e.none():d(t,n)),onEscape:y((e,n)=>d(e,n).orThunk(()=>t.onEscape(e,n).map(()=>e))),focusIn:(e)=>{s.getPrimary().each(t=>{ku(e,t.element,Ei())})}}),F.config({highlightClass:t.markers.selectedMenu,itemClass:t.markers.menu}),O.config({find:e=>F.getHighlighted(e)}),j.config({})]),eventOrder:t.eventOrder,apis:M,events:S}},extraApis:{tieredData:(e,t,n)=>({primary:e,menus:t,expansions:n}),singleData:(e,t)=>({primary:e,menus:jo(e,t),expansions:{}}),collapseItem:e=>({value:d(px()),meta:{text:e}})}}),J=pt({name:"InlineView",configFields:[s("lazySink"),C("onShow"),C("onHide"),Ia("onEscape"),fe("inlineBehaviours",[k,r,Vt]),bt("fireDismissalEventInstead",[t("event",di())]),bt("fireRepositionEventInstead",[t("event",yp())]),t("getRelated",e.none),t("isExtraPart",U),t("eventOrder",e.none)],factory:(t,n)=>{const s=(e,t,n,s)=>{o(e,t,n,()=>s.map(e=>it(e)))},o=(n,s,o,i)=>{const a=t.lazySink(n).getOrDie();k.openWhileCloaked(n,s,()=>Ye.positionWithinBounds(a,n,o,i())),r.setValue(n,e.some({mode:"position",config:o,getBounds:i}))},i=(n,s,o,i)=>{const a=((t,n,s,o,i)=>{const a=()=>t.lazySink(n),c="horizontal"===o.type?{layouts:{onLtr:()=>r1(),onRtl:()=>i1()}}:{},r=e=>(e=>2===e.length)(e)?c:{};return Ls.sketch({dom:{tag:"div"},data:o.data,markers:o.menu.markers,highlightOnOpen:o.menu.highlightOnOpen,fakeFocus:o.menu.fakeFocus,onEscape:()=>(k.close(n),t.onEscape.map(e=>e(n)),e.some(!0)),onExecute:()=>e.some(!0),onOpenMenu:(e,t)=>{Ye.positionWithinBounds(a().getOrDie(),t,s,i())},onOpenSubmenu:(e,t,n,s)=>{const o=a().getOrDie();Ye.position(o,n,{anchor:{type:"submenu",item:t,...r(s)}})},onRepositionMenu:(e,t,n)=>{const o=a().getOrDie();Ye.positionWithinBounds(o,t,s,i()),h(n,e=>{const t=r(e.triggeringPath);Ye.position(o,e.triggeredMenu,{anchor:{type:"submenu",item:e.triggeringItem,...t}})})}})})(t,n,s,o,i);k.open(n,a),r.setValue(n,e.some({mode:"menu",menu:a}))},a=e=>{k.isOpen(e)&&r.getValue(e).each(n=>{switch(n.mode){case"menu":k.getState(e).each(Ls.repositionMenus);break;case"position":const s=t.lazySink(e).getOrDie();Ye.positionWithinBounds(s,e,n.config,n.getBounds())}})},c={setContent:(e,t)=>{k.setContent(e,t)},showAt:(t,n,o)=>{s(t,n,o,e.none())},showWithin:s,showWithinBounds:o,showMenuAt:(t,n,s)=>{i(t,n,s,e.none)},showMenuWithinBounds:i,hide:t=>{k.isOpen(t)&&(r.setValue(t,e.none()),k.close(t))},getContent:e=>k.getState(e),reposition:a,isOpen:k.isOpen};return{uid:t.uid,dom:t.dom,behaviours:ye(t.inlineBehaviours,[k.config({isPartOf:(e,n,s)=>Ps(n,s)||((e,n)=>t.getRelated(e).exists(e=>Ps(e,n)))(e,s),getAttachPoint:e=>t.lazySink(e).getOrDie(),onOpen:e=>{t.onShow(e)},onClose:e=>{t.onHide(e)}}),r.config({store:{mode:"memory",initialValue:e.none()}}),Vt.config({channels:{...Vd({isExtraPart:n.isExtraPart,...t.fireDismissalEventInstead.map(e=>({fireEventInstead:{event:e.event}})).getOr({})}),...Wd({...t.fireRepositionEventInstead.map(e=>({fireEventInstead:{event:e.event}})).getOr({}),doReposition:a})}})]),eventOrder:t.eventOrder,apis:c}},apis:{showAt:(e,t,n,s)=>{e.showAt(t,n,s)},showWithin:(e,t,n,s,o)=>{e.showWithin(t,n,s,o)},showWithinBounds:(e,t,n,s,o)=>{e.showWithinBounds(t,n,s,o)},showMenuAt:(e,t,n,s)=>{e.showMenuAt(t,n,s)},showMenuWithinBounds:(e,t,n,s,o)=>{e.showMenuWithinBounds(t,n,s,o)},hide:(e,t)=>{e.hide(t)},isOpen:(e,t)=>e.isOpen(t),getContent:(e,t)=>e.getContent(t),setContent:(e,t,n)=>{e.setContent(t,n)},reposition:(e,t)=>{e.reposition(t)}}});ia=tinymce.util.Tools.resolve("tinymce.util.Delay");const Je=pt({name:"Button",factory:e=>{const n=wr(e.action),s=e.dom.tag,t=t=>f(e.dom,"attributes").bind(e=>f(e,t));return{uid:e.uid,dom:e.dom,components:e.components,events:n,behaviours:ni(e.buttonBehaviours,[b.config({}),u.config({mode:"execution",useSpace:!0,useEnter:!0})]),domModification:{attributes:"button"===s?{type:t("type").getOr("button"),...t("role").map(e=>({role:e})).getOr({})}:{role:t("role").getOr("button")}},eventOrder:e.eventOrder}},configFields:[t("uid",void 0),s("dom"),t("components",[]),si("buttonBehaviours",[b,u]),D("action"),D("role"),t("eventOrder",{})]}),V=e=>{const t=(e=>void 0!==e.uid)(e)&&Gt(e,"uid")?e.uid:Co("memento");return{get:e=>e.getSystem().getByUid(t).getOrDie(),getOpt:e=>e.getSystem().getByUid(t).toOptional(),asSpec:()=>({...e,uid:t})}};xt=tinymce.util.Tools.resolve("tinymce.util.I18n");const ix={indent:!0,outdent:!0,"table-insert-column-after":!0,"table-insert-column-before":!0,"paste-column-after":!0,"paste-column-before":!0,"unordered-list":!0,"list-bull-circle":!0,"list-bull-default":!0,"list-bull-square":!0},D2="temporary-placeholder",c4=e=>()=>f(e,D2).getOr("!not found!"),r4=(e,t)=>{const n=e.toLowerCase();if(xt.isRtl()){const e=((e,t)=>cc(e,t)?e:((e)=>e+"-rtl")(e))(n,"-rtl");return R(t,e)?e:n}return n},R2=(e,t)=>f(t,r4(e,t)),P2=(e,t)=>{const n=t();return R2(e,n).getOrThunk(c4(n))},a4=()=>w("add-focusable",[Q(e=>{NO(e.element,"svg").each(e=>_(e,"focusable","false"))})]),I2=(e,t,n,s)=>{var o,a;const r=(e=>!!xt.isRtl()&&R(ix,e))(t)?["tox-icon--flip"]:[],c=f(n,r4(t,n)).or(s).getOrThunk(c4(n));return{dom:{tag:e.tag,attributes:null!==(o=e.attributes)&&void 0!==o?o:{},classes:e.classes.concat(r),innerHtml:c},behaviours:i([...null!==(a=e.behaviours)&&void 0!==a?a:[],a4()])}},gn=(t,n,s,o=e.none())=>I2(n,t,s(),o),ZO={success:"checkmark",error:"warning",err:"error",warning:"warning",warn:"warning",info:"info"},i4=pt({name:"Notification",factory:t=>{const n=V({dom:{tag:"p",innerHtml:t.translationProvider(t.text)},behaviours:i([j.config({})])}),s=e=>({dom:{tag:"div",classes:["tox-bar"],styles:{width:`${e}%`}}}),a=e=>({dom:{tag:"div",classes:["tox-text"],innerHtml:`${e}%`}}),r=V({dom:{tag:"div",classes:t.progress?["tox-progress-bar","tox-progress-indicator"]:["tox-progress-bar"]},components:[{dom:{tag:"div",classes:["tox-bar-container"]},components:[s(0)]},a(0)],behaviours:i([j.config({})])}),l={updateProgress:(e,t)=>{e.getSystem().isConnected()&&r.getOpt(e).each(e=>{j.set(e,[{dom:{tag:"div",classes:["tox-bar-container"]},components:[s(t)]},a(t)])})},updateText:(e,t)=>{if(e.getSystem().isConnected()){const s=n.get(e);j.set(s,[be(t)])}}},d=Se([t.icon.toArray(),t.level.toArray(),t.level.bind(t=>e.from(ZO[t])).toArray()]),c=V(Je.sketch({dom:{tag:"button",classes:["tox-notification__dismiss","tox-button","tox-button--naked","tox-button--icon"]},components:[gn("close",{tag:"div",classes:["tox-icon"],attributes:{"aria-label":t.translationProvider("Close")}},t.iconProvider)],action:e=>{t.onAction(e)}})),u=((t,n,s)=>{const o=s(),i=ne(t,e=>R(o,r4(e,o)));return I2({tag:"div",classes:["tox-notification__icon"]},i.getOr(D2),o,e.none())})(d,0,t.iconProvider),h=[u,{dom:{tag:"div",classes:["tox-notification__body"]},components:[n.asSpec()],behaviours:i([j.config({})])}];return{uid:t.uid,dom:{tag:"div",attributes:{role:"alert"},classes:t.level.map(e=>["tox-notification","tox-notification--in",`tox-notification--${e}`]).getOr(["tox-notification","tox-notification--in"])},behaviours:i([b.config({}),w("notification-events",[o(Ms(),e=>{c.getOpt(e).each(b.focus)})])]),components:h.concat(t.progress?[r.asSpec()]:[]).concat(t.closeButton?[c.asSpec()]:[]),apis:l}},configFields:[D("level"),s("progress"),D("icon"),s("onAction"),s("text"),s("iconProvider"),s("translationProvider"),ht("closeButton",!0)],apis:{updateProgress:(e,t,n)=>{e.updateProgress(t,n)},updateText:(e,t,n)=>{e.updateText(t,n)}}});var kt,la,ua=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),qO=tinymce.util.Tools.resolve("tinymce.EditorManager"),Wo=tinymce.util.Tools.resolve("tinymce.Env");!function(e){e.default="wrap",e.floating="floating",e.sliding="sliding",e.scrolling="scrolling"}(kt||(kt={})),function(e){e.auto="auto",e.top="top",e.bottom="bottom"}(la||(la={}));const B=e=>t=>t.options.get(e),pa=t=>n=>e.from(t(n)),Q2=e=>{const n=Wo.deviceType.isPhone(),i=Wo.deviceType.isTablet()||n,t=e.options.register,s=e=>L(e)||!1===e,o=e=>L(e)||Ss(e);t("skin",{processor:e=>L(e)||!1===e,default:"oxide"}),t("skin_url",{processor:"string"}),t("height",{processor:o,default:Math.max(e.getElement().offsetHeight,400)}),t("width",{processor:o,default:ua.DOM.getStyle(e.getElement(),"width")}),t("min_height",{processor:"number",default:100}),t("min_width",{processor:"number"}),t("max_height",{processor:"number"}),t("max_width",{processor:"number"}),t("style_formats",{processor:"object[]"}),t("style_formats_merge",{processor:"boolean",default:!1}),t("style_formats_autohide",{processor:"boolean",default:!1}),t("line_height_formats",{processor:"string",default:"1 1.1 1.2 1.3 1.4 1.5 2"}),t("font_family_formats",{processor:"string",default:"Andale Mono=andale mono,monospace;Arial=arial,helvetica,sans-serif;Arial Black=arial black,sans-serif;Book Antiqua=book antiqua,palatino,serif;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier,monospace;Georgia=georgia,palatino,serif;Helvetica=helvetica,arial,sans-serif;Impact=impact,sans-serif;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco,monospace;Times New Roman=times new roman,times,serif;Trebuchet MS=trebuchet ms,geneva,sans-serif;Verdana=verdana,geneva,sans-serif;Webdings=webdings;Wingdings=wingdings,zapf dingbats"}),t("font_size_formats",{processor:"string",default:"8pt 10pt 12pt 14pt 18pt 24pt 36pt"}),t("block_formats",{processor:"string",default:"Paragraph=p;Heading 1=h1;Heading 2=h2;Heading 3=h3;Heading 4=h4;Heading 5=h5;Heading 6=h6;Preformatted=pre"}),t("content_langs",{processor:"object[]"}),t("removed_menuitems",{processor:"string",default:""}),t("menubar",{processor:e=>L(e)||Tn(e),default:!n}),t("menu",{processor:"object",default:{}}),t("toolbar",{processor:e=>Tn(e)||L(e)||bs(e)?{value:e,valid:!0}:{valid:!1,message:"Must be a boolean, string or array."},default:!0}),Du(9,e=>{t("toolbar"+(e+1),{processor:"string"})}),t("toolbar_mode",{processor:"string",default:i?"scrolling":"floating"}),t("toolbar_groups",{processor:"object",default:{}}),t("toolbar_location",{processor:"string",default:la.auto}),t("toolbar_persist",{processor:"boolean",default:!1}),t("toolbar_sticky",{processor:"boolean",default:e.inline}),t("toolbar_sticky_offset",{processor:"number",default:0}),t("fixed_toolbar_container",{processor:"string",default:""}),t("fixed_toolbar_container_target",{processor:"object"}),t("file_picker_callback",{processor:"function"}),t("file_picker_validator_handler",{processor:"function"}),t("file_picker_types",{processor:"string"}),t("typeahead_urls",{processor:"boolean",default:!0}),t("anchor_top",{processor:s,default:"#top"}),t("anchor_bottom",{processor:s,default:"#bottom"}),t("draggable_modal",{processor:"boolean",default:!1}),t("statusbar",{processor:"boolean",default:!0}),t("elementpath",{processor:"boolean",default:!0}),t("branding",{processor:"boolean",default:!0}),t("promotion",{processor:"boolean",default:!0}),t("resize",{processor:e=>"both"===e||Tn(e),default:!Wo.deviceType.isTouch()}),t("sidebar_show",{processor:"string"})},Z2=B("readonly"),n4=B("height"),e4=B("width"),J1=pa(B("min_width")),Z1=pa(B("min_height")),ir=pa(B("max_width")),X1=pa(B("max_height")),i3=pa(B("style_formats")),a3=B("style_formats_merge"),r3=B("style_formats_autohide"),c3=B("content_langs"),l3=B("removed_menuitems"),Vo=B("toolbar_mode"),u3=B("toolbar_groups"),q1=B("toolbar_location"),fO=B("fixed_toolbar_container"),Lw=B("fixed_toolbar_container_target"),p3=B("toolbar_persist"),g3=B("toolbar_sticky_offset"),v3=B("menubar"),La=B("toolbar"),j3=B("file_picker_callback"),y3=B("file_picker_validator_handler"),_3=B("file_picker_types"),w3=B("typeahead_urls"),O3=B("anchor_top"),x3=B("anchor_bottom"),C3=B("draggable_modal"),E3=B("statusbar"),k3=B("elementpath"),A3=B("branding"),S3=B("resize"),M3=B("paste_as_text"),F3=B("sidebar_show"),T3=B("promotion"),K1=e=>!1===e.options.get("skin"),tr=e=>!1!==e.options.get("menubar"),N3=e=>{const t=e.options.get("skin_url");if(K1(e))return t;if(t)return e.documentBaseURI.toAbsolute(t);{const t=e.options.get("skin");return qO.baseURL+"/skins/ui/"+t}},L3=e=>e.options.get("line_height_formats").split(" "),er=e=>{const t=La(e),n=L(t),s=bs(t)&&t.length>0;return!ya(e)&&(s||n||!0===t)},U1=e=>{const n=Du(9,t=>e.options.get("toolbar"+(t+1))),t=K(n,L);return Li(t.length>0,t)},ya=e=>U1(e).fold(()=>{const t=La(e);return ga(t,L)&&t.length>0},Oe),V1=e=>q1(e)===la.bottom,B3=t=>{var n;if(!t.inline)return e.none();const s=null!==(n=fO(t))&&void 0!==n?n:"";if(s.length>0)return pe(Hn(),s);const o=Lw(t);return Wt(o)?e.some(l(o)):e.none()},wa=e=>e.inline&&B3(e).isSome(),I1=e=>B3(e).getOrThunk(()=>Ka(Tt(l(e.getElement())))),N1=e=>e.inline&&!tr(e)&&!er(e)&&!ya(e),Oa=e=>(e.options.get("toolbar_sticky")||e.inline)&&!wa(e)&&!N1(e),K3=e=>{const t=e.options.get("menu");return je(t,e=>({...e,items:e.items}))};q3=Object.freeze({__proto__:null,get ToolbarMode(){return kt},get ToolbarLocation(){return la},register:Q2,getSkinUrl:N3,isReadOnly:Z2,isSkinDisabled:K1,getHeightOption:n4,getWidthOption:e4,getMinWidthOption:J1,getMinHeightOption:Z1,getMaxWidthOption:ir,getMaxHeightOption:X1,getUserStyleFormats:i3,shouldMergeStyleFormats:a3,shouldAutoHideStyleFormats:r3,getLineHeightFormats:L3,getContentLanguages:c3,getRemovedMenuItems:l3,isMenubarEnabled:tr,isMultipleToolbars:ya,isToolbarEnabled:er,isToolbarPersist:p3,getMultipleToolbarsOption:U1,getUiContainer:I1,useFixedContainer:wa,getToolbarMode:Vo,isDraggableModal:C3,isDistractionFree:N1,isStickyToolbar:Oa,getStickyToolbarOffset:g3,getToolbarLocation:q1,isToolbarLocationBottom:V1,getToolbarGroups:u3,getMenus:K3,getMenubar:v3,getToolbar:La,getFilePickerCallback:j3,getFilePickerTypes:_3,useTypeaheadUrls:w3,getAnchorTop:O3,getAnchorBottom:x3,getFilePickerValidatorHandler:y3,useStatusBar:E3,useElementPath:k3,promotionEnabled:T3,useBranding:A3,getResize:S3,getPasteAsText:M3,getSidebarShow:F3});const Y3="[data-mce-autocompleter]",G3=e=>hn(e,Y3);!function(e){e[e.CLOSE_ON_EXECUTE=0]="CLOSE_ON_EXECUTE",e[e.BUBBLE_TO_SANDBOX=1]="BUBBLE_TO_SANDBOX"}(D1||(D1={})),Ut=D1;const z1="tox-menu-nav__js",Ga="tox-collection__item",gw={normal:z1,color:"tox-swatch"},th="tox-collection__item--enabled",nh="tox-collection__item-icon",F1="tox-collection__item-label",oh="tox-collection__item-caret",Ca="tox-collection__item--active",ah="tox-collection__item-container",rh="tox-collection__item-container--row",ch=e=>f(gw,e).getOr(z1),fw=e=>"color"===e?"tox-swatches":"tox-menu",M1=e=>({backgroundMenu:"tox-background-menu",selectedMenu:"tox-selected-menu",selectedItem:"tox-collection__item--active",hasIcons:"tox-menu--has-icons",menu:fw(e),tieredMenu:"tox-tiered-menu"}),Ws=e=>{const t=M1(e);return{backgroundMenu:t.backgroundMenu,selectedMenu:t.selectedMenu,menu:t.menu,selectedItem:t.selectedItem,item:ch(e)}},uw=(e,t,n)=>{const s=M1(n);return{tag:"div",classes:Se([[s.menu,`tox-menu-${t}-column`],e?[s.hasIcons]:[]])}},dw=[Bs.parts.items({})],Ua=(e,t,n)=>{const s=M1(n);return{dom:{tag:"div",classes:Se([[s.tieredMenu]])},markers:Ws(n)}},ph=n([D("data"),t("inputAttributes",{}),t("inputStyles",{}),t("tag","input"),t("inputClasses",[]),C("onSetValue"),t("styles",{}),t("eventOrder",{}),fe("inputBehaviours",[r,b]),t("selectOnFocus",!0)]),gh=e=>i([b.config({onFocus:e.selectOnFocus?e=>{const t=e.element,n=Bn(t);t.dom.setSelectionRange(0,n.length)}:c})]),cw=e=>({...gh(e),...ye(e.inputBehaviours,[r.config({store:{mode:"manual",...e.data.map(e=>({initialValue:e})).getOr({}),getValue:e=>Bn(e.element),setValue:(e,t)=>{Bn(e.element)!==t&&Lo(e.element,t)}},onSetValue:e.onSetValue})])}),bh=e=>({tag:e.tag,attributes:{type:"text",...e.inputAttributes},styles:e.inputStyles,classes:e.inputClasses}),Io=pt({name:"Input",configFields:ph(),factory:(e)=>({uid:e.uid,dom:bh(e),components:[],behaviours:cw(e),eventOrder:e.eventOrder})}),yh=d("refetch-trigger-event"),_h=d("redirect-menu-item-interaction"),$a=e=>pe(e.element,".tox-menu__searcher").bind(t=>e.getSystem().getByDom(t).toOptional()),Oh=$a,xh=e=>({fetchPattern:r.getValue(e),selectionStart:e.element.dom.selectionStart,selectionEnd:e.element.dom.selectionEnd}),nw=t=>{const s=(t,n)=>(n.cut(),e.none()),n=(t,n)=>{const s={interactionEvent:n.event,eventType:n.event.raw.type};return p(t,_h,s),e.some(!0)},a="searcher-events";return{dom:{tag:"div",classes:[Ga]},components:[Io.sketch({inputClasses:["tox-menu__searcher","tox-textfield"],inputAttributes:{...t.placeholder.map(e=>({placeholder:t.i18n(e)})).getOr({}),type:"search","aria-autocomplete":"list"},inputBehaviours:i([w(a,[o(ao(),e=>{T(e,yh)}),o($i(),(e,t)=>{"Escape"===t.event.raw.key&&t.stop()})]),u.config({mode:"special",onLeft:s,onRight:s,onSpace:s,onEnter:n,onEscape:n,onUp:n,onDown:n})]),eventOrder:{keydown:[a,u.name()]}})]}},Va="tox-collection--results__js",kh=e=>{var t;return e.dom?{...e,dom:{...e.dom,attributes:{...null!==(t=e.dom.attributes)&&void 0!==t?t:{},id:d("aria-item-search-result-id"),"aria-selected":"false"}}}:e},S1=(e,t)=>n=>{const s=Pf(n,t);return a(s,t=>({dom:e,components:t}))},Sh=(e,t)=>{const s=[];let n=[];return h(e,(e,o)=>{t(e,o)?(n.length>0&&s.push(n),n=[],(R(e.dom,"innerHtml")||e.components&&e.components.length>0)&&n.push(e)):n.push(e)}),n.length>0&&s.push(n),a(s,e=>({dom:{tag:"div",classes:["tox-collection__group"]},components:e}))},A1=(e,t,n)=>Bs.parts.items({preprocess:s=>{const o=a(s,n);return"auto"!==e&&e>1?S1({tag:"div",classes:["tox-collection__group"]},e)(o):Sh(o,(e,n)=>"separator"===t[n].type)}}),Fh=(e,t)=>({dom:{tag:"div",classes:["tox-menu","tox-collection"].concat(1===e?["tox-collection--list"]:["tox-collection--grid"])},components:[A1(e,t,z)]}),Ba=e=>nn(e,e=>"icon"in e&&void 0!==e.icon),Fn=t=>(console.error(Bo(t)),console.log(t),e.none()),J_=(e,t,n)=>{const i=(a=n,{dom:{tag:"div",classes:["tox-collection","tox-collection--horizontal"]},components:[Bs.parts.items({preprocess:e=>Sh(e,(e,t)=>"separator"===a[t].type)})]});var a;return{value:e,dom:i.dom,components:i.components,items:n}},E1=(e,t,n,s,o)=>{if("color"===o.menuType){const t=(e=>({dom:{tag:"div",classes:["tox-menu","tox-swatches-menu"]},components:[{dom:{tag:"div",classes:["tox-swatches"]},components:[Bs.parts.items({preprocess:"auto"!==e?S1({tag:"div",classes:["tox-swatches__row"]},e):z})]}]}))(s);return{value:e,dom:t.dom,components:t.components,items:n}}if("normal"===o.menuType&&"auto"===s){const t=Fh(s,n);return{value:e,dom:t.dom,components:t.components,items:n}}if("normal"===o.menuType||"searchable"===o.menuType){const t="searchable"!==o.menuType?Fh(s,n):"search-with-field"===o.searchMode.searchMode?((e,t,n)=>{const s=d("aria-controls-search-results");return{dom:{tag:"div",classes:["tox-menu","tox-collection"].concat(1===e?["tox-collection--list"]:["tox-collection--grid"])},components:[nw({i18n:xt.translate,placeholder:n.placeholder}),{dom:{tag:"div",classes:[...1===e?["tox-collection--list"]:["tox-collection--grid"],Va],attributes:{id:s}},components:[A1(e,t,kh)]}]}})(s,n,o.searchMode):((e,t)=>{const s=d("aria-controls-search-results");return{dom:{tag:"div",classes:["tox-menu","tox-collection",Va].concat(1===e?["tox-collection--list"]:["tox-collection--grid"]),attributes:{id:s}},components:[A1(e,t,kh)]}})(s,n);return{value:e,dom:t.dom,components:t.components,items:n}}if("listpreview"===o.menuType&&"auto"!==s){const t=(e=>({dom:{tag:"div",classes:["tox-menu","tox-collection","tox-collection--toolbar","tox-collection--toolbar-lg"]},components:[Bs.parts.items({preprocess:S1({tag:"div",classes:["tox-collection__group"]},e)})]}))(s);return{value:e,dom:t.dom,components:t.components,items:n}}return{value:e,dom:uw(t,s,o.menuType),components:dw,items:n}},se=he("type"),C1=he("name"),x1=he("label"),In=he("text"),Z_=he("title"),Bh=he("icon"),Da=he("value"),G_=Rt("fetch"),Y_=Rt("getSubmenuItems"),No=Rt("onAction"),K_=Rt("onItemAction"),io=ue("onSetup",()=>c),U_=nt("name"),Do=nt("text"),un=nt("icon"),qa=nt("tooltip"),w1=nt("label"),L_=nt("shortcut"),N_=Ia("select"),Ya=ht("active",!1),z_=ht("borderless",!1),Kt=ht("enabled",!0),Qa=ht("primary",!1),im=e=>t("columns",e),_1=t("meta",{}),y1=ue("onAction",c),mo=e=>Dn("type",e),v1=e=>xe("name","name",Vr(()=>d(`${e}-name`)),Ee),dm=m([se,Do]),E_=m([mo("autocompleteitem"),Ya,Kt,_1,Da,Do,un]),_a=[Kt,qa,un,Do,io],w_=m([se,No].concat(_a)),fm=e=>X("toolbarbutton",w_,e),p1=[Ya].concat(_a),y_=m(p1.concat([se,No])),vm=e=>X("ToggleButton",y_,e),bm=[ue("predicate",U),zn("scope","node",["node","editor"]),zn("position","selection",["node","selection","line"])],j_=_a.concat([mo("contextformbutton"),Qa,No,We("original",z)]),b_=p1.concat([mo("contextformbutton"),Qa,No,We("original",z)]),v_=_a.concat([mo("contextformbutton")]),h_=p1.concat([mo("contextformtogglebutton")]),u_=lt("type",{contextformbutton:j_,contextformtogglebutton:b_}),l_=m([mo("contextform"),ue("initValue",n("")),w1,St("commands",u_),Rn("launch",lt("type",{contextformbutton:v_,contextformtogglebutton:h_}))].concat(bm)),c_=m([mo("contexttoolbar"),he("items")].concat(bm)),r_=[se,he("src"),nt("alt"),rr("classes",[],Ee)],i_=m(r_),o_=[se,In,U_,rr("classes",["tox-collection__item-label"],Ee)],e_=m(o_),Mm=v6(()=>dr("type",{cardimage:i_,cardtext:e_,cardcontainer:Zy})),Zy=m([se,Dn("direction","horizontal"),Dn("align","left"),Dn("valign","middle"),St("items",Mm)]),Eo=[Kt,Do,L_,("menuitem",xe("value","value",Vr(()=>d("menuitem-value")),ln())),_1],Qy=m([se,w1,St("items",Mm),io,y1].concat(Eo)),Yy=m([se,Ya,un].concat(Eo)),Nm=[se,he("fancytype"),y1],Db=[t("initData",{})].concat(Nm),T7=[Yc("initData",{},[ht("allowCustomColors",!0),Dn("storageKey","default"),s7("colors",ln())])].concat(Nm),By=lt("fancytype",{inserttable:Db,colorswatch:T7}),Iy=m([se,io,y1,un].concat(Eo)),Ny=m([se,Y_,io,un].concat(Eo)),Dy=m([se,un,Ya,io,No].concat(Eo)),f1=(t,n,s)=>{const o=$e(t.element,"."+s);if(o.length>0){const t=zo(o,e=>{const t=e.dom.getBoundingClientRect().top,s=o[0].dom.getBoundingClientRect().top;return Math.abs(t-s)>n}).getOr(o.length);return e.some({numColumns:t,numRows:Math.ceil(o.length/t)})}return e.none()},ja=e=>((e,t)=>i([w(e,t)]))(d("unnamed-events"),e),Wm=d("tooltip.exclusive"),ba=d("tooltip.show"),va=d("tooltip.hide"),qm=(e)=>{e.getSystem().broadcastOn([Wm],{})};var Ty=Object.freeze({__proto__:null,hideAllExclusive:qm,setComponents:(e,t,n,s)=>{n.getTooltip().each(e=>{e.getSystem().isConnected()&&j.set(e,s)})}}),Fy=Object.freeze({__proto__:null,events:(e,t)=>{const n=n=>{t.getTooltip().each(s=>{Un(s),e.onHide(n,s),t.clearTooltip()}),t.clearTimer()};return $(Se([[o(ba,n=>{t.resetTimer(()=>{(n=>{if(!t.isShowing()){qm(n);const a=e.lazySink(n).getOrDie(),s=n.getSystem().build({dom:e.tooltipDom,components:e.tooltipComponents,events:$("normal"===e.mode?[o(As(),e=>{T(n,ba)}),o(tu(),e=>{T(n,va)})]:[]),behaviours:i([j.config({})])});t.setTooltip(s),Ys(a,s),e.onShow(n,s),Ye.position(a,s,{anchor:e.anchor(n)})}})(n)},e.delay)}),o(va,s=>{t.resetTimer(()=>{n(s)},e.delay)}),o(Ns(),(e,t)=>{const s=t;s.universal||_e(s.channels,Wm)&&n(e)}),_n(e=>{n(e)})],"normal"===e.mode?[o(Ms(),e=>{T(e,ba)}),o(mu(),e=>{T(e,va)}),o(As(),e=>{T(e,ba)}),o(tu(),e=>{T(e,va)})]:[o(np(),(e)=>{T(e,ba)}),o(Ou(),e=>{T(e,va)})]]))}}),My=[s("lazySink"),s("tooltipDom"),t("exclusive",!0),t("tooltipComponents",[]),t("delay",300),zn("mode","normal",["normal","follow-highlight"]),t("anchor",e=>({type:"hotspot",hotspot:e,layouts:{onLtr:n([ke,dt,ze,Qe,De,Xe]),onRtl:n([ke,dt,ze,Qe,De,Xe])}})),C("onHide"),C("onShow")];const Qm=we({fields:My,name:"tooltipping",active:Fy,state:Object.freeze({__proto__:null,init:()=>{const t=q(),e=q(),s=()=>{t.on(clearTimeout)},o=n("not-implemented");return jt({getTooltip:e.get,isShowing:e.isSet,setTooltip:e.set,clearTooltip:e.clear,clearTimer:s,resetTimer:(e,n)=>{s(),t.set(setTimeout(e,n))},readState:o})}}),apis:Ty}),Zm="silver.readonly",Ay=m([("readonly",vt("readonly",ca))]),ar=(e,t)=>{const s=e.mainUi.outerContainer.element,n=[e.mainUi.mothership,...e.uiMotherships];t&&h(n,e=>{e.broadcastOn([Es()],{target:s})}),h(n,e=>{e.broadcastOn([Zm],{readonly:t})})},t8=(e,t)=>{e.on("init",()=>{e.mode.isReadOnly()&&ar(t,!0)}),e.on("SwitchMode",()=>ar(t,e.mode.isReadOnly())),Z2(e)&&e.mode.set("readonly")},re=()=>Vt.config({channels:{[Zm]:{schema:Ay,onReceive:(e,t)=>{g.set(e,t.readonly)}}}}),Oo=e=>g.config({disabled:e}),o8=e=>g.config({disabled:e,disableClass:"tox-tbtn--disabled"}),h1=e=>g.config({disabled:e,disableClass:"tox-tbtn--disabled",useNative:!1}),ur=(e,t)=>{const n=e.getApi(t);return e=>{e(n)}},na=(e,t)=>Q(n=>{ur(e,n)(n=>{const s=e.onSetup(n);At(s)&&t.set(s)})}),ka=(e,t)=>_n(n=>ur(e,n)(t.get())),Tv=(e,t)=>Vn((n,s)=>{ur(e,n)(e.onAction),e.triggersSubmenu||t!==Ut.CLOSE_ON_EXECUTE||(n.getSystem().isConnected()&&T(n,Tc()),s.stop())}),Cy={[ut()]:["disabling","alloy.base.behaviour","toggling","item-events"]},da=so,_o=(e,t,n,s)=>{const o=v(c);return{type:"item",dom:t.dom,components:da(t.optComponents),data:e.data,eventOrder:Cy,hasSubmenu:e.triggersSubmenu,itemBehaviours:i([w("item-events",[Tv(e,n),na(e,o),ka(e,o)]),(a=()=>!e.enabled||s.isDisabled(),g.config({disabled:a,disableClass:"tox-collection__item--state-disabled"})),re(),j.config({})].concat(e.itemBehaviours))};var a},ko=e=>({value:e.value,meta:{text:e.text.getOr(""),...e.meta}}),yy=e=>{const t=Wo.os.isMacOS()||Wo.os.isiOS(),n=t?{alt:"",ctrl:"",shift:"",meta:"",access:""}:{meta:"Ctrl",access:"Shift+Alt"},o=e.split("+"),s=a(o,e=>{const t=e.toLowerCase().trim();return R(n,t)?n[t]:e});return t?s.join(""):s.join("+")},c1=(e,t,n=[nh])=>gn(e,{tag:"div",classes:n},t),g8=e=>({dom:{tag:"div",classes:[F1]},components:[be(xt.translate(e))]}),v8=(e,t)=>({dom:{tag:"div",classes:t,innerHtml:e}}),by=(e,t)=>({dom:{tag:"div",classes:[F1]},components:[{dom:{tag:e.tag,styles:e.styles},components:[be(xt.translate(t))]}]}),gy=e=>({dom:{tag:"div",classes:["tox-collection__item-accessory"]},components:[be(yy(e))]}),y8=e=>c1("checkmark",e,["tox-collection__item-checkmark"]),_8=e=>{const t=e.map(e=>({attributes:{title:xt.translate(e)}})).getOr({});return{tag:"div",classes:[z1,Ga],...t}},oa=(t,n,s,o=e.none())=>"color"===t.presets?((e,t,n)=>{const o=e.ariaLabel,s=e.value,i=e.iconContent.map(e=>((e,t,n)=>{const s=t();return R2(e,s).or(n).getOrThunk(c4(s))})(e,t.icons,n));return{dom:(()=>{const n=i.getOr(""),a=o.map(e=>({title:t.translate(e)})).getOr({}),e={tag:"div",attributes:a,classes:["tox-swatch"]};return"custom"===s?{...e,tag:"button",classes:[...e.classes,"tox-swatches__picker-btn"],innerHtml:n}:"remove"===s?{...e,classes:[...e.classes,"tox-swatch--remove"],innerHtml:n}:Wt(s)?{...e,attributes:{...e.attributes,"data-mce-color":s},styles:{"background-color":s},innerHtml:n}:e})(),optComponents:[]}})(t,n,o):((t,n,s,o)=>{const i={tag:"div",classes:[nh]},a=s?t.iconContent.map(e=>gn(e,i,n.icons,o)).orThunk(()=>e.some({dom:i})):e.none(),r=t.checkMark,c=e.from(t.meta).fold(()=>g8,e=>R(e,"style")?Nt(by,e.style):g8),l=t.htmlContent.fold(()=>t.textContent.map(c),t=>e.some(v8(t,[F1])));return{dom:_8(t.ariaLabel),optComponents:[a,l,t.shortcutContent.map(gy),r,t.caret]}})(t,n,s,o),O8=(e,t)=>f(e,"tooltipWorker").map(e=>[Qm.config({lazySink:t.getSink,tooltipDom:{tag:"div",classes:["tox-tooltip-worker-container"]},tooltipComponents:[],anchor:e=>({type:"submenu",item:e,overrides:{maxHeightFunction:gi}}),mode:"follow-highlight",onShow:(t)=>{e(e=>{Qm.setComponents(t,[uh({element:l(e)})])})}})]).getOr([]),x8=(e,t)=>{const n=(e=>ua.DOM.encode(e))(xt.translate(e));if(t.length>0){const e=new RegExp((e=>e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"))(t),"gi");return n.replace(e,e=>`<span class="tox-autocompleter-highlight">${e}</span>`)}return n},C8=(t,n)=>a(t,t=>{switch(t.type){case"cardcontainer":return((e,t)=>{const n="vertical"===e.direction?"tox-collection__item-container--column":rh,s="left"===e.align?"tox-collection__item-container--align-left":"tox-collection__item-container--align-right";return{dom:{tag:"div",classes:[ah,n,s,(()=>{switch(e.valign){case"top":return"tox-collection__item-container--valign-top";case"middle":return"tox-collection__item-container--valign-middle";case"bottom":return"tox-collection__item-container--valign-bottom"}})()]},components:t}})(t,C8(t.items,n));case"cardimage":return((e,t,n)=>({dom:{tag:"img",classes:t,attributes:{src:e,alt:n.getOr("")}}}))(t.src,t.classes,t.alt);case"cardtext":const s=t.name.exists(e=>_e(n.cardText.highlightOn,e)),o=s?e.from(n.cardText.matchText).getOr(""):"";return v8(x8(t.text,o),t.classes)}}),E8=Pu(h4(),u4()),k8=e=>({value:e}),A8=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,S8=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,M8=e=>A8.test(e)||S8.test(e),py=e=>{return(t=e,((e,t)=>T8(e,t,0))(t,"#")?((e,t)=>e.substring(t))(t,"#".length):t).toUpperCase();var t},a1=e=>{const t=e.toString(16);return(1===t.length?"0"+t:t).toUpperCase()},sa=e=>{const t=a1(e.red)+a1(e.green)+a1(e.blue);return k8(t)},D8=Math.min,N8=Math.max,hr=Math.round,cy=/^\s*rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)\s*$/i,Wy=/^\s*rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d?(?:\.\d+)?)\s*\)\s*$/i,ps=(e,t,n,s)=>({red:e,green:t,blue:n,alpha:s}),o1=e=>{const t=parseInt(e,10);return t.toString()===e&&t>=0&&t<=255},B8=e=>{let t,n,s;const d=(e.hue||0)%360;let r=e.saturation/100,a=e.value/100;if(r=N8(0,D8(r,1)),a=N8(0,D8(a,1)),0===r)return t=n=s=hr(255*a),ps(t,n,s,1);const l=d/60,o=a*r,i=o*(1-Math.abs(l%2-1)),c=a-o;switch(Math.floor(l)){case 0:t=o,n=i,s=0;break;case 1:t=i,n=o,s=0;break;case 2:t=0,n=o,s=i;break;case 3:t=0,n=i,s=o;break;case 4:t=i,n=0,s=o;break;case 5:t=o,n=0,s=i;break;default:t=n=s=0}return t=hr(255*(t+c)),n=hr(255*(n+c)),s=hr(255*(s+c)),ps(t,n,s,1)},ea=e=>{const t=(e=>{const n=(e=>{const t=e.value.replace(A8,(e,t,n,s)=>t+t+n+n+s+s);return{value:t}})(e),t=S8.exec(n.value);return null===t?["FFFFFF","FF","FF","FF"]:t})(e),n=parseInt(t[1],16),s=parseInt(t[2],16),o=parseInt(t[3],16);return ps(n,s,o,1)},$8=(e,t,n,s)=>{const o=parseInt(e,10),i=parseInt(t,10),a=parseInt(n,10),r=parseFloat(s);return ps(o,i,a,r)},W8=t=>{if("transparent"===t)return e.some(ps(0,0,0,0));const s=cy.exec(t);if(null!==s)return e.some($8(s[1],s[2],s[3],"1"));const n=Wy.exec(t);return null!==n?e.some($8(n[1],n[2],n[3],n[4])):e.none()},U8=e=>`rgba(${e.red},${e.green},${e.blue},${e.alpha})`,K8=ps(255,0,0,1),n1=(e,t)=>{e.dispatch("ResizeContent",t)},sy=(e,t)=>e.dispatch("ResolveName",{name:t.nodeName.toLowerCase(),target:t});gs=tinymce.util.Tools.resolve("tinymce.util.LocalStorage");const X8={},Q8=e=>f(X8,e).getOrThunk(()=>{const t=`tinymce-custom-colors-${e}`,s=gs.getItem(t);if(Or(s)){const e=gs.getItem("tinymce-custom-colors");gs.setItem(t,Wt(e)?e:"[]")}const n=((e,t=10)=>{const o=gs.getItem(e),i=L(o)?JSON.parse(o):[],n=t-(s=i).length<0?s.slice(0,t):s;var s;const a=e=>{n.splice(e,1)};return{add:s=>{x6(n,s).each(a),n.unshift(s),n.length>t&&n.pop(),gs.setItem(e,JSON.stringify(n))},state:()=>n.slice(0)}})(t,10);return X8[e]=n,n}),Z8=(e,t)=>{Q8(e).add(t)},Zi=(e,t,n)=>({hue:e,saturation:t,value:n}),e1=e=>{let i=0,c=0,a=0;const n=e.red/255,r=e.green/255,s=e.blue/255,t=Math.min(n,Math.min(r,s)),o=Math.max(n,Math.max(r,s));return t===o?(a=t,Zi(0,0,100*a)):(i=n===t?3:s===t?1:5,i=60*(i-(n===t?r-s:s===t?n-r:s-n)/(o-t)),c=(o-t)/o,a=o,Zi(Math.round(i),Math.round(100*c),Math.round(100*a)))},tf=e=>sa(B8(e)),ey=t=>{return(n=t,M8(n)?e.some({value:py(n)}):e.none()).orThunk(()=>W8(t).map(sa)).getOrThunk(()=>{const e=document.createElement("canvas");e.height=1,e.width=1;const n=e.getContext("2d");n.clearRect(0,0,e.width,e.height),n.fillStyle="#FFFFFF",n.fillStyle=t,n.fillRect(0,0,1,1);const s=n.getImageData(0,0,1,1).data,o=s[0],i=s[1],a=s[2],r=s[3];return sa(ps(o,i,a,r))});var n},Ju="forecolor",Qu="hilitecolor",Gu=e=>Math.max(5,Math.ceil(Math.sqrt(e))),Gj=e=>{const t=[];for(let n=0;n<e.length;n+=2)t.push({text:e[n+1],value:"#"+ey(e[n]).value,icon:"checkmark",type:"choiceitem"});return t},Pn=e=>t=>t.options.get(e),Yu="#000000",uf=(e,t)=>t===Ju?Pn("color_cols_foreground")(e):t===Qu?Pn("color_cols_background")(e):Pn("color_cols")(e),hf=Pn("custom_colors"),Xi=(e,t)=>t===Ju&&e.options.isSet("color_map_foreground")?Pn("color_map_foreground")(e):t===Qu&&e.options.isSet("color_map_background")?Pn("color_map_background")(e):Pn("color_map")(e),Wj=Pn("color_default_foreground"),Hj=Pn("color_default_background"),gf=(e,t)=>{const n=ft(l(e.selection.getStart()),"hilitecolor"===t?"background-color":"color");return W8(n).map(e=>"#"+sa(e).value)},vf=e=>{const t="choiceitem",n={type:t,text:"Remove color",icon:"color-swatch-remove-color",value:"remove"};return e?[n,{type:t,text:"Custom color",icon:"color-picker",value:"custom"}]:[n]},qu=(e,t,n,s)=>{"custom"===n?xf(e)(n=>{n.each(n=>{Z8(t,n),e.execCommand("mceApplyTextcolor",t,n),s(n)})},gf(e,t).getOr(Yu)):"remove"===n?(s(""),e.execCommand("mceRemoveTextcolor",t)):(s(n),e.execCommand("mceApplyTextcolor",t,n))},jf=(e,t,n)=>e.concat((e=>a(Q8(e).state(),e=>({type:"choiceitem",text:e,icon:"checkmark",value:e})))(t).concat(vf(n))),yf=(e,t,n)=>s=>{s(jf(e,t,n))},_f=(e,t,n)=>{const s="forecolor"===t?"tox-icon-text-color__color":"tox-icon-highlight-bg-color__color";e.setIconFill(s,n)},wf=(e,t,n,s,o)=>{e.ui.registry.addSplitButton(t,{tooltip:s,presets:"color",icon:"forecolor"===t?"text-color":"highlight-bg-color",select:t=>{const s=gf(e,n);return sn(s,t.toUpperCase())},columns:uf(e,n),fetch:yf(Xi(e,n),n,hf(e)),onAction:t=>{qu(e,n,o.get(),c)},onItemAction:(s,i)=>{qu(e,n,i,n=>{o.set(n),((e,t)=>{e.dispatch("TextColorChange",t)})(e,{name:t,color:n})})},onSetup:n=>{_f(n,t,o.get());const s=e=>{e.name===t&&_f(n,e.name,e.color)};return e.on("TextColorChange",s),()=>{e.off("TextColorChange",s)}}})},Of=(e,t,n,s)=>{e.ui.registry.addNestedMenuItem(t,{text:s,icon:"forecolor"===t?"text-color":"highlight-bg-color",getSubmenuItems:()=>[{type:"fancymenuitem",fancytype:"colorswatch",initData:{storageKey:n},onAction:t=>{qu(e,n,t.value,c)}}]})},xf=t=>(n,s)=>{let o=!1;const i={colorpicker:s};t.windowManager.open({title:"Color Picker",size:"normal",body:{type:"panel",items:[{type:"colorpicker",name:"colorpicker",label:"Color"}]},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:i,onAction:(e,t)=>{"hex-valid"===t.name&&(o=t.value)},onSubmit:s=>{const i=s.getData().colorpicker;o?(n(e.from(i)),s.close()):t.windowManager.alert(t.translate(["Invalid hex color code: {0}",i]))},onClose:c,onCancel:()=>{n(e.none())}})},Ku=(e,t,n,s,o,i,a,r)=>{const c=Ba(t),l=Pj(t,n,s,"color"!==o?"normal":"color",i,a,r);return E1(e,c,l,s,{menuType:o})},Pj=(t,n,s,o,i,r,l)=>so(a(t,a=>{return"choiceitem"===a.type?(d=a,X("choicemenuitem",Yy,d)).fold(Fn,a=>e.some(((t,n,s,o,i,a,r,l=!0)=>{const d=oa({presets:s,textContent:n?t.text:e.none(),htmlContent:e.none(),ariaLabel:t.text,iconContent:t.icon,shortcutContent:n?t.shortcut:e.none(),checkMark:n?e.some(y8(r.icons)):e.none(),caret:e.none(),value:t.value},r,l);return te(_o({data:ko(t),enabled:t.enabled,getApi:e=>({setActive:t=>{A.set(e,t)},isActive:()=>A.isOn(e),isEnabled:()=>!g.isDisabled(e),setEnabled:t=>g.set(e,!t)}),onAction:e=>o(t.value),onSetup:e=>(e.setActive(i),c),triggersSubmenu:!1,itemBehaviours:[]},d,a,r),{toggling:{toggleClass:th,toggleOnExecute:!1,selected:t.active,exclusive:!0}})})(a,1===s,o,n,r(a.value),i,l,Ba(t)))):e.none();var d})),Lr=(t,n)=>{const s=Ws(n);return 1===t?{mode:"menu",moveOnTab:!0}:"auto"===t?{mode:"grid",selector:"."+s.item,initSize:{numColumns:1,numRows:1}}:{mode:"matrix",rowSelector:"."+("color"===n?"tox-swatches__row":"tox-collection__group"),previousSelector:t=>"color"===n?pe(t.element,"[aria-checked=true]"):e.none()}},Af=d("cell-over"),Sf=d("cell-execute"),Nj=(e,t,n)=>{const s=n=>p(n,Sf,{row:e,col:t}),a=(e,t)=>{t.stop(),s(e)};return qe({dom:{tag:"div",attributes:{role:"button","aria-labelledby":n}},behaviours:i([w("insert-table-picker-cell",[o(As(),b.focus),o(ut(),s),o(Hi(),a),o(xi(),a)]),A.config({toggleClass:"tox-insert-table-picker__selected",toggleOnExecute:!1}),b.config({onFocus:n=>p(n,Af,{row:e,col:t})})])})},Dj=e=>le(e,e=>a(e,Pt)),Tf=(e,t)=>be(`${t}x${e}`),zj={inserttable:e=>{const n=d("size-label"),s=((e)=>{const s=[];for(let t=0;t<10;t++){const n=[];for(let s=0;s<10;s++)n.push(Nj(t,s,e));s.push(n)}return s})(n),o=Tf(0,0),t=V({dom:{tag:"span",classes:["tox-insert-table-picker__label"],attributes:{id:n}},components:[o],behaviours:i([j.config({})])});return{type:"widget",data:{value:d("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[E8.widget({dom:{tag:"div",classes:["tox-insert-table-picker"]},components:Dj(s).concat(t.asSpec()),behaviours:i([w("insert-table-picker",[Q(e=>{j.set(t.get(e),[o])}),Fu(Af,(e,n,o)=>{const{row:i,col:a}=o.event;((e,t,n)=>{for(let s=0;s<10;s++)for(let o=0;o<10;o++)A.set(e[s][o],s<=t&&o<=n)})(s,i,a),j.set(t.get(e),[Tf(i+1,a+1)])}),Fu(Sf,(t,n,s)=>{const{row:o,col:i}=s.event;e.onAction({numRows:o+1,numColumns:i+1}),T(t,Tc())})]),u.config({initSize:{numRows:10,numColumns:10},mode:"flatgrid",selector:'[role="button"]'})])})]}},colorswatch:(e,t)=>{const o=((e,t)=>{const n=e.initData.allowCustomColors&&t.colorinput.hasCustomColors();return e.initData.colors.fold(()=>jf(t.colorinput.getColors(e.initData.storageKey),e.initData.storageKey,n),e=>e.concat(vf(n)))})(e,t),s=t.colorinput.getColorCols(e.initData.storageKey),n="color",i={...Ku(d("menu-value"),o,t=>{e.onAction({value:t})},s,n,Ut.CLOSE_ON_EXECUTE,U,t.shared.providers),markers:Ws(n),movement:Lr(s,n)};return{type:"widget",data:{value:d("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[E8.widget(Bs.sketch(i))]}}},Df=e=>({type:"separator",dom:{tag:"div",classes:[Ga,"tox-collection__group-heading"]},components:e.text.map(be).toArray()});var Tj=Object.freeze({__proto__:null,getCoupled:(e,t,n,s)=>n.getOrCreate(e,t,s),getExistingCoupled:(e,t,n,s)=>n.getExisting(e,t,s)}),Fj=[vt("others",Zp(x.value,ln()))],Ej=Object.freeze({__proto__:null,init:()=>{const t={},s=(e,n)=>{if(0===ce(e.others).length)throw new Error("Cannot find any known coupled components");return f(t,n)},o=n({});return jt({readState:o,getExisting:(t,n,o)=>s(n,o).orThunk(()=>(f(n.others,o).getOrDie("No information found for coupled component: "+o),e.none())),getOrCreate:(e,n,o)=>s(n,o).getOrThunk(()=>{const i=f(n.others,o).getOrDie("No information found for coupled component: "+o)(e),s=e.getSystem().build(i);return t[o]=s,s})})}});const Y=we({fields:Fj,name:"coupling",apis:Tj,state:Ej}),Uu=t=>{let n=e.none(),s=[];const i=e=>{o()?a(e):s.push(e)},o=()=>n.isSome(),a=e=>{n.each(t=>{setTimeout(()=>{e(t)},0)})};return t(t=>{o()||(n=e.some(t),h(s,a),s=[])}),{get:i,map:e=>Uu(t=>{i(n=>{t(e(n))})}),isReady:o}},xj={nu:Uu,pure:e=>Uu(t=>{t(e)})},_j=e=>{setTimeout(()=>{throw e},0)},Po=e=>{const t=t=>{e().then(t,_j)};return{map:t=>Po(()=>e().then(t)),bind:t=>Po(()=>e().then(e=>t(e).toPromise())),anonBind:t=>Po(()=>e().then(()=>t.toPromise())),toLazy:()=>xj.nu(t),toCached:()=>{let t=null;return Po(()=>(null===t&&(t=e()),t))},toPromise:e,get:t}},Fs=e=>Po(()=>new Promise(e)),Yn=e=>Po(()=>Promise.resolve(e)),Uf=n("sink"),Kf=n(wt({name:Uf(),overrides:n({dom:{tag:"div"},behaviours:i([Ye.config({useFixed:Oe})]),events:$([ro($i()),ro(It()),ro(Hi())])})})),qf=(e,t)=>{const n=e.getHotspot(t).getOr(t),s="hotspot",o=e.getAnchorOverrides();return e.layouts.fold(()=>({type:s,hotspot:n,overrides:o}),e=>({type:s,hotspot:n,overrides:o,layouts:e}))},Xr=(t,n,s,o,i,a,r)=>{const c=((t,n,s,o,i,a,r)=>{const l=((e,t,n)=>(0,e.fetch)(n).map(t))(t,n,o),c=Qf(o,t);return l.map(t=>t.bind(t=>e.from(Ls.sketch({...a.menu(),uid:Co(""),data:t,highlightOnOpen:r,onOpenMenu:(e,t)=>{const n=c().getOrDie();Ye.position(n,t,{anchor:s}),k.decloak(i)},onOpenSubmenu:(e,t,n)=>{const s=c().getOrDie();Ye.position(s,n,{anchor:{type:"submenu",item:t}}),k.decloak(i)},onRepositionMenu:(e,t,n)=>{const o=c().getOrDie();Ye.position(o,t,{anchor:s}),h(n,e=>{Ye.position(o,e.triggeredMenu,{anchor:{type:"submenu",item:e.triggeringItem}})})},onEscape:()=>(b.focus(o),k.close(i),e.some(!0))}))))})(t,n,qf(t,s),s,o,i,r);return c.map(e=>(e.fold(()=>{k.isOpen(o)&&k.close(o)},e=>{k.cloak(o),k.open(o,e),a(o)}),o))},gj=(e,t,n,s)=>(k.close(s),Yn(s)),Bu=(e,t,n,s,o,i)=>{const a=Y.getCoupled(n,"sandbox");return(k.isOpen(a)?gj:Xr)(e,t,n,a,s,o,i)},Qf=(e,t)=>e.getSystem().getByUid(t.uid+"-"+Uf()).map(e=>()=>x.value(e)).getOrThunk(()=>t.lazySink.fold(()=>()=>x.error(new Error("No internal sink is specified, nor could an external sink be found")),t=>()=>t(e))),Zf=e=>{k.getState(e).each(e=>{Ls.repositionMenus(e)})},Hu=(e,t,n)=>{const s=G2(),o=Qf(t,e);return{dom:{tag:"div",classes:e.sandboxClasses,attributes:{id:s.id,role:"listbox"}},behaviours:ni(e.sandboxBehaviours,[r.config({store:{mode:"memory",initialValue:t}}),k.config({onOpen:(o,i)=>{const a=qf(e,t);s.link(t.element),e.matchWidth&&((e,t,n)=>{const s=O.getCurrent(t).getOr(t),o=et(e.element);n?y(s.element,"min-width",o+"px"):((e,t)=>{Xa.set(e,t)})(s.element,o)})(a.hotspot,i,e.useMinWidth),e.onOpen(a,o,i),void 0!==n&&void 0!==n.onOpen&&n.onOpen(o,i)},onClose:(e,o)=>{s.unlink(t.element),void 0!==n&&void 0!==n.onClose&&n.onClose(e,o)},isPartOf:(e,n,s)=>Ps(n,s)||Ps(t,s),getAttachPoint:()=>o().getOrDie()}),O.config({find:e=>k.getState(e).bind(e=>O.getCurrent(e))}),Vt.config({channels:{...Vd({isExtraPart:U}),...Wd({doReposition:Zf})}})])}},e6=e=>{const t=Y.getCoupled(e,"sandbox");Zf(t)},Lu=()=>[t("sandboxClasses",[]),si("sandboxBehaviours",[O,Vt,k,r])],fj=n([s("dom"),s("fetch"),C("onOpen"),ot("onExecute"),t("getHotspot",e.some),t("getAnchorOverrides",n({})),hs(),fe("dropdownBehaviours",[A,Y,u,b]),s("toggleClass"),t("eventOrder",{}),D("lazySink"),t("matchWidth",!1),t("useMinWidth",!1),D("role")].concat(Lu())),mj=n([Lt({schema:[jr(),t("fakeFocus",!1)],name:"menu",defaults:e=>({onExecute:e.onExecute})}),Kf()]),Et=Be({name:"Dropdown",configFields:fj(),partFields:mj(),factory:(t,n,s,o)=>{const a=e=>{k.getState(e).each(e=>{Ls.highlightPrimary(e)})},i=(e,n,s)=>Bu(t,z,e,o,n,s),l={expand:e=>{A.isOn(e)||i(e,c,Ue.HighlightNone).get(c)},open:e=>{A.isOn(e)||i(e,c,Ue.HighlightMenuAndItem).get(c)},refetch:e=>Y.getExistingCoupled(e,"sandbox").fold(()=>i(e,c,Ue.HighlightMenuAndItem).map(c),n=>Xr(t,z,e,n,o,c,Ue.HighlightMenuAndItem).map(c)),isOpen:A.isOn,close:e=>{A.isOn(e)&&i(e,c,Ue.HighlightMenuAndItem).get(c)},repositionMenus:e=>{A.isOn(e)&&e6(e)}},r=(t)=>(Js(t),e.some(!0));return{uid:t.uid,dom:t.dom,components:n,behaviours:ye(t.dropdownBehaviours,[A.config({toggleClass:t.toggleClass,aria:{mode:"expanded"}}),Y.config({others:{sandbox:e=>Hu(t,e,{onOpen:()=>A.on(e),onClose:()=>A.off(e)})}}),u.config({mode:"special",onSpace:r,onEnter:r,onDown:(t)=>{if(Et.isOpen(t)){const e=Y.getCoupled(t,"sandbox");a(e)}else Et.open(t);return e.some(!0)},onEscape:(t)=>Et.isOpen(t)?(Et.close(t),e.some(!0)):e.none()}),b.config({})]),events:wr(e.some(e=>{i(e,a,Ue.HighlightMenuAndItem).get(c)})),eventOrder:{...t.eventOrder,[ut()]:["disabling","toggling","alloy.base.behaviour"]},apis:l,domModification:{attributes:{"aria-haspopup":"true",...t.role.fold(()=>({}),e=>({role:e})),..."button"===t.dom.tag?{type:("type",f(t.dom,"attributes").bind(e=>f(e,"type"))).getOr("button")}:{}}}}},apis:{open:(e,t)=>e.open(t),refetch:(e,t)=>e.refetch(t),expand:(e,t)=>e.expand(t),close:(e,t)=>e.close(t),isOpen:(e,t)=>e.isOpen(t),repositionMenus:(e,t)=>e.repositionMenus(t)}}),i6=(t,n,s)=>{Oh(t).each(t=>{var o;((e,t)=>{_t(t.element,"id").each(t=>_(e.element,"aria-activedescendant",t))})(t,s),(mt((o=n).element,Va)?e.some(o.element):pe(o.element,"."+Va)).each(e=>{_t(e,"id").each(e=>_(t.element,"aria-controls",e))})}),_(s.element,"aria-selected","true")},nj=(e,t,n)=>{_(n.element,"aria-selected","false")},tj=e=>Y.getExistingCoupled(e,"sandbox").bind($a).map(xh).map(e=>e.fetchPattern).getOr("");!function(e){e[e.ContentFocus=0]="ContentFocus",e[e.UiFocus=1]="UiFocus"}(nc||(nc={}));const qb=(t,n,s,o,i)=>{const a=s.shared.providers,r=t=>i?{...t,shortcut:e.none(),icon:t.text.isSome()?e.none():t.icon}:t;switch(t.type){case"menuitem":return(l=t,X("menuitem",Iy,l)).fold(Fn,t=>e.some(((t,n,s,o=!0)=>{const i=oa({presets:"normal",iconContent:t.icon,textContent:t.text,htmlContent:e.none(),ariaLabel:t.text,caret:e.none(),checkMark:e.none(),shortcutContent:t.shortcut},s,o);return _o({data:ko(t),getApi:e=>({isEnabled:()=>!g.isDisabled(e),setEnabled:t=>g.set(e,!t)}),enabled:t.enabled,onAction:t.onAction,onSetup:t.onSetup,triggersSubmenu:!1,itemBehaviours:[]},i,n,s)})(r(t),n,a,o)));case"nestedmenuitem":return(e=>X("nestedmenuitem",Ny,e))(t).fold(Fn,t=>e.some(((t,n,s,o=!0,i=!1)=>{const r=i?(a=s.icons,c1("chevron-down",a,[oh])):(e=>c1("chevron-right",e,[oh]))(s.icons);var a;const l=oa({presets:"normal",iconContent:t.icon,textContent:t.text,htmlContent:e.none(),ariaLabel:t.text,caret:e.some(r),checkMark:e.none(),shortcutContent:t.shortcut},s,o);return _o({data:ko(t),getApi:e=>({isEnabled:()=>!g.isDisabled(e),setEnabled:t=>g.set(e,!t)}),enabled:t.enabled,onAction:c,onSetup:t.onSetup,triggersSubmenu:!0,itemBehaviours:[]},l,n,s)})(r(t),n,a,o,i)));case"togglemenuitem":return(e=>X("togglemenuitem",Dy,e))(t).fold(Fn,t=>e.some(((t,n,s,o=!0)=>{const i=oa({iconContent:t.icon,textContent:t.text,htmlContent:e.none(),ariaLabel:t.text,checkMark:e.some(y8(s.icons)),caret:e.none(),shortcutContent:t.shortcut,presets:"normal",meta:t.meta},s,o);return te(_o({data:ko(t),enabled:t.enabled,getApi:e=>({setActive:t=>{A.set(e,t)},isActive:()=>A.isOn(e),isEnabled:()=>!g.isDisabled(e),setEnabled:t=>g.set(e,!t)}),onAction:t.onAction,onSetup:t.onSetup,triggersSubmenu:!1,itemBehaviours:[]},i,n,s),{toggling:{toggleClass:th,toggleOnExecute:!1,selected:t.active}})})(r(t),n,a,o)));case"separator":return(e=>X("separatormenuitem",dm,e))(t).fold(Fn,t=>e.some(Df(t)));case"fancymenuitem":return(e=>X("fancymenuitem",By,e))(t).fold(Fn,e=>((e,t)=>f(zj,e.fancytype).map(n=>n(e,t)))(e,s));default:return console.error("Unknown item in general menu",t),e.none()}var l},Wb=(t,s,o,i,r,l,d)=>{const u=1===i,m=!u||Ba(t);return so(a(t,t=>{switch(t.type){case"separator":return(i=t,X("Autocompleter.Separator",dm,i)).fold(Fn,t=>e.some(Df(t)));case"cardmenuitem":return(e=>X("cardmenuitem",Qy,e))(t).fold(Fn,t=>e.some(((t,n,s,o)=>{const i={dom:_8(t.label),optComponents:[e.some({dom:{tag:"div",classes:[ah,rh]},components:C8(t.items,o)})]};return _o({data:ko({text:e.none(),...t}),enabled:t.enabled,getApi:e=>({isEnabled:()=>!g.isDisabled(e),setEnabled:t=>{g.set(e,!t),h($e(e.element,"*"),n=>{e.getSystem().getByDom(n).each(e=>{e.hasConfigured(g)&&g.set(e,!t)})})}}),onAction:t.onAction,onSetup:t.onSetup,triggersSubmenu:!1,itemBehaviours:e.from(o.itemBehaviours).getOr([])},i,n,s.providers)})({...t,onAction:e=>{t.onAction(e),o(t.value,t.meta)}},r,l,{itemBehaviours:O8(t.meta,l),cardText:{matchText:s,highlightOn:d}})));default:return(e=>X("Autocompleter.Item",E_,e))(t).fold(Fn,t=>e.some(((t,s,o,i,a,r,l,d=!0)=>{const u=oa({presets:i,textContent:e.none(),htmlContent:o?t.text.map(e=>x8(e,s)):e.none(),ariaLabel:t.text,iconContent:t.icon,shortcutContent:e.none(),checkMark:e.none(),caret:e.none(),value:t.value},l.providers,d,t.icon);return _o({data:ko(t),enabled:t.enabled,getApi:n({}),onAction:e=>a(t.value,t.meta),onSetup:n(c),triggersSubmenu:!1,itemBehaviours:O8(t.meta,l)},u,r,l.providers)})(t,s,u,"normal",o,r,l,m)))}var i}))},u6=(e,t,n,s,o,i)=>{const r=Ba(t),c=so(a(t,e=>{const t=e=>qb(e,n,s,(e=>o?!R(e,"text"):r)(e),o);return t("nestedmenuitem"===e.type&&e.getSubmenuItems().length<=0?{...e,enabled:!1}:e)})),l=(e=>"no-search"===e.searchMode?{menuType:"normal"}:{menuType:"searchable",searchMode:e})(i);return(o?J_:E1)(e,r,c,1,l)},Mu=e=>Ls.singleData(e.value,e),$b=(t,n)=>{const s=v(!1),r=v(!1),a=qe(J.sketch({dom:{tag:"div",classes:["tox-autocompleter"]},components:[],fireDismissalEventInstead:{},inlineBehaviours:i([w("dismissAutocompleter",[o(di(),()=>d())])]),lazySink:n.getSink})),h=()=>J.isOpen(a),g=r.get,c=()=>{h()&&J.hide(a)},m=()=>J.getContent(a).bind(e=>fr(e.components(),0)),d=()=>t.execCommand("mceAutocompleterClose"),f=o=>{const i=(o=>{const i=wn(o,t=>e.from(t.columns)).getOr(1);return le(o,e=>{const o=e.items;return Wb(o,e.matchText,(n,o)=>{const i=t.selection.getRng();((e,t)=>G3(l(t.startContainer)).map(t=>{const n=e.createRng();return n.selectNode(t.dom),n}))(t.dom,i).each(i=>{const a={hide:()=>d(),reload:e=>{c(),t.execCommand("mceAutocompleterReload",!1,{fetchOptions:e})}};s.set(!0),e.onAction(a,i,n,o),s.set(!1)})},i,Ut.BUBBLE_TO_SANDBOX,n,e.highlightOn)})})(o);i.length>0?((n,s)=>{var o;(o=l(t.getBody()),pe(o,Y3)).each(o=>{const i=wn(n,t=>e.from(t.columns)).getOr(1);J.showMenuAt(a,{anchor:{type:"node",root:l(t.getBody()),node:e.from(o)}},((e,t,n,s)=>{const o=Lr(t,s),i=Ws(s);return{data:Mu({...e,movement:o,menuBehaviours:ja("auto"!==t?[]:[Q((e)=>{f1(e,4,i.item).each(({numColumns:t,numRows:n})=>{u.setGridSize(e,n,t)})})])}),menu:{markers:Ws(s),fakeFocus:n===nc.ContentFocus}}})(E1("autocompleter-value",!0,s,i,{menuType:"normal"}),i,nc.ContentFocus,"normal"))}),m().each(F.highlightFirst)})(o,i):c()};t.on("AutocompleterStart",({lookupData:e})=>{r.set(!0),s.set(!1),f(e)}),t.on("AutocompleterUpdate",({lookupData:e})=>f(e)),t.on("AutocompleterEnd",()=>{c(),r.set(!1),s.set(!1)}),((e,t)=>{const s=(e,t)=>{p(e,$i(),{raw:t})},n=()=>e.getMenu().bind(F.getHighlighted);t.on("keydown",t=>{const o=t.which;e.isActive()&&(e.isMenuOpen()?13===o?(n().each(Js),t.preventDefault()):40===o?(n().fold(()=>{e.getMenu().each(F.highlightFirst)},e=>{s(e,t)}),t.preventDefault(),t.stopImmediatePropagation()):37!==o&&38!==o&&39!==o||n().each(e=>{s(e,t),t.preventDefault(),t.stopImmediatePropagation()}):13!==o&&38!==o&&40!==o||e.cancelIfNecessary())}),t.on("NodeChange",t=>{e.isActive()&&!e.isProcessingAction()&&G3(l(t.element)).isNone()&&e.cancelIfNecessary()})})({cancelIfNecessary:d,isMenuOpen:h,isActive:g,isProcessingAction:s.get,getMenu:m},t)},Ni=(e,t,n)=>hn(e,t,n).isSome(),p6=(e,t)=>{let n=null;return{cancel:()=>{null!==n&&(clearTimeout(n),n=null)},schedule:(...s)=>{n=setTimeout(()=>{e.apply(null,s),n=null},t)}}},g6=t=>{const n=t.raw;return void 0===n.touches||1!==n.touches.length?e.none():e.some(n.touches[0])},Vb=(t,n)=>{const s={stopBackspace:!0,...n},o=(t=>{const n=q(),o=v(!1),s=p6(e=>{t.triggerEvent(W9(),e),o.set(!0)},400),i=xo([{key:Nn(),value:t=>(g6(t).each(e=>{s.cancel();const i={x:e.clientX,y:e.clientY,target:t.target};s.schedule(t),o.set(!1),n.set(i)}),e.none())},{key:ta(),value:t=>(s.cancel(),g6(t).each(e=>{n.on(t=>{((e,t)=>{const n=Math.abs(e.clientX-t.x),s=Math.abs(e.clientY-t.y);return n>5||s>5})(e,t)&&n.clear()})}),e.none())},{key:Ji(),value:e=>(s.cancel(),n.get().filter(t=>G(t.target,e.target)).map(n=>o.get()?(e.prevent(),!1):t.triggerEvent(xi(),e)))}]);return{fireIfReady:(e,t)=>f(i,t).bind(t=>t(e))}})(s),c=a(["touchstart","touchmove","touchend","touchcancel","gesturestart","mousedown","mouseup","mouseover","mousemove","mouseout","click"].concat(["selectstart","input","contextmenu","change","transitionend","transitioncancel","drag","dragstart","dragend","dragenter","dragleave","dragover","drop","keyup"]),e=>Ke(t,e,t=>{o.fireIfReady(t,e).each(e=>{e&&t.kill()}),s.triggerEvent(e,t)&&t.kill()})),i=q(),l=Ke(t,"paste",e=>{o.fireIfReady(e,"paste").each(t=>{t&&e.kill()}),s.triggerEvent("paste",e)&&e.kill(),i.set(setTimeout(()=>{s.triggerEvent(fu(),e)},0))}),d=Ke(t,"keydown",e=>{s.triggerEvent("keydown",e)?e.kill():s.stopBackspace&&(e=>e.raw.which===_w[0]&&!_e(["input","textarea"],qn(e.target))&&!Ni(e.target,'[contenteditable="true"]'))(e)&&e.prevent()}),u=Ke(t,"focusin",e=>{s.triggerEvent("focusin",e)&&e.kill()}),r=q(),m=Ke(t,"focusout",e=>{s.triggerEvent("focusout",e)&&e.kill(),r.set(setTimeout(()=>{s.triggerEvent(mu(),e)},0))});return{unbind:()=>{h(c,e=>{e.unbind()}),d.unbind(),u.unbind(),m.unbind(),l.unbind(),i.on(clearTimeout),r.on(clearTimeout)}}},b6=(e,t)=>{const n=f(e,"target").getOr(t);return v(n)},fi=Ft([{stopped:[]},{resume:["element"]},{complete:[]}]),y6=(e,t,n,s,o,i)=>{const r=e(t,s),a=((e,t)=>{const n=v(!1),s=v(!1);return{stop:()=>{n.set(!0)},cut:()=>{s.set(!0)},isStopped:n.get,isCut:s.get,event:e,setSource:t.set,getSource:t.get}})(n,o);return r.fold(()=>(i.logEventNoHandlers(t,s),fi.complete()),e=>{const n=e.descHandler;return g1(n)(a),a.isStopped()?(i.logEventStopped(t,e.element,n.purpose),fi.stopped()):a.isCut()?(i.logEventCut(t,e.element,n.purpose),fi.complete()):Cn(e.element).fold(()=>(i.logNoParent(t,e.element,n.purpose),fi.complete()),s=>(i.logEventResponse(t,e.element,n.purpose),fi.resume(s)))})},_6=(e,t,n,s,o,i)=>y6(e,t,n,s,o,i).fold(Oe,s=>_6(e,t,n,s,o,i),U),w6=(e,t,n,s,o)=>{const i=b6(n,s);return _6(e,t,n,s,i,o)},Bb=()=>{const t=(()=>{const e={};return{registerId:(t,n,s)=>{Re(s,(s,o)=>{const i=void 0!==e[o]?e[o]:{};i[n]=((e,t)=>({cHandler:Nt.apply(void 0,[e.handler].concat(t)),purpose:e.purpose}))(s,t),e[o]=i})},unregisterId:t=>{Re(e,(e)=>{R(e,t)&&delete e[t]})},filterByType:t=>f(e,t).map(e=>Kr(e,(e,t)=>((e,t)=>({id:e,descHandler:t}))(t,e))).getOr([]),find:(t,n,s)=>f(e,n).bind(e=>Qd(s,t=>((e,t)=>aa(t).bind(t=>f(e,t)).map(e=>((e,t)=>({element:e,descHandler:t}))(t,e)))(e,t),t))}})(),e={},n=n=>{aa(n.element).each(n=>{delete e[n],t.unregisterId(n)})};return{find:(e,n,s)=>t.find(e,n,s),filter:e=>t.filterByType(e),register:s=>{const o=(e=>{const t=e.element;return aa(t).getOrThunk(()=>((e,t)=>{const n=d(fy+"uid-");return l1(t,n),n})(0,e.element))})(s);Gt(e,o)&&((t,s)=>{const o=e[s];if(o!==t)throw new Error('The tagId "'+s+'" is already used by: '+xs(o.element)+`
Cannot use it for: `+xs(t.element)+`
The conflicting element is`+(Xt(o.element)?" ":" not ")+"already in the DOM");n(t)})(s,o);const i=[s];t.registerId(i,o,s.events),e[o]=s},unregister:n,getById:t=>f(e,t)}},tn=pt({name:"Container",factory:e=>{const{attributes:t,...n}=e.dom;return{uid:e.uid,dom:{tag:"div",attributes:{role:"presentation",...t},...n},components:e.components,behaviours:iu(e.containerBehaviours),events:e.events,domModification:e.domModification,eventOrder:e.eventOrder}},configFields:[t("components",[]),fe("containerBehaviours",[]),t("events",{}),t("domModification",{}),t("eventOrder",{})]}),C6=e=>{const b=t=>Cn(e.element).fold(Oe,e=>G(t,e)),t=Bb(),i=(e,n)=>t.find(b,e,n),j=Vb(e.element,{triggerEvent:(e,t)=>o4(e,t.target,n=>((e,t,n,s)=>w6(e,t,n,n.target,s))(i,e,t,n))}),r={debugInfo:n("real"),triggerEvent:(e,t,n)=>{o4(e,t,s=>w6(i,e,n,t,s))},triggerFocus:(e,t)=>{aa(e).fold(()=>{Xn(e)},n=>{o4(rs(),e,n=>(((e,t,n,s,o)=>{const i=b6(n,s);y6(e,t,n,s,i,o)})(i,rs(),{originator:t,kill:c,prevent:c,target:e},e,n),!1))})},triggerEscape:(e,t)=>{r.triggerEvent("keydown",e.element,t.event)},getByUid:e=>a(e),getByDom:e=>g(e),build:qe,buildOrPatch:T1,addToGui:e=>{d(e)},removeFromGui:e=>{u(e)},addToWorld:e=>{s(e)},removeFromWorld:e=>{o(e)},broadcast:e=>{m(e)},broadcastOn:(e,t)=>{f(e,t)},broadcastEvent:(e,t)=>{p(e,t)},isConnected:Oe},s=e=>{e.connect(r),to(e.element)||(t.register(e),h(e.components(),s),r.triggerEvent(Ic(),e.element,{target:e.element}))},o=e=>{to(e.element)||(h(e.components(),o),t.unregister(e)),e.disconnect()},d=t=>{Ys(e,t)},u=e=>{Un(e)},l=e=>{const n=t.filter(Ns());h(n,t=>{const n=t.descHandler;g1(n)(e)})},m=e=>{l({universal:!0,data:e})},f=(e,t)=>{l({universal:!1,channels:e,data:t})},p=(e,n)=>((e,t)=>{const s=(e=>{const t=v(!1);return{stop:()=>{t.set(!0)},cut:c,isStopped:t.get,isCut:U,event:e,setSource:Pd("Cannot set source of a broadcasted event"),getSource:Pd("Cannot get source of a broadcasted event")}})(t);return h(e,e=>{const t=e.descHandler;g1(t)(s)}),s.isStopped()})(t.filter(e),n),a=e=>t.getById(e).fold(()=>x.error(new Error('Could not find component with uid: "'+e+'" in system.')),x.value),g=e=>{const t=aa(e).getOr("not found");return a(t)};return s(e),{root:e,element:e.element,destroy:()=>{j.unbind(),Ln(e.element)},add:d,remove:u,getByUid:a,getByDom:g,addToWorld:s,removeFromWorld:o,broadcast:m,broadcastOn:f,broadcastEvent:p}},Ib=n([t("prefix","form-field"),fe("fieldBehaviours",[O,r])]),Hb=n([wt({schema:[s("dom")],name:"label"}),wt({factory:{sketch:e=>({uid:e.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:e.text}})},schema:[s("text")],name:"aria-descriptor"}),Fe({factory:{sketch:e=>{const t=((e,t)=>{const n={};return Re(e,(e,s)=>{_e(t,s)||(n[s]=e)}),n})(e,["factory"]);return e.factory.sketch(t)}},schema:[s("factory")],name:"field"})]),M=Be({name:"FormField",configFields:Ib(),partFields:Hb(),factory:(e,t)=>{const o=ye(e.fieldBehaviours,[O.config({find:t=>P(t,e,"field")}),r.config({store:{mode:"manual",getValue:e=>O.getCurrent(e).bind(r.getValue),setValue:(e,t)=>{O.getCurrent(e).each(e=>{r.setValue(e,t)})}}})]),i=$([Q((t)=>{const s=bf(t,e,["label","field","aria-descriptor"]);s.field().each(t=>{const n=d(e.prefix);s.label().each(e=>{_(e.element,"for",n),_(t.element,"id",n)}),s["aria-descriptor"]().each(n=>{const s=d(e.prefix);_(n.element,"id",s),_(t.element,"aria-describedby",s)})})})]),a={getField:t=>P(t,e,"field"),getLabel:t=>P(t,e,"label")};return{uid:e.uid,dom:e.dom,components:t,behaviours:o,events:i,apis:a}},apis:{getField:(e,t)=>e.getField(t),getLabel:(e,t)=>e.getLabel(t)}});S6=Object.freeze({__proto__:null,exhibit:(e,t)=>Zt({attributes:xo([{key:t.tabAttr,value:"true"}])})}),M6=[t("tabAttr","data-alloy-tabstop")];const Z=we({fields:M6,name:"tabstopping",active:S6});T6=tinymce.util.Tools.resolve("tinymce.html.Entities");const Ti=(e,t,n,s)=>{const o=Nb(e,t,n,s);return M.sketch(o)},Nb=(e,t,n,s)=>({dom:N6(n),components:e.toArray().concat([t]),fieldBehaviours:i(s)}),N6=e=>({tag:"div",classes:["tox-form__group"].concat(e)}),ds=(e,t)=>M.parts.label({dom:{tag:"label",classes:["tox-label"]},components:[be(t.translate(e))]}),tt=d("form-component-change"),Si=d("form-close"),vo=d("form-cancel"),Kn=d("form-action"),Ci=d("form-submit"),Eu=d("form-block"),Cu=d("form-unblock"),W6=d("form-tabchange"),U6=d("form-resize"),Eb=["input","textarea"],q6=e=>{const t=qn(e);return _e(Eb,t)},Y6=(e,t)=>{const n=t.getRoot(e).getOr(e.element);ie(n,t.invalidClass),t.notify.each(t=>{q6(e.element)&&_(e.element,"aria-invalid",!1),t.getContainer(e).each(e=>{Ro(e,t.validHtml)}),t.onValid(e)})},G6=(e,t,n,s)=>{const o=t.getRoot(e).getOr(e.element);me(o,t.invalidClass),t.notify.each(t=>{q6(e.element)&&_(e.element,"aria-invalid",!0),t.getContainer(e).each(e=>{Ro(e,s)}),t.onInvalid(e,s)})},X6=(e,t)=>t.validator.fold(()=>Yn(x.value(!0)),t=>t.validate(e)),xu=(e,t)=>(t.notify.each(t=>{t.onValidate(e)}),X6(e,t).map(n=>e.getSystem().isConnected()?n.fold(n=>(G6(e,t,0,n),x.error(n)),n=>(Y6(e,t),x.value(n))):x.error("No longer in system")));var yb=Object.freeze({__proto__:null,markValid:Y6,markInvalid:G6,query:X6,run:xu,isInvalid:(e,t)=>{const n=t.getRoot(e).getOr(e.element);return mt(n,t.invalidClass)}}),jb=Object.freeze({__proto__:null,events:(e)=>e.validator.map(t=>$([o(t.onEvent,t=>{xu(t,e).get(z)})].concat(t.validateOnLoad?[Q(t=>{xu(t,e).get(c)})]:[]))).getOr({})}),bb=[s("invalidClass"),t("getRoot",e.none),bt("notify",[t("aria","alert"),t("getContainer",e.none),t("validHtml",""),C("onValid"),C("onInvalid"),C("onValidate")]),bt("validator",[s("validate"),t("onEvent","input"),t("validateOnLoad",!0)])];const Mn=we({fields:bb,name:"invalidating",active:jb,apis:yb,extra:{validation:e=>t=>{const n=r.getValue(t);return Yn(e(n))}}}),Oi=we({fields:[],name:"unselecting",active:Object.freeze({__proto__:null,events:()=>$([z6(I9(),Oe)]),exhibit:()=>Zt({styles:{"-webkit-user-select":"none","user-select":"none","-ms-user-select":"none","-moz-user-select":"-moz-none"},attributes:{unselectable:"on"}})})}),sp=d("color-input-change"),op=d("color-swatch-change"),ip=d("color-picker-cancel"),vb=wt({schema:[s("dom")],name:"label"}),fs=e=>wt({name:e+"-edge",overrides:t=>t.model.manager.edgeActions[e].fold(()=>({}),e=>({events:$([Su(Nn(),(t,n,s)=>e(t,s),[t]),Su(It(),(t,n,s)=>e(t,s),[t]),Su(Rr(),(t,n,s)=>{s.mouseIsDown.get()&&e(t,s)},[t])])}))}),gb=fs("top-left"),pb=fs("top"),mb=fs("top-right"),hb=fs("right"),db=fs("bottom-right"),lb=fs("bottom"),cb=fs("bottom-left");pp=[vb,fs("left"),hb,pb,lb,gb,mb,cb,db,Fe({name:"thumb",defaults:n({dom:{styles:{position:"absolute"}}}),overrides:e=>({events:$([Yo(Nn(),e,"spectrum"),Yo(ta(),e,"spectrum"),Yo(Ji(),e,"spectrum"),Yo(It(),e,"spectrum"),Yo(Rr(),e,"spectrum"),Yo(ou(),e,"spectrum")])})}),Fe({schema:[We("mouseIsDown",()=>v(!1))],name:"spectrum",overrides:e=>{const t=e.model.manager,n=(n,s)=>t.getValueFromEvent(s).map(s=>t.setValueFrom(n,e,s));return{behaviours:i([u.config({mode:"special",onLeft:n=>t.onLeft(n,e),onRight:n=>t.onRight(n,e),onUp:n=>t.onUp(n,e),onDown:n=>t.onDown(n,e)}),b.config({})]),events:$([o(Nn(),n),o(ta(),n),o(It(),n),o(Rr(),(t,s)=>{e.mouseIsDown.get()&&n(t,s)})])}}})];const _i=n("slider.change.value"),wu=t=>{const n=t.event.raw;if((e=>-1!==e.type.indexOf("touch"))(n)){const t=n;return void 0!==t.touches&&1===t.touches.length?e.some(t.touches[0]).map(e=>ee(e.clientX,e.clientY)):e.none()}{const t=n;return void 0!==t.clientX?e.some(t).map(e=>ee(e.clientX,e.clientY)):e.none()}},po=e=>e.model.minX,go=e=>e.model.minY,Lc=e=>e.model.minX-1,qc=e=>e.model.minY-1,qs=e=>e.model.maxX,Rs=e=>e.model.maxY,Nc=e=>e.model.maxX+1,Fc=e=>e.model.maxY+1,w4=(e,t,n)=>t(e)-n(e),gu=e=>w4(e,qs,po),pu=e=>w4(e,Rs,go),Sp=e=>gu(e)/2,Mp=e=>pu(e)/2,oi=e=>e.stepSize,Tp=e=>e.snapToGrid,zp=e=>e.snapStart,Dp=e=>e.rounded,Sc=(e,t)=>void 0!==e[t+"-edge"],Lp=e=>Sc(e,"left"),Rp=e=>Sc(e,"right"),Pp=e=>Sc(e,"top"),Hp=e=>Sc(e,"bottom"),es=e=>e.model.value.get(),cs=(e,t)=>({x:e,y:t}),Yt=(e,t)=>{p(e,_i(),{value:t})},hu=(e,t,n,s)=>e<t?e:e>n?n:e===t?t-1:Math.max(t,e-s),du=(e,t,n,s)=>e>n?e:e<t?t:e===n?n+1:Math.min(n,e+s),Up=(e,t,n)=>Math.max(t,Math.min(n,e)),Kp=e=>{const{min:t,max:n,range:p,value:s,step:f,snap:h,snapStart:c,rounded:u,hasMinEdge:l,hasMaxEdge:d,minBound:o,maxBound:r,screenRange:m}=e,a=l?t-1:t,i=d?n+1:n;if(s<o)return a;if(s>r)return i;{const l=((e,t,n)=>Math.min(n,Math.max(e,t))-t)(s,o,r),e=Up(l/m*p+t,a,i);return h&&e>=t&&e<=n?((e,t,n,s,o)=>o.fold(()=>{const o=e-t,i=Math.round(o/s)*s;return Up(t+i,t-1,n+1)},t=>{const o=(e-t)%s,i=Math.round(o/s),a=Math.floor((e-t)/s),r=Math.floor((n-t)/s),c=t+Math.min(r,a+i)*s;return Math.max(t,c)}))(e,t,n,f,c):u?Math.round(e):e}},qp=e=>{const{min:n,max:s,range:o,value:t,hasMinEdge:i,hasMaxEdge:a,maxBound:r,maxOffset:c,centerMinEdge:l,centerMaxEdge:d}=e;return t<n?i?0:l:t>s?a?r:d:(t-n)/o*c},lu="top",Gp="right",Xp="bottom",cu="left",xn=e=>e.element.dom.getBoundingClientRect(),qt=(e,t)=>e[t],oc=e=>{const t=xn(e);return qt(t,cu)},tg=e=>{const t=xn(e);return qt(t,Gp)},Gr=e=>{const t=xn(e);return qt(t,lu)},sg=e=>{const t=xn(e);return qt(t,Xp)},og=e=>{const t=xn(e);return qt(t,"width")},ig=e=>{const t=xn(e);return qt(t,"height")},ag=(e,t,n)=>(e+t)/2-n,rg=(e,t)=>{const n=xn(e),s=xn(t),o=qt(n,cu),i=qt(n,Gp),a=qt(s,cu);return ag(o,i,a)},cg=(e,t)=>{const n=xn(e),s=xn(t),o=qt(n,lu),i=qt(n,Xp),a=qt(s,lu);return ag(o,i,a)},Ur=(e,t)=>{p(e,_i(),{value:t})},ru=(e,t,n)=>{const s={min:po(t),max:qs(t),range:gu(t),value:n,step:oi(t),snap:Tp(t),snapStart:zp(t),rounded:Dp(t),hasMinEdge:Lp(t),hasMaxEdge:Rp(t),minBound:oc(e),maxBound:tg(e),screenRange:og(e)};return Kp(s)},ug=t=>(n,s)=>((t,n,s)=>{const o=(t>0?du:hu)(es(s),po(s),qs(s),oi(s));return Ur(n,o),e.some(o)})(t,n,s).map(Oe),au=(t,n,s,o,i,a)=>{const r=((t,n,s,o,i)=>{const a=og(t),r=o.bind(n=>e.some(rg(n,t))).getOr(0),c=i.bind(n=>e.some(rg(n,t))).getOr(a),l={min:po(n),max:qs(n),range:gu(n),value:s,hasMinEdge:Lp(n),hasMaxEdge:Rp(n),minBound:oc(t),minOffset:0,maxBound:tg(t),maxOffset:a,centerMinEdge:r,centerMaxEdge:c};return qp(l)})(n,a,s,o,i);return oc(n)-oc(t)+r},x9=ug(-1),w9=ug(1),_9=e.none,y9=e.none,j9={"top-left":e.none(),top:e.none(),"top-right":e.none(),right:e.some((e,t)=>{Yt(e,Nc(t))}),"bottom-right":e.none(),bottom:e.none(),"bottom-left":e.none(),left:e.some((e,t)=>{Yt(e,Lc(t))})};bg=Object.freeze({__proto__:null,setValueFrom:(e,t,n)=>{const s=ru(e,t,n);return Ur(e,s),s},setToMin:(e,t)=>{const n=po(t);Ur(e,n)},setToMax:(e,t)=>{const n=qs(t);Ur(e,n)},findValueOfOffset:ru,getValueFromEvent:e=>wu(e).map(e=>e.left),findPositionOfValue:au,setPositionFromValue:(e,t,n,s)=>{const o=es(n),i=au(e,s.getSpectrum(e),o,s.getLeftEdge(e),s.getRightEdge(e),n),a=et(t.element)/2;y(t.element,"left",i-a+"px")},onLeft:x9,onRight:w9,onUp:_9,onDown:y9,edgeActions:j9});const Wr=(e,t)=>{p(e,_i(),{value:t})},su=(e,t,n)=>{const s={min:go(t),max:Rs(t),range:pu(t),value:n,step:oi(t),snap:Tp(t),snapStart:zp(t),rounded:Dp(t),hasMinEdge:Pp(t),hasMaxEdge:Hp(t),minBound:Gr(e),maxBound:sg(e),screenRange:ig(e)};return Kp(s)},_g=t=>(n,s)=>((t,n,s)=>{const o=(t>0?du:hu)(es(s),go(s),Rs(s),oi(s));return Wr(n,o),e.some(o)})(t,n,s).map(Oe),nu=(t,n,s,o,i,a)=>{const r=((t,n,s,o,i)=>{const a=ig(t),r=o.bind(n=>e.some(cg(n,t))).getOr(0),c=i.bind(n=>e.some(cg(n,t))).getOr(a),l={min:go(n),max:Rs(n),range:pu(n),value:s,hasMinEdge:Pp(n),hasMaxEdge:Hp(n),minBound:Gr(t),minOffset:0,maxBound:sg(t),maxOffset:a,centerMinEdge:r,centerMaxEdge:c};return qp(l)})(n,a,s,o,i);return Gr(n)-Gr(t)+r},v9=e.none,m9=e.none,h9=_g(-1),u9=_g(1),d9={"top-left":e.none(),top:e.some((e,t)=>{Yt(e,qc(t))}),"top-right":e.none(),right:e.none(),"bottom-right":e.none(),bottom:e.some((e,t)=>{Yt(e,Fc(t))}),"bottom-left":e.none(),left:e.none()};Ag=Object.freeze({__proto__:null,setValueFrom:(e,t,n)=>{const s=su(e,t,n);return Wr(e,s),s},setToMin:(e,t)=>{const n=go(t);Wr(e,n)},setToMax:(e,t)=>{const n=Rs(t);Wr(e,n)},findValueOfOffset:su,getValueFromEvent:e=>wu(e).map(e=>e.top),findPositionOfValue:nu,setPositionFromValue:(e,t,n,s)=>{const o=es(n),i=nu(e,s.getSpectrum(e),o,s.getTopEdge(e),s.getBottomEdge(e),n),a=Pe(t.element)/2;y(t.element,"top",i-a+"px")},onLeft:v9,onRight:m9,onUp:h9,onDown:u9,edgeActions:d9});const Ir=(e,t)=>{p(e,_i(),{value:t})},Mr=(e,t)=>({x:e,y:t}),kr=(t,n)=>(s,o)=>((t,n,s,o)=>{const i=t>0?du:hu,a=n?es(o).x:i(es(o).x,po(o),qs(o),oi(o)),r=n?i(es(o).y,go(o),Rs(o),oi(o)):es(o).y;return Ir(s,Mr(a,r)),e.some(a)})(t,n,s,o).map(Oe),r9=kr(-1,!1),a9=kr(1,!1),i9=kr(-1,!0),n9=kr(1,!0),t9={"top-left":e.some((e,t)=>{Yt(e,cs(Lc(t),qc(t)))}),top:e.some((e,t)=>{Yt(e,cs(Sp(t),qc(t)))}),"top-right":e.some((e,t)=>{Yt(e,cs(Nc(t),qc(t)))}),right:e.some((e,t)=>{Yt(e,cs(Nc(t),Mp(t)))}),"bottom-right":e.some((e,t)=>{Yt(e,cs(Nc(t),Fc(t)))}),bottom:e.some((e,t)=>{Yt(e,cs(Sp(t),Fc(t)))}),"bottom-left":e.some((e,t)=>{Yt(e,cs(Lc(t),Fc(t)))}),left:e.some((e,t)=>{Yt(e,cs(Lc(t),Mp(t)))})};Rg=Object.freeze({__proto__:null,setValueFrom:(e,t,n)=>{const o=ru(e,t,n.left),i=su(e,t,n.top),s=Mr(o,i);return Ir(e,s),s},setToMin:(e,t)=>{const n=po(t),s=go(t);Ir(e,Mr(n,s))},setToMax:(e,t)=>{const n=qs(t),s=Rs(t);Ir(e,Mr(n,s))},getValueFromEvent:e=>wu(e),setPositionFromValue:(e,t,n,s)=>{const o=es(n),i=au(e,s.getSpectrum(e),o.x,s.getLeftEdge(e),s.getRightEdge(e),n),a=nu(e,s.getSpectrum(e),o.y,s.getTopEdge(e),s.getBottomEdge(e),n),r=et(t.element)/2,c=Pe(t.element)/2;y(t.element,"left",i-r+"px"),y(t.element,"top",a-c+"px")},onLeft:r9,onRight:a9,onUp:i9,onDown:n9,edgeActions:t9});const Bt=Be({name:"Slider",configFields:[t("stepSize",1),t("onChange",c),t("onChoose",c),t("onInit",c),t("onDragStart",c),t("onDragEnd",c),t("snapToGrid",!1),t("rounded",!0),D("snapStart"),vt("model",lt("mode",{x:[t("minX",0),t("maxX",100),We("value",e=>v(e.mode.minX)),s("getInitialValue"),W("manager",bg)],y:[t("minY",0),t("maxY",100),We("value",e=>v(e.mode.minY)),s("getInitialValue"),W("manager",Ag)],xy:[t("minX",0),t("maxX",100),t("minY",0),t("maxY",100),We("value",e=>v({x:e.mode.minX,y:e.mode.minY})),s("getInitialValue"),W("manager",Rg)]})),fe("sliderBehaviours",[u,r]),We("mouseIsDown",()=>v(!1))],partFields:pp,factory:(t,n)=>{const c=e=>kn(e,t,"thumb"),m=e=>kn(e,t,"spectrum"),y=e=>P(e,t,"left-edge"),v=e=>P(e,t,"right-edge"),b=e=>P(e,t,"top-edge"),j=e=>P(e,t,"bottom-edge"),a=t.model,d=a.manager,h=(e,n)=>{d.setPositionFromValue(e,n,t,{getLeftEdge:y,getRightEdge:v,getTopEdge:b,getBottomEdge:j,getSpectrum:m})},l=(e,t)=>{a.value.set(t);const n=c(e);h(e,n)},f=e=>{const n=t.mouseIsDown.get();t.mouseIsDown.set(!1),n&&P(e,t,"thumb").each(n=>{const s=a.value.get();t.onChoose(e,n,s)})},p=(e,n)=>{n.stop(),t.mouseIsDown.set(!0),t.onDragStart(e,c(e))},g=(e,n)=>{n.stop(),t.onDragEnd(e,c(e)),f(e)};return{uid:t.uid,dom:t.dom,components:n,behaviours:ye(t.sliderBehaviours,[u.config({mode:"special",focusIn:e=>P(e,t,"spectrum").map(u.focusIn).map(Oe)}),r.config({store:{mode:"manual",getValue:e=>a.value.get(),setValue:l}}),Vt.config({channels:{[Id()]:{onReceive:f}}})]),events:$([o(_i(),(n,s)=>{((n,s)=>{l(n,s);const o=c(n);t.onChange(n,o,s),e.some(!0)})(n,s.event.value)}),Q((e)=>{const o=a.getInitialValue();a.value.set(o);const s=c(e);h(e,s);const i=m(e);t.onInit(e,s,i,a.value.get())}),o(Nn(),p),o(Ji(),g),o(It(),p),o(ou(),g)]),apis:{resetToMin:e=>{d.setToMin(e,t)},resetToMax:e=>{d.setToMax(e,t)},setValue:l,refresh:h},domModification:{styles:{position:"relative"}}}},apis:{setValue:(e,t,n)=>{e.setValue(t,n)},resetToMin:(e,t)=>{e.resetToMin(t)},resetToMax:(e,t)=>{e.resetToMax(t)},refresh:(e,t)=>{e.refresh(t)}}}),eu=d("rgb-hex-update"),Ig=d("slider-update"),Bg=d("palette-update"),Vg="form",Jv=[fe("formBehaviours",[r])],Wg=e=>"<alloy.field."+e+">",Zv=(e,t)=>({uid:e.uid,dom:e.dom,components:t,behaviours:ye(e.formBehaviours,[r.config({store:{mode:"manual",getValue:t=>{const n=df(t,e);return je(n,(e,t)=>e().bind(e=>{return n=O.getCurrent(e),s=new Error(`Cannot find a current component to extract the value from for form part '${t}': `+xs(e.element)),n.fold(()=>x.error(s),x.value);var n,s}).map(r.getValue))},setValue:(t,n)=>{Re(n,(n,s)=>{P(t,e,s).each(e=>{O.getCurrent(e).each(e=>{r.setValue(e,n)})})})}}})]),apis:{getField:(t,n)=>P(t,e,n).bind(O.getCurrent)}}),Fo={getField:or((e,t,n)=>e.getField(t,n)),sketch:e=>{const t=(()=>{const e=[];return{field:(t,n)=>(e.push(t),Iu(Vg,Wg(t),n)),record:n(e)}})(),s=e(t),o=t.record(),i=a(o,e=>Fe({name:e,pname:Wg(e)}));return t1(Vg,Jv,i,Zv,s)}},qg=d("valid-input"),Yg=d("invalid-input"),Gg=d("validating-input"),Xg="colorcustom.rgb.",Yv=(t,n,s,a)=>{const m=(e,s)=>Mn.config({invalidClass:n("invalid"),notify:{onValidate:t=>{p(t,Gg,{type:e})},onValid:t=>{p(t,qg,{type:e,value:r.getValue(t)})},onInvalid:t=>{p(t,Yg,{type:e,value:r.getValue(t)})}},validator:{validate:e=>{const n=r.getValue(e),o=s(n)?x.value(!0):x.error(t("aria.input.invalid"));return Yn(o)},validateOnLoad:!1}}),l=(e,s,o,a,r)=>{const l=t("colorcustom.rgb.range"),d=M.parts.label({dom:{tag:"label",attributes:{"aria-label":a}},components:[be(o)]}),u=M.parts.field({data:r,factory:Io,inputAttributes:{type:"text",..."hex"===s?{"aria-live":"polite"}:{}},inputClasses:[n("textfield")],inputBehaviours:i([m(s,e),Z.config({})]),onSetValue:e=>{Mn.isInvalid(e)&&Mn.run(e).get(c)}}),h=[d,u],f="hex"!==s?[M.parts["aria-descriptor"]({text:l})]:[];return{dom:{tag:"div",attributes:{role:"presentation"}},components:h.concat(f)}},u=(e,t)=>{const n=t.red,s=t.green,o=t.blue;r.setValue(e,{red:n,green:s,blue:o})},h=V({dom:{tag:"div",classes:[n("rgba-preview")],styles:{"background-color":"white"},attributes:{role:"presentation"}}}),d=(e,t)=>{h.getOpt(e).each(e=>{y(e.element,"background-color","#"+t.value)})},f=pt({factory:()=>{const g={red:v(e.some(255)),green:v(e.some(255)),blue:v(e.some(255)),hex:v(e.some("ffffff"))},f=e=>g[e].get(),c=(e,t)=>{g[e].set(t)},j=t=>{const n=t.red,s=t.green,o=t.blue;c("red",e.some(n)),c("green",e.some(s)),c("blue",e.some(o))},y=(t,n)=>{const s=n.event;"hex"!==s.type?c(s.type,e.none()):a(t)},E=(t,n)=>{const o=n.event;(e=>"hex"===e.type)(o)?((t,n)=>{s(t);const o=k8(n);c("hex",e.some(n));const i=ea(o);u(t,i),j(i),p(t,eu,{hex:o}),d(t,o)})(t,o.value):((t,n,s)=>{const o=parseInt(s,10);c(n,e.some(o)),f("red").bind(e=>f("green").bind(t=>f("blue").map(n=>ps(e,t,n,1)))).each(e=>{const n=((e,t)=>{const n=sa(t);return Fo.getField(e,"hex").each(t=>{b.isFocused(t)||r.setValue(e,{hex:n.value})}),n})(t,e);p(t,eu,{hex:n}),d(t,n)})})(t,o.type,o.value)},m=e=>({label:t(Xg+e+".label"),description:t(Xg+e+".description")}),_=m("red"),O=m("green"),x=m("blue"),C=m("hex");return te(Fo.sketch(e=>({dom:{tag:"form",classes:[n("rgb-form")],attributes:{"aria-label":t("aria.color.picker")}},components:[e.field("red",M.sketch(l(o1,"red",_.label,_.description,255))),e.field("green",M.sketch(l(o1,"green",O.label,O.description,255))),e.field("blue",M.sketch(l(o1,"blue",x.label,x.description,255))),e.field("hex",M.sketch(l(M8,"hex",C.label,C.description,"ffffff"))),h.asSpec()],formBehaviours:i([Mn.config({invalidClass:n("form-invalid")}),w("rgb-form-events",[o(qg,E),o(Yg,y),o(Gg,y)])])})),{apis:{updateHex:(e,t)=>{r.setValue(e,{hex:t.value}),((e,t)=>{const n=ea(t);u(e,n),j(n)})(e,t),d(e,t)}}})},name:"RgbForm",configFields:[],apis:{updateHex:(e,t,n)=>{e.updateHex(t,n)}},extraApis:{}});return f},Kv=(a,r)=>{const l=pt({name:"ColourPicker",configFields:[s("dom"),t("onValidHex",c),t("onInvalidHex",c)],factory:t=>{const f=Yv(a,r,t.onValidHex,t.onInvalidHex),c=((t,s)=>{const a=Bt.parts.spectrum({dom:{tag:"canvas",attributes:{role:"presentation"},classes:[s("sv-palette-spectrum")]}}),r=Bt.parts.thumb({dom:{tag:"div",attributes:{role:"presentation"},classes:[s("sv-palette-thumb")],innerHtml:`<div class=${s("sv-palette-inner-thumb")} role="presentation"></div>`}}),o=(e,t)=>{const{width:s,height:o}=e,n=e.getContext("2d");if(null===n)return;n.fillStyle=t,n.fillRect(0,0,s,o);const i=n.createLinearGradient(0,0,s,0);i.addColorStop(0,"rgba(255,255,255,1)"),i.addColorStop(1,"rgba(255,255,255,0)"),n.fillStyle=i,n.fillRect(0,0,s,o);const a=n.createLinearGradient(0,0,0,o);a.addColorStop(0,"rgba(0,0,0,0)"),a.addColorStop(1,"rgba(0,0,0,1)"),n.fillStyle=a,n.fillRect(0,0,s,o)};return pt({factory:t=>{const c=n({x:0,y:0}),l=i([O.config({find:e.some}),b.config({})]);return Bt.sketch({dom:{tag:"div",attributes:{role:"presentation"},classes:[s("sv-palette")]},model:{mode:"xy",getInitialValue:c},rounded:!1,components:[a,r],onChange:(e,t,n)=>{p(e,Bg,{value:n})},onInit:(e,t,n)=>{o(n.element.dom,U8(K8))},sliderBehaviours:l})},name:"SaturationBrightnessPalette",configFields:[],apis:{setHue:(e,t,n)=>{((e,t)=>{const n=e.components()[0].element.dom,s=Zi(t,100,100),i=B8(s);o(n,U8(i))})(t,n)},setThumb:(e,t,n)=>{((e,t)=>{const n=e1(ea(t));Bt.setValue(e,{x:n.saturation,y:100-n.value})})(t,n)}},extraApis:{}})})(0,r),s={paletteRgba:v(K8),paletteHue:v(0)},g=V(((e,t)=>{const s=Bt.parts.spectrum({dom:{tag:"div",classes:[t("hue-slider-spectrum")],attributes:{role:"presentation"}}}),o=Bt.parts.thumb({dom:{tag:"div",classes:[t("hue-slider-thumb")],attributes:{role:"presentation"}}});return Bt.sketch({dom:{tag:"div",classes:[t("hue-slider")],attributes:{role:"presentation"}},rounded:!1,model:{mode:"y",getInitialValue:n(0)},components:[s,o],sliderBehaviours:i([b.config({})]),onChange:(e,t,n)=>{p(e,Ig,{value:n})}})})(0,r)),l=V(c.sketch({})),d=V(f.sketch({})),j=(e,t,n)=>{l.getOpt(e).each(e=>{c.setHue(e,n)})},y=(e,t)=>{d.getOpt(e).each(e=>{f.updateHex(e,t)})},_=(e,t,n)=>{g.getOpt(e).each(e=>{Bt.setValue(e,(e=>100-e/360*100)(n))})},x=(e,t)=>{l.getOpt(e).each(e=>{c.setThumb(e,t)})},m=(e,t,n,o)=>{((e,t)=>{const n=ea(e);s.paletteRgba.set(n),s.paletteHue.set(t)})(t,n),h(o,s=>{s(e,t,n)})};return{uid:t.uid,dom:t.dom,components:[l.asSpec(),g.asSpec(),d.asSpec()],behaviours:i([w("colour-picker-events",[o(eu,(()=>{const e=[j,_,x];return(t,n)=>{const s=n.event.hex,o=(e=>e1(ea(e)))(s);m(t,s,o.hue,e)}})()),o(Bg,(()=>{const e=[y];return(t,n)=>{const o=n.event.value,i=s.paletteHue.get(),a=Zi(i,o.x,100-o.y),r=tf(a);m(t,r,i,e)}})()),o(Ig,(()=>{const e=[j,y];return(t,n)=>{const o=(e=>(100-e)/100*360)(n.event.value),a=s.paletteRgba.get(),i=e1(a),r=Zi(o,i.saturation,i.value),c=tf(r);m(t,c,o,e)}})())]),O.config({find:e=>d.getOpt(e)}),u.config({mode:"acyclic"})])}}});return l},ms=()=>O.config({find:e.some}),Zd=e=>O.config({find:t=>Us(t.element,e).bind(e=>t.getSystem().getByDom(e).toOptional())}),Bv=m([t("preprocess",z),t("postprocess",z)]),n5=(e,t,n)=>r.config({store:{mode:"manual",...e.map(e=>({initialValue:e})).getOr({}),getValue:t,setValue:n}}),s5=(e,t,n)=>n5(e,e=>t(e.element),(e,t)=>n(e.element,t)),Iv=(e,t)=>{const n=Ge("RepresentingConfigs.memento processors",Bv,t);return r.config({store:{mode:"manual",getValue:t=>{const s=e.get(t),o=r.getValue(s);return n.postprocess(o)},setValue:(t,s)=>{const o=n.preprocess(s),i=e.get(t);r.setValue(i,o)}}})},Pv=s5,Ao=n5,gr=e=>r.config({store:{mode:"memory",initialValue:e}}),Rv={"colorcustom.rgb.red.label":"R","colorcustom.rgb.red.description":"Red component","colorcustom.rgb.green.label":"G","colorcustom.rgb.green.description":"Green component","colorcustom.rgb.blue.label":"B","colorcustom.rgb.blue.description":"Blue component","colorcustom.rgb.hex.label":"#","colorcustom.rgb.hex.description":"Hex color code","colorcustom.rgb.range":"Range 0 to 255","aria.color.picker":"Color Picker","aria.input.invalid":"Invalid input"};l5=tinymce.util.Tools.resolve("tinymce.Resource"),is=tinymce.util.Tools.resolve("tinymce.util.Tools");const Xd=d("alloy-fake-before-tabstop"),Gd=d("alloy-fake-after-tabstop"),m5=e=>({dom:{tag:"div",styles:{width:"1px",height:"1px",outline:"none"},attributes:{tabindex:"0"},classes:e},behaviours:i([b.config({ignore:!0}),Z.config({})])}),f5=e=>({dom:{tag:"div",classes:["tox-navobj"]},components:[m5([Xd]),e,m5([Gd])],behaviours:i([Zd(1)])}),p5=(e,t)=>{p(e,$i(),{raw:{which:9,shiftKey:t}})},Nv=(e,t)=>{const n=t.element;mt(n,Xd)?p5(e,!0):mt(n,Gd)&&p5(e,!1)},ra=e=>Ni(e,["."+Xd,"."+Gd].join(","),U),b5=d("toolbar.button.execute"),j5={[ut()]:["disabling","alloy.base.behaviour","toggling","toolbar-button-events"]},y5=(e,t,n)=>gn(e,{tag:"span",classes:["tox-icon","tox-tbtn__icon-wrap"],behaviours:n},t),pr=(e,t)=>y5(e,t,[]),w5=(e,t)=>y5(e,t,[j.config({})]),Yd=(e,t,n)=>({dom:{tag:"span",classes:[`${t}__select-label`]},components:[be(n.translate(e))],behaviours:i([j.config({})])}),wo=d("update-menu-text"),C5=d("update-menu-icon"),qd=(t,n,s)=>{const l=v(c),d=t.text.map(e=>V(Yd(e,n,s.providers))),h=t.icon.map(e=>V(w5(e,s.providers.icons))),m=(t,n)=>{const s=r.getValue(t);return b.focus(s),p(s,"keydown",{raw:n.event.raw}),Et.close(s),e.some(!0)},f=t.role.fold(()=>({}),e=>({role:e})),g=t.tooltip.fold(()=>({}),e=>{const t=s.providers.translate(e);return{title:t,"aria-label":t}}),y=gn("chevron-down",{tag:"div",classes:[`${n}__select-chevron`]},s.providers.icons),_=V(Et.sketch({...t.uid?{uid:t.uid}:{},...f,dom:{tag:"button",classes:[n,`${n}--select`].concat(a(t.classes,e=>`${n}--${e}`)),attributes:{...g}},components:da([h.map(e=>e.asSpec()),d.map(e=>e.asSpec()),e.some(y)]),matchWidth:!0,useMinWidth:!0,onOpen:(e,n,s)=>{t.searchable&&(e=>{Oh(e).each(e=>b.focus(e))})(s)},dropdownBehaviours:i([...t.dropdownBehaviours,Oo(()=>t.disabled||s.providers.isDisabled()),re(),Oi.config({}),j.config({}),w("dropdown-events",[na(t,l),ka(t,l)]),w("menubutton-update-display-text",[o(wo,(e,t)=>{d.bind(t=>t.getOpt(e)).each(e=>{j.set(e,[be(s.providers.translate(t.event.text))])})}),o(C5,(e,t)=>{h.bind(t=>t.getOpt(e)).each(e=>{j.set(e,[w5(t.event.icon,s.providers.icons)])})})])]),eventOrder:te(j5,{mousedown:["focusing","alloy.base.behaviour","item-type-events","normal-dropdown-events"]}),sandboxBehaviours:i([u.config({mode:"special",onLeft:m,onRight:m}),w("dropdown-sandbox-events",[o(yh,(e,t)=>{(e=>{const t=r.getValue(e),n=$a(e).map(xh);Et.refetch(t).get(()=>{const e=Y.getCoupled(t,"sandbox");n.each(t=>$a(e).each(e=>((e,t)=>{r.setValue(e,t.fetchPattern),e.element.dom.selectionStart=t.selectionStart,e.element.dom.selectionEnd=t.selectionEnd})(e,t)))})})(e),t.stop()}),o(_h,(e,t)=>{((e,t)=>{(e=>k.getState(e).bind(F.getHighlighted).bind(F.getHighlighted))(e).each(n=>{((e,t,n,s)=>{const o={...s,target:t};e.getSystem().triggerEvent(n,t,o)})(e,n.element,t.event.eventType,t.event.interactionEvent)})})(e,t),t.stop()})])]),lazySink:s.getSink,toggleClass:`${n}--active`,parts:{menu:{...Ua(0,t.columns,t.presets),fakeFocus:t.searchable,onHighlightItem:i6,onCollapseMenu:(e,t,n)=>{F.getHighlighted(n).each(t=>{i6(e,n,t)})},onDehighlightItem:nj}},fetch:e=>Fs(Nt(t.fetch,e))}));return _.asSpec()},k5=e=>"separator"===e.type,Fv={type:"separator"},S5=(e,t)=>{const n=((e,t)=>{const n=Ie(e,(e,n)=>(e=>L(e))(n)?""===n?e:"|"===n?e.length>0&&!k5(e[e.length-1])?e.concat([Fv]):e:R(t,n.toLowerCase())?e.concat([t[n.toLowerCase()]]):e:e.concat([n]),[]);return n.length>0&&k5(n[n.length-1])&&n.pop(),n})(L(e)?e.split(" "):e,t);return To(n,(e,n)=>{if((e=>R(e,"getSubmenuItems"))(n)){const o=(e=>{const t=f(e,"value").getOrThunk(()=>d("generated-menu-item"));return te({value:t},e)})(n),s=((e,t)=>{const s=e.getSubmenuItems(),n=S5(s,t);return{item:e,menus:te(n.menus,{[e.value]:n.items}),expansions:te(n.expansions,{[e.value]:e.value})}})(o,t);return{menus:te(e.menus,s.menus),items:[s.item,...e.items],expansions:te(e.expansions,s.expansions)}}return{...e,items:[n,...e.items]}},{menus:{},expansions:{},items:[]})},So=(t,n,s,o)=>{const a=d("primary-menu"),i=S5(t,s.shared.providers.menuItems());if(0===i.items.length)return e.none();const r=(e=>e.search.fold(()=>({searchMode:"no-search"}),e=>({searchMode:"search-with-field",placeholder:e.placeholder})))(o),c=u6(a,i.items,n,s,o.isHorizontalMenu,r),l=(e=>e.search.fold(()=>({searchMode:"no-search"}),e=>({searchMode:"search-with-results"})))(o),u=je(i.menus,(e,t)=>u6(t,e,n,s,!1,l)),h=te(u,jo(a,c));return e.from(Ls.tieredData(a,h,i.expansions))},$d=e=>!R(e,"items"),T5="data-value",z5=(e,t,n,s)=>a(n,n=>$d(n)?{type:"togglemenuitem",text:n.text,value:n.value,active:n.value===s,onAction:()=>{r.setValue(e,n.value),p(e,tt,{name:t}),b.focus(e)}}:{type:"nestedmenuitem",text:n.text,getSubmenuItems:()=>z5(e,t,n.items,s)}),Bd=(e,t)=>wn(e,e=>$d(e)?Li(e.value===t,e):Bd(e.items,t)),wv=pt({name:"HtmlSelect",configFields:[s("options"),fe("selectBehaviours",[b,r]),t("selectClasses",[]),t("selectAttributes",{}),D("data")],factory:(e)=>{const n=a(e.options,e=>({dom:{tag:"option",value:e.value,innerHtml:e.text}})),s=e.data.map(e=>jo("initialValue",e)).getOr({});return{uid:e.uid,dom:{tag:"select",classes:e.selectClasses,attributes:e.selectAttributes},components:n,behaviours:ye(e.selectBehaviours,[b.config({}),r.config({store:{mode:"manual",getValue:e=>Bn(e.element),setValue:(t,n)=>{ne(e.options,e=>e.value===n).isSome()&&Lo(t.element,n)},...s}})])}}}),yv=n([t("field1Name","field1"),t("field2Name","field2"),Xs("onLockedChange"),$s(["lockClass"]),t("locked",!1),si("coupledFieldBehaviours",[O,r])]),R5=(e,t)=>Fe({factory:M,name:e,overrides:e=>({fieldBehaviours:i([w("coupled-input-behaviour",[o(ao(),n=>{((e,t,n)=>P(e,t,n).bind(O.getCurrent))(n,e,t).each(t=>{P(n,e,"lock").each(s=>{A.isOn(s)&&e.onLockedChange(n,t,s)})})})])])})}),jv=n([R5("field1","field2"),R5("field2","field1"),Fe({factory:Je,schema:[s("dom")],name:"lock",overrides:e=>({buttonBehaviours:i([A.config({selected:e.locked,toggleClass:e.markers.lockClass,aria:{mode:"pressed"}})])})})]),yt=Be({name:"FormCoupledInputs",configFields:yv(),partFields:jv(),factory:(t,n)=>({uid:t.uid,dom:t.dom,components:n,behaviours:ni(t.coupledFieldBehaviours,[O.config({find:e.some}),r.config({store:{mode:"manual",getValue:e=>{const n=Xu(e,t,["field1","field2"]);return{[t.field1Name]:r.getValue(n.field1()),[t.field2Name]:r.getValue(n.field2())}},setValue:(e,n)=>{const s=Xu(e,t,["field1","field2"]);Gt(n,t.field1Name)&&r.setValue(s.field1(),n[t.field1Name]),Gt(n,t.field2Name)&&r.setValue(s.field2(),n[t.field2Name])}}})]),apis:{getField1:e=>P(e,t,"field1"),getField2:e=>P(e,t,"field2"),getLock:e=>P(e,t,"lock")}}),apis:{getField1:(e,t)=>e.getField1(t),getField2:(e,t)=>e.getField2(t),getLock:(e,t)=>e.getLock(t)}}),Rd=e=>{const t=/^\s*(\d+(?:\.\d+)?)\s*(|cm|mm|in|px|pt|pc|em|ex|ch|rem|vw|vh|vmin|vmax|%)\s*$/.exec(e);if(null!==t){const e=parseFloat(t[1]),n=t[2];return x.value({value:e,unit:n})}return x.error(e)},B5=(t,n)=>{const s={"":96,px:96,pt:72,cm:2.54,pc:12,mm:25.4,in:1},o=e=>R(s,e);return t.unit===n?e.some(t.value):o(t.unit)&&o(n)?s[t.unit]===s[n]?e.some(t.value):e.some(t.value/s[t.unit]*s[n]):e.none()},Ld=t=>e.none(),$5=(t,s)=>{const a=t.label.map(e=>ds(e,s)),c=[g.config({disabled:()=>t.disabled||s.isDisabled()}),re(),u.config({mode:"execution",useEnter:!0!==t.multiline,useControlEnter:!0===t.multiline,execute:t=>(T(t,Ci),e.some(!0))}),w("textfield-change",[o(ao(),(e)=>{p(e,tt,{name:t.name})}),o(fu(),(e)=>{p(e,tt,{name:t.name})})]),Z.config({})],l=t.validation.map(e=>Mn.config({getRoot:e=>Ki(e.element),invalidClass:"tox-invalid",validator:{validate:t=>{const n=r.getValue(t),s=e.validator(n);return Yn(!0===s?x.value(n):x.error(s))},validateOnLoad:e.validateOnLoad}})).toArray(),d={...t.placeholder.fold(n({}),e=>({placeholder:s.translate(e)})),...t.inputMode.fold(n({}),e=>({inputmode:e}))},h=M.parts.field({tag:!0===t.multiline?"textarea":"input",...t.data.map(e=>({data:e})).getOr({}),inputAttributes:d,inputClasses:[t.classname],inputBehaviours:i(Se([c,l])),selectOnFocus:!1,factory:Io}),m=(t.flex?["tox-form__group--stretched"]:[]).concat(t.maximized?["tox-form-group--maximize"]:[]),f=[g.config({disabled:()=>t.disabled||s.isDisabled(),onDisabled:e=>{M.getField(e).each(g.disable)},onEnabled:e=>{M.getField(e).each(g.enable)}}),re()];return Ti(a,h,m,f)};W5=Object.freeze({__proto__:null,events:(e,t)=>{const n=e.stream.streams.setup(e,t);return $([o(e.event,n),_n(()=>t.cancel())].concat(e.cancelEvent.map(e=>[o(e,()=>t.cancel())]).getOr([])))}});const U5=(e,t)=>{let n=null;const s=()=>{qr(n)||(clearTimeout(n),n=null)};return{cancel:s,throttle:(...o)=>{s(),n=setTimeout(()=>{n=null,e.apply(null,o)},t)}}},K5=e=>{const t=v(null);return jt({readState:()=>({timer:null!==t.get()?"set":"unset"}),setTimer:e=>{t.set(e)},cancel:()=>{const e=t.get();null!==e&&e.cancel()}})};q5=Object.freeze({__proto__:null,throttle:K5,init:e=>e.stream.streams.state(e)}),Y5=[vt("stream",lt("mode",{throttle:[s("delay"),t("stopEvent",!0),W("streams",{setup:(e,t)=>{const n=e.stream,s=U5(e.onStream,n.delay);return t.setTimer(s),(e,t)=>{s.throttle(e,t),n.stopEvent&&t.stop()}},state:K5})]})),t("event","input"),D("cancelEvent"),Xs("onStream")];const Nd=we({fields:Y5,name:"streaming",active:W5,state:q5}),Za=(e,t,n)=>{const s=r.getValue(n);r.setValue(t,s),Z5(t)},Q5=(e,t)=>{const n=e.element,s=Bn(n),o=n.dom;"number"!==Ne(n,"type")&&t(o,s)},Z5=e=>{Q5(e,(e,t)=>e.setSelectionRange(t.length,t.length))},zd=n("alloy.typeahead.itemexecute"),dv=n([D("lazySink"),s("fetch"),t("minChars",5),t("responseTime",1e3),C("onOpen"),t("getHotspot",e.some),t("getAnchorOverrides",n({})),t("layouts",e.none()),t("eventOrder",{}),Yc("model",{},[t("getDisplayText",e=>void 0!==e.meta&&void 0!==e.meta.text?e.meta.text:e.value),t("selectsOver",!0),t("populateFromBrowse",!0)]),C("onSetValue"),ot("onExecute"),C("onItemExecute"),t("inputClasses",[]),t("inputAttributes",{}),t("inputStyles",{}),t("matchWidth",!0),t("useMinWidth",!1),t("dismissOnBlur",!0),$s(["openClass"]),D("initialData"),fe("typeaheadBehaviours",[b,r,Nd,u,A,Y]),We("lazyTypeaheadComp",()=>v(e.none)),We("previewing",()=>v(!0))].concat(ph()).concat(Lu())),lv=n([Lt({schema:[jr()],name:"menu",overrides:t=>({fakeFocus:!0,onHighlightItem:(n,s,o)=>{t.previewing.get()?t.lazyTypeaheadComp.get().each(n=>{((t,n,s)=>{if(t.selectsOver){const i=r.getValue(n),o=t.getDisplayText(i),a=r.getValue(s);return 0===t.getDisplayText(a).indexOf(o)?e.some(()=>{Za(0,n,s),((e,t)=>{Q5(e,(e,n)=>e.setSelectionRange(t,n.length))})(n,o.length)}):e.none()}return e.none()})(t.model,n,o).fold(()=>{t.model.selectsOver?(F.dehighlight(s,o),t.previewing.set(!0)):t.previewing.set(!1)},e=>{e(),t.previewing.set(!1)})}):t.lazyTypeaheadComp.get().each(e=>{t.model.populateFromBrowse&&Za(t.model,e,o)})},onExecute:(e,n)=>t.lazyTypeaheadComp.get().map(e=>(p(e,zd(),{item:n}),!0)),onHover:(e,n)=>{t.previewing.set(!1),t.lazyTypeaheadComp.get().each(e=>{t.model.populateFromBrowse&&Za(t.model,e,n)})}})})]),cv=Be({name:"Typeahead",configFields:dv(),partFields:lv(),factory:(t,n,s,i)=>{const h=(e,n,s)=>{t.previewing.set(!1);const o=Y.getCoupled(e,"sandbox");if(k.isOpen(o))O.getCurrent(o).each(e=>{F.getHighlighted(e).fold(()=>{s(e)},()=>{L6(o,e.element,"keydown",n)})});else{const n=e=>{O.getCurrent(e).each(s)};Xr(t,l(e),e,o,i,n,Ue.HighlightMenuAndItem).get(c)}},f=gh(t),l=e=>t=>t.map(t=>{const n=H1(t.menus),s=le(n,e=>K(e.items,e=>"item"===e.type));return r.getState(e).update(a(s,e=>e.data)),t}),d=e=>O.getCurrent(e),m="typeaheadevents",g=[b.config({}),r.config({onSetValue:t.onSetValue,store:{mode:"dataset",getDataKey:e=>Bn(e.element),getFallbackEntry:e=>({value:e,meta:{}}),setValue:(e,n)=>{Lo(e.element,t.model.getDisplayText(n))},...t.initialData.map(e=>jo("initialValue",e)).getOr({})}}),Nd.config({stream:{mode:"throttle",delay:t.responseTime,stopEvent:!1},onStream:(n)=>{const o=Y.getCoupled(n,"sandbox");if(b.isFocused(n)&&Bn(n.element).length>=t.minChars){const s=d(o).bind(e=>F.getHighlighted(e).map(r.getValue));t.previewing.set(!0);const a=n=>{d(o).each(n=>{s.fold(()=>{t.model.selectsOver&&F.highlightFirst(n)},t=>{F.highlightBy(n,e=>r.getValue(e).value===t.value),F.getHighlighted(n).orThunk(()=>(F.highlightFirst(n),e.none()))})})};Xr(t,l(n),n,o,i,a,Ue.HighlightJustMenu).get(c)}},cancelEvent:vu()}),u.config({mode:"special",onDown:(t,n)=>(h(t,n,F.highlightFirst),e.some(!0)),onEscape:t=>{const n=Y.getCoupled(t,"sandbox");return k.isOpen(n)?(k.close(n),e.some(!0)):e.none()},onUp:(t,n)=>(h(t,n,F.highlightLast),e.some(!0)),onEnter:n=>{const s=Y.getCoupled(n,"sandbox"),o=k.isOpen(s);if(o&&!t.previewing.get())return d(s).bind(e=>F.getHighlighted(e)).map(e=>(p(n,zd(),{item:e}),!0));{const i=r.getValue(n);return T(n,vu()),t.onExecute(s,n,i),o&&k.close(s),e.some(!0)}}}),A.config({toggleClass:t.markers.openClass,aria:{mode:"expanded"}}),Y.config({others:{sandbox:e=>Hu(t,e,{onOpen:()=>A.on(e),onClose:()=>A.off(e)})}}),w(m,[Q(n=>{t.lazyTypeaheadComp.set(e.some(n))}),_n(n=>{t.lazyTypeaheadComp.set(e.none())}),Vn(e=>{const n=c;Bu(t,l(e),e,i,n,Ue.HighlightMenuAndItem).get(c)}),o(zd(),(e,n)=>{const s=Y.getCoupled(e,"sandbox");Za(t.model,e,n.event.item),T(e,vu()),t.onItemExecute(e,s,n.event.item,r.getValue(e)),k.close(s),Z5(e)})].concat(t.dismissOnBlur?[o(mu(),e=>{const t=Y.getCoupled(e,"sandbox");Jt(t.element).isNone()&&k.close(t)})]:[]))],v={[mi()]:[r.name(),Nd.name(),m],...t.eventOrder};return{uid:t.uid,dom:bh(te(t,{inputAttributes:{role:"combobox","aria-autocomplete":"list","aria-haspopup":"true"}})),behaviours:{...f,...ye(t.typeaheadBehaviours,g)},eventOrder:v}}}),lo=e=>({...e,toCached:()=>lo(e.toCached()),bindFuture:t=>lo(e.bind(e=>e.fold(e=>Yn(x.error(e)),e=>t(e)))),bindResult:t=>lo(e.map(e=>e.bind(t))),mapResult:t=>lo(e.map(e=>e.map(t))),mapError:t=>lo(e.map(e=>e.mapError(t))),foldResult:(t,n)=>e.map(e=>e.fold(t,n)),withTimeout:(t,n)=>lo(Fs(s=>{let o=!1;const i=setTimeout(()=>{o=!0,s(x.error(n()))},t);e.get(e=>{o||(clearTimeout(i),s(e))})}))}),Q7=e=>lo(Fs(e)),Y7=e=>({isEnabled:()=>!g.isDisabled(e),setEnabled:t=>g.set(e,!t),setActive:t=>{const n=e.element;t?(me(n,"tox-tbtn--enabled"),_(n,"aria-pressed",!0)):(ie(n,"tox-tbtn--enabled"),ve(n,"aria-pressed"))},isActive:()=>mt(e.element,"tox-tbtn--enabled")}),Td=(e,t,n,s)=>qd({text:e.text,icon:e.icon,tooltip:e.tooltip,searchable:e.search.isSome(),role:s,fetch:(t,s)=>{const o={pattern:e.search.isSome()?tj(t):""};e.fetch(t=>{s(So(t,Ut.CLOSE_ON_EXECUTE,n,{isHorizontalMenu:!1,search:e.search}))},o)},onSetup:e.onSetup,getApi:Y7,columns:1,presets:"normal",classes:[],dropdownBehaviours:[Z.config({})]},t,n.shared),K7=(e,t,n)=>{const s=e=>s=>{const o=!s.isActive();s.setActive(o),e.storage.set(o),n.shared.getSink().each(n=>{t().getOpt(n).each(t=>{Xn(t.element),p(t,Kn,{name:e.name,value:e.storage.get()})})})},o=e=>t=>{t.setActive(e.storage.get())};return t=>{t(a(e,e=>{const t=e.text.fold(()=>({}),e=>({text:e}));return{type:e.type,active:!1,...t,onAction:s(e),onSetup:o(e)}}))}},c7=(e,t,n=[],s,o,a)=>{const r=t.fold(()=>({}),e=>({action:e})),c={buttonBehaviours:i([Oo(()=>!e.enabled||a.isDisabled()),re(),Z.config({}),w("button press",[j6("click"),j6("mousedown")])].concat(n)),eventOrder:{click:["button press","alloy.base.behaviour"],mousedown:["button press","alloy.base.behaviour"]},...r},l=te(c,{dom:s});return te(l,{components:o})},U7=(e,t,n,s=[])=>{const o={tag:"button",classes:["tox-tbtn"],attributes:e.tooltip.map(e=>({"aria-label":n.translate(e),title:n.translate(e)})).getOr({})},i=e.icon.map(e=>pr(e,n.icons)),a=da([i]);return c7(e,t,s,o,a,n)},d7=(e,t,n,s=[],o=[])=>{const i=n.translate(e.text),a=e.icon.map(e=>pr(e,n.icons)),r=[a.getOrThunk(()=>be(i))],c=[...(e=>{switch(e){case"primary":return["tox-button"];case"toolbar":return["tox-tbtn"];default:return["tox-button","tox-button--secondary"]}})(e.buttonType.getOr(e.primary||e.borderless?"primary":"secondary")),...a.isSome()?["tox-button--icon"]:[],...e.borderless?["tox-button--naked"]:[],...o];return c7(e,t,s,{tag:"button",classes:c,attributes:{title:i}},r,n)},Fd=(t,n,s,o=[],i=[])=>{const a=d7(t,e.some(n),s,o,i);return Je.sketch(a)},h7=(e,t)=>n=>{"custom"===t?p(n,Kn,{name:e,value:{}}):"submit"===t?T(n,Ci):"cancel"===t?T(n,vo):console.error("Unknown button type: ",t)},Ha=(t,n,s)=>{if(((e,t)=>"menu"===t)(0,n)){const o=()=>n,i=t,a={...t,type:"menubutton",search:e.none(),onSetup:e=>(e.setEnabled(t.enabled),c),fetch:K7(i.items,o,s)},n=V(Td(a,"tox-tbtn",s,e.none()));return n.asSpec()}if(((e,t)=>"custom"===t||"cancel"===t||"submit"===t)(0,n)){const e=h7(t.name,n),o={...t,borderless:!1};return Fd(o,e,s.shared.providers,[])}throw console.error("Unknown footer button type: ",n),new Error("Unknown footer button type")},$7={type:"separator"},V7=e=>({type:"menuitem",value:e.url,text:e.title,meta:{attach:e.attach},onAction:c}),Md=(e,t)=>({type:"menuitem",value:t,text:e,meta:{attach:void 0},onAction:c}),v7=(e,t)=>(e=>a(e,V7))(((e,t)=>K(t,t=>t.type===e))(e,t)),I7=e=>v7("header",e.targets),H7=e=>v7("anchor",e.targets),P7=t=>e.from(t.anchorTop).map(e=>Md("<top>",e)).toArray(),R7=t=>e.from(t.anchorBottom).map(e=>Md("<bottom>",e)).toArray(),Sd=(e,t)=>{const n=e.toLowerCase();return K(t,e=>{var t;const s=void 0!==e.meta&&void 0!==e.meta.text?e.meta.text:e.text,o=null!==(t=e.value)&&void 0!==t?t:"";return Ze(s.toLowerCase(),n)||Ze(o.toLowerCase(),n)})},O7=d("aria-invalid"),L7=(e,t)=>{e.dom.checked=t},N7=e=>e.dom.checked,de=t=>(n,s,o,i)=>f(s,"name").fold(()=>t(s,i,e.none()),e=>n.field(e,t(s,i,f(o,e)))),D7={bar:de((e,t)=>((e,t)=>({dom:{tag:"div",classes:["tox-bar","tox-form__controls-h-stack"]},components:a(e.items,t.interpreter)}))(e,t.shared)),collection:de((e,t,n)=>((e,t,n)=>{const h=e.label.map(e=>ds(e,t)),s=e=>(t,n)=>{hn(n.event.target,"[data-collection-item-value]").each(s=>{e(t,n,s,Ne(s,"data-collection-item-value"))})},l=s((n,s,o,i)=>{s.stop(),t.isDisabled()||p(n,Kn,{name:e.name,value:i})}),m=[o(As(),s((e,t,n)=>{Xn(n)})),o(Hi(),l),o(xi(),l),o(Ms(),s((e,t,n)=>{pe(e.element,"."+Ca).each(e=>{ie(e,Ca)}),me(n,Ca)})),o(E9(),s(e=>{pe(e.element,"."+Ca).each(e=>{ie(e,Ca)})})),Vn(s((t,n,s,o)=>{p(t,Kn,{name:e.name,value:o})}))],d=(e,t)=>a($e(e.element,".tox-collection__item"),t),f=M.parts.field({dom:{tag:"div",classes:["tox-collection"].concat(1!==e.columns?["tox-collection--grid"]:["tox-collection--list"])},components:[],factory:{sketch:z},behaviours:i([g.config({disabled:t.isDisabled,onDisabled:e=>{d(e,e=>{me(e,"tox-collection__item--state-disabled"),_(e,"aria-disabled",!0)})},onEnabled:e=>{d(e,e=>{ie(e,"tox-collection__item--state-disabled"),ve(e,"aria-disabled")})}}),re(),j.config({}),r.config({store:{mode:"memory",initialValue:n.getOr([])},onSetValue:(n,s)=>{((n,s)=>{const o=a(s,n=>{const s=xt.translate(n.text),i=1===e.columns?`<div class="tox-collection__item-label">${s}</div>`:"",a=`<div class="tox-collection__item-icon">${n.icon}</div>`,r={_:" "," - ":" ","-":" "},o=s.replace(/_| - |-/g,e=>r[e]);return`<div class="tox-collection__item${t.isDisabled()?" tox-collection__item--state-disabled":""}" tabindex="-1" data-collection-item-value="${T6.encodeAllRaw(n.value)}" title="${o}" aria-label="${o}">${a}${i}</div>`}),i="auto"!==e.columns&&e.columns>1?Pf(o,e.columns):[o],r=a(i,e=>`<div class="tox-collection__group">${e.join("")}</div>`);Ro(n.element,r.join(""))})(n,s),"auto"===e.columns&&f1(n,5,"tox-collection__item").each(({numRows:e,numColumns:t})=>{u.setGridSize(n,e,t)}),T(n,U6)}}),Z.config({}),u.config((c=e.columns,1===c?{mode:"menu",moveOnTab:!1,selector:".tox-collection__item"}:"auto"===c?{mode:"flatgrid",selector:".tox-collection__item",initSize:{numColumns:1,numRows:1}}:{mode:"matrix",selectors:{row:".tox-collection__group",cell:`.${Ga}`}})),w("collection-events",m)]),eventOrder:{[ut()]:["disabling","alloy.base.behaviour","collection-events"]}});var c;return Ti(h,f,["tox-form__group--collection"],[])})(e,t.shared.providers,n)),alertbanner:de((e,t)=>((e,t)=>tn.sketch({dom:{tag:"div",attributes:{role:"alert"},classes:["tox-notification","tox-notification--in",`tox-notification--${e.level}`]},components:[{dom:{tag:"div",classes:["tox-notification__icon"]},components:[Je.sketch({dom:{tag:"button",classes:["tox-button","tox-button--naked","tox-button--icon"],innerHtml:P2(e.icon,t.icons),attributes:{title:t.translate(e.iconTooltip)}},action:t=>{p(t,Kn,{name:"alert-banner",value:e.url})},buttonBehaviours:i([a4()])})]},{dom:{tag:"div",classes:["tox-notification__body"],innerHtml:t.translate(e.text)}}]}))(e,t.shared.providers)),input:de((t,n,s)=>((t,n,s)=>$5({name:t.name,multiline:!1,label:t.label,inputMode:t.inputMode,placeholder:t.placeholder,flex:!1,disabled:!t.enabled,classname:"tox-textfield",validation:e.none(),maximized:t.maximized,data:s},n))(t,n.shared.providers,s)),textarea:de((t,n,s)=>((t,n,s)=>$5({name:t.name,multiline:!0,label:t.label,inputMode:e.none(),placeholder:t.placeholder,flex:!0,disabled:!t.enabled,classname:"tox-textarea",validation:e.none(),maximized:t.maximized,data:s},n))(t,n.shared.providers,s)),label:de((t,n)=>((t,n)=>{return{dom:{tag:"div",classes:["tox-form__group"]},components:[{dom:{tag:"label",classes:["tox-label"]},components:[be(n.providers.translate(t.label))]},...a(t.items,n.interpreter)],behaviours:i([ms(),j.config({}),(s=e.none(),s5(s,Vu,Ro)),u.config({mode:"acyclic"})])};var s})(t,n.shared)),iframe:(Ug=(e,t,n)=>((e,t,n)=>{const a=e.sandboxed,r=e.transparent,s="tox-dialog__iframe",c={...e.label.map(e=>({title:e})).getOr({}),...n.map(e=>({srcdoc:e})).getOr({}),...a?{sandbox:"allow-scripts allow-same-origin"}:{}},o=(e=>{const t=v(e.getOr(""));return{getValue:e=>t.get(),setValue:(e,n)=>{t.get()!==n&&_(e.element,"srcdoc",n),t.set(n)}}})(n),l=e.label.map(e=>ds(e,t)),d=M.parts.field({factory:{sketch:e=>f5({uid:e.uid,dom:{tag:"iframe",attributes:c,classes:r?[s]:[s,`${s}--opaque`]},behaviours:i([Z.config({}),b.config({}),Ao(n,o.getValue,o.setValue)])})}});return Ti(l,d,["tox-form__group--stretched"],[])})(e,t.shared.providers,n),(e,t,n,s)=>{const o=te(t,{source:"dynamic"});return de(Ug)(e,o,n,s)}),button:de((t,n)=>((t,n)=>{const i=h7(t.name,"custom");return s=e.none(),o=M.parts.field({factory:Je,...d7(t,e.some(i),n,[gr(""),ms()])}),Ti(s,o,[],[]);var s,o})(t,n.shared.providers)),checkbox:de((t,n,s)=>((t,n,s)=>{const a=t=>(t.element.dom.click(),e.some(!0)),c=M.parts.field({factory:{sketch:z},dom:{tag:"input",classes:["tox-checkbox__input"],attributes:{type:"checkbox"}},behaviours:i([ms(),g.config({disabled:()=>!t.enabled||n.isDisabled()}),Z.config({}),b.config({}),Pv(s,N7,L7),u.config({mode:"special",onEnter:a,onSpace:a,stopSpaceKeyup:!0}),w("checkbox-events",[o(Bi(),(e)=>{p(e,tt,{name:t.name})})])])}),l=M.parts.label({dom:{tag:"span",classes:["tox-checkbox__label"]},components:[be(n.translate(t.label))],behaviours:i([Oi.config({})])}),r=e=>gn("checked"===e?"selected":"unselected",{tag:"span",classes:["tox-icon","tox-checkbox-icon__"+e]},n.icons),d=V({dom:{tag:"div",classes:["tox-checkbox__icons"]},components:[r("checked"),r("unchecked")]});return M.sketch({dom:{tag:"label",classes:["tox-checkbox"]},components:[c,d.asSpec(),l],fieldBehaviours:i([g.config({disabled:()=>!t.enabled||n.isDisabled(),disableClass:"tox-checkbox--disabled",onDisabled:e=>{M.getField(e).each(g.disable)},onEnabled:e=>{M.getField(e).each(g.enable)}}),re()])})})(t,n.shared.providers,s)),colorinput:de((t,n,s)=>((t,n,s,a)=>{const h=M.parts.field({factory:Io,inputClasses:["tox-textfield"],data:a,onSetValue:e=>Mn.run(e).get(c),inputBehaviours:i([g.config({disabled:n.providers.isDisabled}),re(),Z.config({}),Mn.config({invalidClass:"tox-textbox-field-invalid",getRoot:e=>Ki(e.element),notify:{onValid:e=>{const t=r.getValue(e);p(e,sp,{color:t})}},validator:{validateOnLoad:!1,validate:e=>{const t=r.getValue(e);if(0===t.length)return Yn(x.value(!0));{const e=ii("span");y(e,"background-color",t);const n=Le(e,"background-color").fold(()=>x.error("blah"),e=>x.value(t));return Yn(n)}}}})]),selectOnFocus:!1}),m=t.label.map(e=>ds(e,n.providers)),u=(e,t)=>{p(e,op,{value:t})},l=V(((t,n)=>Et.sketch({dom:t.dom,components:t.components,toggleClass:"mce-active",dropdownBehaviours:i([Oo(n.providers.isDisabled),re(),Oi.config({}),Z.config({})]),layouts:t.layouts,sandboxClasses:["tox-dialog__popups"],lazySink:n.getSink,fetch:s=>Fs(e=>t.fetch(e)).map(o=>e.from(Mu(te(Ku(d("menu-value"),o,e=>{t.onItemAction(s,e)},t.columns,t.presets,Ut.CLOSE_ON_EXECUTE,U,n.providers),{movement:Lr(t.columns,t.presets)})))),parts:{menu:Ua(0,0,t.presets)}}))({dom:{tag:"span",attributes:{"aria-label":n.providers.translate("Color swatch")}},layouts:{onRtl:()=>[De,ze,ke],onLtr:()=>[ze,De,ke]},components:[],fetch:yf(s.getColors(t.storageKey),t.storageKey,s.hasCustomColors()),columns:s.getColorCols(t.storageKey),presets:"color",onItemAction:(e,n)=>{l.getOpt(e).each(e=>{"custom"===n?s.colorPicker(n=>{n.fold(()=>T(e,ip),n=>{u(e,n),Z8(t.storageKey,n)})},"#ffffff"):u(e,"remove"===n?"":n)})}},n));return M.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:m.toArray().concat([{dom:{tag:"div",classes:["tox-color-input"]},components:[h,l.asSpec()]}]),fieldBehaviours:i([w("form-field-events",[o(sp,(e,n)=>{l.getOpt(e).each(e=>{y(e.element,"background-color",n.event.color)}),p(e,tt,{name:t.name})}),o(op,(e,t)=>{M.getField(e).each(n=>{r.setValue(n,t.event.value),O.getCurrent(e).each(b.focus)})}),o(ip,(e)=>{M.getField(e).each(t=>{O.getCurrent(e).each(b.focus)})})])])})})(t,n.shared,n.colorinput,s)),colorpicker:de((t,n,s)=>((t,n,s)=>{const a=e=>"tox-"+e,c=Kv((e=>t=>e.translate(Rv[t]))(n),a),o=V(c.sketch({dom:{tag:"div",classes:[a("color-picker-container")],attributes:{role:"presentation"}},onValidHex:e=>{p(e,Kn,{name:"hex-valid",value:!0})},onInvalidHex:e=>{p(e,Kn,{name:"hex-valid",value:!1})}}));return{dom:{tag:"div"},components:[o.asSpec()],behaviours:i([Ao(s,e=>{const t=o.get(e);return O.getCurrent(t).bind(e=>r.getValue(e).hex).map(e=>"#"+e).getOr("")},(t,n)=>{const s=e.from(/^#([a-fA-F0-9]{3}(?:[a-fA-F0-9]{3})?)/.exec(n)).bind(e=>fr(e,1)),i=o.get(t);O.getCurrent(i).fold(()=>{console.log("Can not find form")},e=>{r.setValue(e,{hex:s.getOr("")}),Fo.getField(e,"hex").each(e=>{T(e,ao())})})}),ms()])}})(0,n.shared.providers,s)),dropzone:de((e,t,n)=>((e,t,n)=>{const s=(e,t)=>{t.stop()},a=e=>(t,n)=>{h(e,e=>{e(t,n)})},d=(e,t)=>{var n;if(!g.isDisabled(e)){const s=t.event.raw;c(e,null===(n=s.dataTransfer)||void 0===n?void 0:n.files)}},u=(e,t)=>{const n=t.event.raw.target;c(e,n.files)},c=(n,s)=>{s&&(r.setValue(n,((e,t)=>{const n=is.explode(t.getOption("images_file_types"));return K(gx(e),e=>nn(n,t=>cc(e.name.toLowerCase(),`.${t.toLowerCase()}`)))})(s,t)),p(n,tt,{name:e.name}))},l=V({dom:{tag:"input",attributes:{type:"file",accept:"image/*"},styles:{display:"none"}},behaviours:i([w("input-file-events",[ro(Hi()),ro(xi())])])}),m=e.label.map(e=>ds(e,t)),f=M.parts.field({factory:{sketch:e=>({uid:e.uid,dom:{tag:"div",classes:["tox-dropzone-container"]},behaviours:i([gr(n.getOr([])),ms(),g.config({}),A.config({toggleClass:"dragenter",toggleOnExecute:!1}),w("dropzone-events",[o("dragenter",a([s,A.toggle])),o("dragleave",a([s,A.toggle])),o("dragover",s),o("drop",a([s,d])),o(Bi(),u)])]),components:[{dom:{tag:"div",classes:["tox-dropzone"],styles:{}},components:[{dom:{tag:"p"},components:[be(t.translate("Drop an image here"))]},Je.sketch({dom:{tag:"button",styles:{position:"relative"},classes:["tox-button","tox-button--secondary"]},components:[be(t.translate("Browse for an image")),l.asSpec()],action:e=>{l.get(e).element.dom.click()},buttonBehaviours:i([Z.config({}),Oo(t.isDisabled),re()])})]}]})}});return Ti(m,f,["tox-form__group--stretched"],[])})(e,t.shared.providers,n)),grid:de((e,t)=>((e,t)=>({dom:{tag:"div",classes:["tox-form__grid",`tox-form__grid--${e.columns}col`]},components:a(e.items,t.interpreter)}))(e,t.shared)),listbox:de((t,s,o)=>((t,s,o)=>{const l=s.shared.providers,a=o.bind(e=>Bd(t.items,e)).orThunk(()=>Zn(t.items).filter($d)),d=t.label.map(e=>ds(e,l)),u=M.parts.field({dom:{},factory:{sketch:o=>qd({uid:o.uid,text:a.map(e=>e.text),icon:e.none(),tooltip:t.label,role:e.none(),fetch:(n,o)=>{const i=z5(n,t.name,t.items,r.getValue(n));o(So(i,Ut.CLOSE_ON_EXECUTE,s,{isHorizontalMenu:!1,search:e.none()}))},onSetup:n(c),getApi:n({}),columns:1,presets:"normal",classes:[],dropdownBehaviours:[Z.config({}),Ao(a.map(e=>e.value),e=>Ne(e.element,T5),(e,n)=>{Bd(t.items,n).each(t=>{_(e.element,T5,t.value),p(e,wo,{text:t.text})})})]},"tox-listbox",s.shared)}}),h={dom:{tag:"div",classes:["tox-listboxfield"]},components:[u]};return M.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:Se([d.toArray(),[h]]),fieldBehaviours:i([g.config({disabled:n(!t.enabled),onDisabled:e=>{M.getField(e).each(g.disable)},onEnabled:e=>{M.getField(e).each(g.enable)}})])})})(t,s,o)),selectbox:de((t,n,s)=>((t,n,s)=>{const r=a(t.items,e=>({text:n.translate(e.text),value:e.value})),c=t.label.map(e=>ds(e,n)),l=M.parts.field({dom:{},...s.map(e=>({data:e})).getOr({}),selectAttributes:{size:t.size},options:r,factory:wv,selectBehaviours:i([g.config({disabled:()=>!t.enabled||n.isDisabled()}),Z.config({}),w("selectbox-change",[o(Bi(),(e)=>{p(e,tt,{name:t.name})})])])}),d=t.size>1?e.none():e.some(gn("chevron-down",{tag:"div",classes:["tox-selectfield__icon-js"]},n.icons)),u={dom:{tag:"div",classes:["tox-selectfield"]},components:Se([[l],d.toArray()])};return M.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:Se([c.toArray(),[u]]),fieldBehaviours:i([g.config({disabled:()=>!t.enabled||n.isDisabled(),onDisabled:e=>{M.getField(e).each(g.disable)},onEnabled:e=>{M.getField(e).each(g.enable)}}),re()])})})(t,n.shared.providers,s)),sizeinput:de((e,t)=>((e,t)=>{let a=Ld;const c=d("ratio-event"),l=e=>gn(e,{tag:"span",classes:["tox-icon","tox-lock-icon__"+e]},t.icons),h=yt.parts.lock({dom:{tag:"button",classes:["tox-lock","tox-button","tox-button--naked","tox-button--icon"],attributes:{title:t.translate(e.label.getOr("Constrain proportions"))}},components:[l("lock"),l("unlock")],buttonBehaviours:i([g.config({disabled:()=>!e.enabled||t.isDisabled()}),re(),Z.config({})])}),n=e=>({dom:{tag:"div",classes:["tox-form__group"]},components:e}),u=n=>M.parts.field({factory:Io,inputClasses:["tox-textfield"],inputBehaviours:i([g.config({disabled:()=>!e.enabled||t.isDisabled()}),re(),Z.config({}),w("size-input-events",[o(Ms(),(e)=>{p(e,c,{isField1:n})}),o(Bi(),(t)=>{p(t,tt,{name:e.name})})])]),selectOnFocus:!1}),s=e=>({dom:{tag:"label",classes:["tox-label"]},components:[be(t.translate(e))]}),m=yt.parts.field1(n([M.parts.label(s("Width")),u(!0)])),f=yt.parts.field2(n([M.parts.label(s("Height")),u(!1)]));return yt.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:[{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:[m,f,n([s("\xa0"),h])]}],field1Name:"width",field2Name:"height",locked:!0,markers:{lockClass:"tox-locked"},onLockedChange:(e,t)=>{Rd(r.getValue(e)).each(e=>{a(e).each(e=>{r.setValue(t,(e=>{const n={"":0,px:0,pt:1,mm:1,pc:2,ex:2,em:2,ch:2,rem:2,cm:3,in:4,"%":4};let t=e.value.toFixed((s=e.unit)in n?n[s]:1);var s;return-1!==t.indexOf(".")&&(t=t.replace(/\.?0*$/,"")),t+e.unit})(e))})})},coupledFieldBehaviours:i([g.config({disabled:()=>!e.enabled||t.isDisabled(),onDisabled:e=>{yt.getField1(e).bind(M.getField).each(g.disable),yt.getField2(e).bind(M.getField).each(g.disable),yt.getLock(e).each(g.disable)},onEnabled:e=>{yt.getField1(e).bind(M.getField).each(g.enable),yt.getField2(e).bind(M.getField).each(g.enable),yt.getLock(e).each(g.enable)}}),re(),w("size-input-events2",[o(c,(e,t)=>{const n=t.event.isField1,s=n?yt.getField1(e):yt.getField2(e),o=n?yt.getField2(e):yt.getField1(e),i=s.map(r.getValue).getOr(""),c=o.map(r.getValue).getOr("");a=((e,t)=>{const n=Rd(e).toOptional(),s=Rd(t).toOptional();return ic(n,s,(e,t)=>B5(e,t.unit).map(e=>t.value/e).map(e=>{return s=e,n=t.unit,e=>B5(e,n).map(e=>({value:e*s,unit:n}));var n,s}).getOr(Ld)).getOr(Ld)})(i,c)})])])})})(e,t.shared.providers)),slider:de((e,t,s)=>((e,t,s)=>{const o=Bt.parts.label({dom:{tag:"label",classes:["tox-label"]},components:[be(t.translate(e.label))]}),a=Bt.parts.spectrum({dom:{tag:"div",classes:["tox-slider__rail"],attributes:{role:"presentation"}}}),r=Bt.parts.thumb({dom:{tag:"div",classes:["tox-slider__handle"],attributes:{role:"presentation"}}});return Bt.sketch({dom:{tag:"div",classes:["tox-slider"],attributes:{role:"presentation"}},model:{mode:"x",minX:e.min,maxX:e.max,getInitialValue:n(s.getOrThunk(()=>(Math.abs(e.max)-Math.abs(e.min))/2))},components:[o,a,r],sliderBehaviours:i([ms(),b.config({})]),onChoose:(t,n,s)=>{p(t,tt,{name:e.name,value:s})}})})(e,t.shared.providers,s)),urlinput:de((t,n,s)=>((t,n,s,l)=>{const u=n.shared.providers,h=e=>{const n=r.getValue(e);s.addToHistory(n.value,t.filetype)},y={...l.map(e=>({initialData:e})).getOr({}),dismissOnBlur:!0,inputClasses:["tox-textfield"],sandboxClasses:["tox-dialog__popups"],inputAttributes:{"aria-errormessage":O7,type:"url"},minChars:0,responseTime:0,fetch:o=>{const i=((e,t,n)=>{const s=r.getValue(t),o=void 0!==s.meta.text?s.meta.text:s.value;return n.getLinkInformation().fold(()=>[],t=>{const s=Sd(o,(e=>a(e,e=>Md(e,e)))(n.getHistory(e)));return"file"===e?(i=[s,Sd(o,I7(t)),Sd(o,Se([P7(t),H7(t),R7(t)]))],Ie(i,(e,t)=>0===e.length||0===t.length?e.concat(t):e.concat($7,t),[])):s;var i})})(t.filetype,o,s),c=So(i,Ut.BUBBLE_TO_SANDBOX,n,{isHorizontalMenu:!1,search:e.none()});return Yn(c)},getHotspot:e=>j.getOpt(e),onSetValue:(e)=>{e.hasConfigured(Mn)&&Mn.run(e).get(c)},typeaheadBehaviours:i([...s.getValidationHandler().map(e=>Mn.config({getRoot:e=>Ki(e.element),invalidClass:"tox-control-wrap--status-invalid",notify:{onInvalid:(e,t)=>{f.getOpt(e).each(e=>{_(e.element,"title",u.translate(t))})}},validator:{validate:n=>{const s=r.getValue(n);return Q7(n=>{e({type:t.filetype,url:s.value},e=>{if("invalid"===e.status){const t=x.error(e.message);n(t)}else{const t=x.value(e.message);n(t)}})})},validateOnLoad:!1}})).toArray(),g.config({disabled:()=>!t.enabled||u.isDisabled()}),Z.config({}),w("urlinput-events",[o(ao(),e=>{const n=Bn(e.element),s=n.trim();s!==n&&Lo(e.element,s),"file"===t.filetype&&p(e,tt,{name:t.name})}),o(Bi(),e=>{p(e,tt,{name:t.name}),h(e)}),o(fu(),e=>{p(e,tt,{name:t.name}),h(e)})])]),eventOrder:{[ao()]:["streaming","urlinput-events","invalidating"]},model:{getDisplayText:e=>e.value,selectsOver:!1,populateFromBrowse:!1},markers:{openClass:"tox-textfield--popup-open"},lazySink:n.shared.getSink,parts:{menu:Ua(0,0,"normal")},onExecute:(e,t)=>{p(t,Ci,{})},onItemExecute:(e)=>{h(e),p(e,tt,{name:t.name})}},C=M.parts.field({...y,factory:cv}),E=t.label.map(e=>ds(e,u)),f=V(((e,t,n=e,s=e)=>gn(n,{tag:"div",classes:["tox-icon","tox-control-wrap__status-icon-"+e],attributes:{title:u.translate(s),"aria-live":"polite",...t.fold(()=>({}),e=>({id:e}))}},u.icons))("invalid",e.some(O7),"warning")),k=V({dom:{tag:"div",classes:["tox-control-wrap__status-icon-wrap"]},components:[f.asSpec()]}),v=s.getUrlPicker(t.filetype),b=d("browser.url.event"),j=V({dom:{tag:"div",classes:["tox-control-wrap"]},components:[C,k.asSpec()],behaviours:i([g.config({disabled:()=>!t.enabled||u.isDisabled()})])}),m=V(Fd({name:t.name,icon:e.some("browse"),text:t.label.getOr(""),enabled:t.enabled,primary:!1,buttonType:e.none(),borderless:!0},e=>T(e,b),u,[],["tox-browse-url"]));return M.sketch({dom:N6([]),components:E.toArray().concat([{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:Se([[j.asSpec()],v.map(()=>m.asSpec()).toArray()])}]),fieldBehaviours:i([g.config({disabled:()=>!t.enabled||u.isDisabled(),onDisabled:e=>{M.getField(e).each(g.disable),m.getOpt(e).each(g.disable)},onEnabled:e=>{M.getField(e).each(g.enable),m.getOpt(e).each(g.enable)}}),re(),w("url-input-events",[o(b,e=>{O.getCurrent(e).each(n=>{const s=r.getValue(n),o={fieldname:t.name,...s};v.each(s=>{s(o).get(s=>{r.setValue(n,s),p(e,tt,{name:t.name})})})})})])])})})(t,n,n.urlinput,s)),customeditor:de(t=>{const s=q(),o=V({dom:{tag:t.tag}}),n=q();return{dom:{tag:"div",classes:["tox-custom-editor"]},behaviours:i([w("custom-editor-events",[Q(e=>{o.getOpt(e).each(e=>{((e=>R(e,"init"))(t)?t.init(e.element.dom):l5.load(t.scriptId,t.scriptUrl).then(n=>n(e.element.dom,t.settings))).then(e=>{n.on(t=>{e.setValue(t)}),n.clear(),s.set(e)})})})]),Ao(e.none(),()=>s.get().fold(()=>n.get().getOr(""),e=>e.getValue()),(e,t)=>{s.get().fold(()=>n.set(t),e=>e.setValue(t))}),ms()]),components:[o.asSpec()]}}),htmlpanel:de(e=>"presentation"===e.presets?tn.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:e.html}}):tn.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:e.html,attributes:{role:"document"}},containerBehaviours:i([Z.config({}),b.config({})])})),imagepreview:de((t,n,s)=>((t,n)=>{const s=v(n.getOr({url:""})),o=V({dom:{tag:"img",classes:["tox-imagepreview__image"],attributes:n.map(e=>({src:e.url})).getOr({})}}),a=V({dom:{tag:"div",classes:["tox-imagepreview__container"],attributes:{role:"presentation"}},components:[o.asSpec()]}),r={};t.height.each(e=>r.height=e);const c=n.map(t=>({url:t.url,zoom:e.from(t.zoom),cachedWidth:e.from(t.cachedWidth),cachedHeight:e.from(t.cachedHeight)}));return{dom:{tag:"div",classes:["tox-imagepreview"],styles:r,attributes:{role:"presentation"}},components:[a.asSpec()],behaviours:i([ms(),Ao(c,()=>s.get(),(e,t)=>{const n={url:t.url};t.zoom.each(e=>n.zoom=e),t.cachedWidth.each(e=>n.cachedWidth=e),t.cachedHeight.each(e=>n.cachedHeight=e),s.set(n);const i=()=>{const{cachedWidth:t,cachedHeight:s,zoom:o}=n;if(!ts(t)&&!ts(s)){if(ts(o)){const o=((e,t,n)=>{const s=et(e),o=Pe(e);return Math.min(s/t,o/n,1)})(e.element,t,s);n.zoom=o}const i=((e,t,n,s,o)=>{const i=n*o,a=s*o,r=Math.max(0,e/2-i/2),c=Math.max(0,t/2-a/2);return{left:r.toString()+"px",top:c.toString()+"px",width:i.toString()+"px",height:a.toString()+"px"}})(et(e.element),Pe(e.element),t,s,n.zoom);a.getOpt(e).each(e=>{Go(e.element,i)})}};o.getOpt(e).each(s=>{const a=s.element;var o;t.url!==Ne(a,"src")&&(_(a,"src",t.url),ie(e.element,"tox-imagepreview__loaded")),i(),(o=a,new Promise((e,t)=>{const n=()=>{s(),e(o)},i=[Ke(o,"load",n),Ke(o,"error",()=>{s(),t("Unable to load data from image: "+o.dom.src)})],s=()=>h(i,e=>e.unbind());o.dom.complete&&n()})).then(t=>{e.getSystem().isConnected()&&(me(e.element,"tox-imagepreview__loaded"),n.cachedWidth=t.dom.naturalWidth,n.cachedHeight=t.dom.naturalHeight,i())})})})])}})(t,s)),table:de((e,t)=>((e,t)=>{const o=e=>({dom:{tag:"td",innerHtml:t.translate(e)}});return{dom:{tag:"table",classes:["tox-dialog__table"]},components:[(s=e.header,{dom:{tag:"thead"},components:[{dom:{tag:"tr"},components:a(s,e=>({dom:{tag:"th",innerHtml:t.translate(e)}}))}]}),(n=e.cells,{dom:{tag:"tbody"},components:a(n,e=>({dom:{tag:"tr"},components:a(e,o)}))})],behaviours:i([Z.config({}),b.config({})])};var n,s})(e,t.shared.providers)),panel:de((e,t)=>((e,t)=>({dom:{tag:"div",classes:e.classes},components:a(e.items,t.shared.interpreter)}))(e,t))},Av={field:(e,t)=>t,record:n([])},S7=(e,t,n,s)=>{const o=te(s,{shared:{interpreter:t=>Ad(e,t,n,o)}});return Ad(e,t,n,o)},Ad=(e,t,n,s)=>f(D7,t.type).fold(()=>(console.error(`Unknown factory type "${t.type}", defaulting to container: `,t),t),o=>o(e,t,n,s)),F7=(e,t,n)=>Ad(Av,e,t,n),ys="layout-inset",Ed=e=>e.x,k7=(e,t)=>e.x+e.width/2-t.width/2,Cd=(e,t)=>e.x+e.width-t.width,Od=e=>e.y,_d=(e,t)=>e.y+e.height-t.height,y7=(e,t)=>e.y+e.height/2-t.height/2,Pa=(e,t,n)=>Ae(Cd(e,t),_d(e,t),n.insetSouthwest(),Gc(),"southwest",Me(e,{right:0,bottom:3}),ys),Br=(e,t,n)=>Ae(Ed(e),_d(e,t),n.insetSoutheast(),_4(),"southeast",Me(e,{left:1,bottom:3}),ys),za=(e,t,n)=>Ae(Cd(e,t),Od(e),n.insetNorthwest(),j4(),"northwest",Me(e,{right:0,top:2}),ys),Sa=(e,t,n)=>Ae(Ed(e),Od(e),n.insetNortheast(),Fr(),"northeast",Me(e,{left:1,top:2}),ys),jn=(e,t,n)=>Ae(k7(e,t),Od(e),n.insetNorth(),F4(),"north",Me(e,{top:2}),ys),Aa=(e,t,n)=>Ae(k7(e,t),_d(e,t),n.insetSouth(),S2(),"south",Me(e,{bottom:3}),ys),l7=(e,t,n)=>Ae(Cd(e,t),y7(e,t),n.insetEast(),U2(),"east",Me(e,{right:0}),ys),r7=(e,t,n)=>Ae(Ed(e),y7(e,t),n.insetWest(),N2(),"west",Me(e,{left:1}),ys),q7=e=>{switch(e){case"north":return jn;case"northeast":return Sa;case"northwest":return za;case"south":return Aa;case"southeast":return Br;case"southwest":return Pa;case"east":return l7;case"west":return r7}},i7=(e,t,n,s,o)=>k2(s).map(q7).getOr(jn)(e,t,n,s,o),G7=e=>{switch(e){case"north":return Aa;case"northeast":return Br;case"northwest":return Pa;case"south":return jn;case"southeast":return Sa;case"southwest":return za;case"east":return r7;case"west":return l7}},X7=(e,t,n,s,o)=>k2(s).map(G7).getOr(jn)(e,t,n,s,o),o7={valignCentre:[],alignCentre:[],alignLeft:[],alignRight:[],right:[],left:[],bottom:[],top:[]},Z7=(t,n,s)=>{const o={maxHeightFunction:gi()};return()=>s()?{type:"node",root:Ka(Tt(t())),node:e.from(t()),bubble:hi(12,12,o7),layouts:{onRtl:()=>[Sa],onLtr:()=>[za]},overrides:o}:{type:"hotspot",hotspot:n(),bubble:hi(-12,12,o7),layouts:{onRtl:()=>[ze],onLtr:()=>[De]},overrides:o}},J7=(t,n,s)=>()=>s()?{type:"node",root:Ka(Tt(t())),node:e.from(t()),layouts:{onRtl:()=>[jn],onLtr:()=>[jn]}}:{type:"hotspot",hotspot:n(),layouts:{onRtl:()=>[ke],onLtr:()=>[ke]}},ev=(t,n)=>()=>({type:"selection",root:n(),getSelection:()=>{const n=t.selection.getRng();return e.some(bi.range(l(n.startContainer),n.startOffset,l(n.endContainer),n.endOffset))}}),tv=e=>t=>({type:"node",root:e(),node:t}),nv=(e,t,n)=>{const a=wa(e),s=()=>l(e.getBody()),o=()=>l(e.getContentAreaContainer()),i=()=>a||!n();return{inlineDialog:Z7(o,t,i),banner:J7(o,t,i),cursor:ev(e,s),node:tv(s)}},sv=e=>(t,n)=>{xf(e)(t,n)},ov=e=>()=>hf(e),iv=e=>t=>Xi(e,t),av=e=>t=>uf(e,t),rv=e=>()=>C3(e),n7=e=>Gt(e,"items"),t7=e=>Gt(e,"format"),e7=[{title:"Headings",items:[{title:"Heading 1",format:"h1"},{title:"Heading 2",format:"h2"},{title:"Heading 3",format:"h3"},{title:"Heading 4",format:"h4"},{title:"Heading 5",format:"h5"},{title:"Heading 6",format:"h6"}]},{title:"Inline",items:[{title:"Bold",format:"bold"},{title:"Italic",format:"italic"},{title:"Underline",format:"underline"},{title:"Strikethrough",format:"strikethrough"},{title:"Superscript",format:"superscript"},{title:"Subscript",format:"subscript"},{title:"Code",format:"code"}]},{title:"Blocks",items:[{title:"Paragraph",format:"p"},{title:"Blockquote",format:"blockquote"},{title:"Div",format:"div"},{title:"Pre",format:"pre"}]},{title:"Align",items:[{title:"Left",format:"alignleft"},{title:"Center",format:"aligncenter"},{title:"Right",format:"alignright"},{title:"Justify",format:"alignjustify"}]}],J5=e=>Ie(e,(e,t)=>{if(R(t,"items")){const n=J5(t.items);return{customFormats:e.customFormats.concat(n.customFormats),formats:e.formats.concat([{title:t.title,items:n.formats}])}}if(R(t,"inline")||(e=>R(e,"block"))(t)||(e=>R(e,"selector"))(t)){const n=`custom-${L(t.name)?t.name:t.title.toLowerCase()}`;return{customFormats:e.customFormats.concat([{name:n,format:t}]),formats:e.formats.concat([{title:t.title,format:n,icon:t.icon}])}}return{...e,formats:e.formats.concat(t)}},{customFormats:[],formats:[]}),X5=e=>i3(e).map(t=>{const n=((e,t)=>{const n=J5(t),s=t=>{h(t,t=>{e.formatter.has(t.name)||e.formatter.register(t.name,t.format)})};return e.formatter?s(n.customFormats):e.on("init",()=>{s(n.customFormats)}),n.formats})(e,t);return a3(e)?e7.concat(n):n}).getOr(e7),G5=(e,t,n)=>({...e,type:"formatter",isSelected:t(e.format),getStylePreview:n(e.format)}),V5=(e,t,s,o)=>{const i=t=>a(t,t=>n7(t)?(e=>{const t=i(e.items);return{...e,type:"submenu",getStyleItems:n(t)}})(t):t7(t)?(e=>G5(e,s,o))(t):(e=>{const t=ce(e);return 1===t.length&&_e(t,"title")})(t)?{...t,type:"separator"}:(t=>{const i=L(t.name)?t.name:d(t.title),n=`custom-${i}`,a={...t,type:"formatter",format:n,isSelected:s(n),getStylePreview:o(n)};return e.formatter.register(i,a),a})(t));return i(t)},pv=is.trim,I5=e=>t=>{if((e=>Wt(e)&&1===e.nodeType)(t)){if(t.contentEditable===e)return!0;if(t.getAttribute("data-mce-contenteditable")===e)return!0}return!1},vv=I5("true"),bv=I5("false"),P5=(e,t,n,s,o)=>({type:e,title:t,url:n,level:s,attach:o}),L5=e=>e.innerText||e.textContent,_v=e=>(e=>e&&"A"===e.nodeName&&void 0!==(e.id||e.name))(e)&&D5(e),N5=e=>e&&/^(H[1-6])$/.test(e.nodeName),D5=e=>(e=>{let t=e;for(;t=t.parentNode;){const e=t.contentEditable;if(e&&"inherit"!==e)return vv(t)}return!1})(e)&&!bv(e),xv=e=>N5(e)&&D5(e),Cv=e=>{var t;const n=(e=>e.id?e.id:d("h"))(e);return P5("header",null!==(t=L5(e))&&void 0!==t?t:"","#"+n,(e=>N5(e)?parseInt(e.nodeName.substr(1),10):0)(e),()=>{e.id=n})},Ev=e=>{const t=e.id||e.name,n=L5(e);return P5("anchor",n||"#"+t,"#"+t,0,c)},kv=e=>pv(e.title).length>0,Vy=e=>{const t=(e=>{const t=a($e(l(e),"h1,h2,h3,h4,h5,h6,a:not([href])"),e=>e.dom);return t})(e);return K((e=>a(K(e,xv),Cv))(t).concat((e=>a(K(e,_v),Ev))(t)),kv)},Wa="tinymce-url-history",F5=e=>L(e)&&/^https?/.test(e),A5=e=>os(e)&&Y1(e,e=>{return!(bs(t=e)&&t.length<=5&&Ho(t,F5));var t}).isNone(),x5=()=>{const t=gs.getItem(Wa);if(null===t)return{};let e;try{e=JSON.parse(t)}catch(e){if(e instanceof SyntaxError)return console.log("Local storage "+Wa+" was not valid JSON",e),{};throw e}return A5(e)?e:(console.log("Local storage "+Wa+" was not valid format",e),{})},zv=e=>{const t=x5();return f(t,e).getOr([])},Dv=(e,t)=>{if(!F5(e))return;const n=x5(),s=f(n,t).getOr([]),o=K(s,t=>t!==e);n[t]=[e].concat(o).slice(0,5),(e=>{if(!A5(e))throw new Error(`Bad format for history:
`+JSON.stringify(e));gs.setItem(Wa,JSON.stringify(e))})(n)},g5=e=>!!e,Lv=e=>je(is.makeMap(e,/[, ]/),g5),bd=t=>e.from(j3(t)),i5=t=>e.from(t).filter(L).getOrUndefined(),Hv=t=>({getHistory:zv,addToHistory:Dv,getLinkInformation:()=>(t=>w3(t)?e.some({targets:Vy(t.getBody()),anchorTop:i5(O3(t)),anchorBottom:i5(x3(t))}):e.none())(t),getValidationHandler:()=>(t=>e.from(y3(t)))(t),getUrlPicker:n=>((t,n)=>((t,n)=>{const s=(t=>{const n=e.from(_3(t)).filter(g5).map(Lv);return bd(t).fold(U,e=>n.fold(Oe,e=>ce(e).length>0&&e))})(t);return Tn(s)?s?bd(t):e.none():s[n]?bd(t):e.none()})(t,n).map(s=>o=>Fs(i=>{const a={filetype:n,fieldname:o.fieldname,...e.from(o.meta).getOr({})};s.call(t,(e,t)=>{if(!L(e))throw new Error("Expected value to be string");if(void 0!==t&&!os(t))throw new Error("Expected meta to be a object");i({value:e,meta:t})},o.value,a)})))(t,n)}),ge=sf,vn=t6,Vv=n([t("shell",!1),s("makeItem"),t("setupItem",c),si("listBehaviours",[j])]),$v=wt({name:"items",overrides:()=>({behaviours:i([j.config({})])})}),Wv=n([$v]),Jg=Be({name:n("CustomList")(),configFields:Vv(),partFields:Wv(),factory:(t,n)=>{const i=t.shell?{behaviours:[j.config({})],components:[]}:{behaviours:[],components:n};return{uid:t.uid,dom:t.dom,components:i.components,behaviours:ye(t.listBehaviours,i.behaviours),apis:{setItems:(n,s)=>{var o;(o=n,t.shell?e.some(o):P(o,t,"items")).fold(()=>{throw console.error("Custom List was defined to not be a shell, but no item container was specified in components"),new Error("Custom List was defined to not be a shell, but no item container was specified in components")},e=>{const o=j.contents(e),i=s.length,a=i-o.length,r=a>0?Du(a,()=>t.makeItem()):[],c=o.slice(i);h(c,t=>j.remove(e,t)),h(r,t=>j.append(e,t));const l=j.contents(e);h(l,(e,o)=>{t.setupItem(n,e,s[o],o)})})}}}},apis:{setItems:(e,t,n)=>{e.setItems(t,n)}}}),yo=n([s("dom"),t("shell",!0),fe("toolbarBehaviours",[j])]),qv=n([wt({name:"groups",overrides:()=>({behaviours:i([j.config({})])})})]),pn=Be({name:"Toolbar",configFields:yo(),partFields:qv(),factory:(t,n)=>{const i=t.shell?{behaviours:[j.config({})],components:[]}:{behaviours:[],components:n};return{uid:t.uid,dom:t.dom,components:i.components,behaviours:ye(t.toolbarBehaviours,i.behaviours),apis:{setGroups:(n,s)=>{var o;(o=n,t.shell?e.some(o):P(o,t,"groups")).fold(()=>{throw console.error("Toolbar was defined to not be a shell, but no groups container was specified in components"),new Error("Toolbar was defined to not be a shell, but no groups container was specified in components")},e=>{j.set(e,s)})}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:(e,t,n)=>{e.setGroups(t,n)}}}),Gv=c,Xv=U,Kg=n([]);$g=Object.freeze({__proto__:null,setup:Gv,isDocked:Xv,getBehaviours:Kg});const Hg=t=>(sn(Le(t,"position"),"fixed")?e.none():n0(t)).orThunk(()=>{const e=ii("span");return Cn(t).bind(t=>{Ht(t,e);const n=n0(e);return Ln(e),n})}),Lg=e=>Hg(e).map(ls).getOrThunk(()=>ee(0,0)),pd=Ft([{static:[]},{absolute:["positionCss"]},{fixed:["positionCss"]}]),s9=(e,t)=>{const n=e.element;me(n,t.transitionClass),ie(n,t.fadeOutClass),me(n,t.fadeInClass),t.onShow(e)},o9=(e,t)=>{const n=e.element;me(n,t.transitionClass),ie(n,t.fadeInClass),me(n,t.fadeOutClass),t.onHide(e)},Dg=(e,t,n)=>Ho(e,e=>{switch(e){case"bottom":return((e,t)=>e.bottom<=t.bottom)(t,n);case"top":return((e,t)=>e.y>=t.y)(t,n)}}),zg=(e,t)=>t.getInitialPos().map(t=>Ve(t.bounds.x,t.bounds.y,et(e),Pe(e))),Tg=(t,n,s)=>s.getInitialPos().bind(o=>{switch(s.clearInitialPos(),o.position){case"static":return e.some(pd.static());case"absolute":const s=Hg(t).map(it).getOrThunk(()=>it(Hn()));return e.some(pd.absolute(cn("absolute",f(o.style,"left").map(e=>n.x-s.x),f(o.style,"top").map(e=>n.y-s.y),f(o.style,"right").map(e=>s.right-n.right),f(o.style,"bottom").map(e=>s.bottom-n.bottom))));default:return e.none()}}),c9=(t,n,s)=>{const o=t.element;return sn(Le(o,"position"),"fixed")?((e,t,n)=>zg(e,n).filter(e=>Dg(n.getModes(),e,t)).bind(t=>Tg(e,t,n)))(o,n,s):((t,n,s)=>{const o=it(t);if(Dg(s.getModes(),o,n))return e.none();{((e,t,n)=>{n.setInitialPos({style:B6(e),position:ft(e,"position")||"static",bounds:t})})(t,o,s);const i=Sn(),r=o.x-i.x,c=n.y-i.y,l=i.bottom-n.bottom,a=o.y<=n.y;return e.some(pd.fixed(cn("fixed",e.some(r),a?e.some(c):e.none(),e.none(),a?e.none():e.some(l))))}})(o,n,s)},Sg=(e,t,n)=>{n.setDocked(!1),h(["left","right","top","bottom","position"],t=>I(e.element,t)),t.onUndocked(e)},hd=(e,t,n,s)=>{const o="fixed"===s.position;n.setDocked(o),H5(e.element,s),(o?t.onDocked:t.onUndocked)(e)},Eg=(e,t,n,s,o=!1)=>{t.contextual.each(t=>{t.lazyContext(e).each(i=>{const a=((e,t)=>e.y<t.bottom&&e.bottom>t.y)(i,s);a!==n.isVisible()&&(n.setVisible(a),o&&!a?(zs(e.element,[t.fadeOutClass]),t.onHide(e)):(a?s9:o9)(e,t))})})},ud=(e,t,n)=>{e.getSystem().isConnected()&&((e,t,n)=>{const s=t.lazyViewport(e);n.isDocked()&&Eg(e,t,n,s),c9(e,s,n).each(o=>{o.fold(()=>Sg(e,t,n),s=>hd(e,t,n,s),o=>{Eg(e,t,n,s,!0),hd(e,t,n,o)})})})(e,t,n)},xg=(e,t,n)=>{n.isDocked()&&((e,t,n)=>{const s=e.element;n.setDocked(!1),((e,t)=>{const n=e.element;return zg(n,t).bind(e=>Tg(n,e,t))})(e,n).each(s=>{s.fold(()=>Sg(e,t,n),s=>hd(e,t,n,s),c)}),n.setVisible(!0),t.contextual.each(t=>{mn(s,[t.fadeInClass,t.fadeOutClass,t.transitionClass]),t.onShow(e)}),ud(e,t,n)})(e,t,n)};var f9=Object.freeze({__proto__:null,refresh:ud,reset:xg,isDocked:(e,t,n)=>n.isDocked(),getModes:(e,t,n)=>n.getModes(),setModes:(e,t,n,s)=>n.setModes(s)}),p9=Object.freeze({__proto__:null,events:(e,t)=>$([Ko(Di(),(n,s)=>{e.contextual.each(e=>{mt(n.element,e.transitionClass)&&(mn(n.element,[e.transitionClass,e.fadeInClass]),(t.isVisible()?e.onShown:e.onHidden)(n)),s.stop()})}),o(ju(),(n)=>{ud(n,e,t)}),o(nr(),(n)=>{xg(n,e,t)})])}),g9=[bt("contextual",[he("fadeInClass"),he("fadeOutClass"),he("transitionClass"),Rt("lazyContext"),C("onShow"),C("onShown"),C("onHide"),C("onHidden")]),ue("lazyViewport",Sn),rr("modes",["top","bottom"],Ee),C("onDocked"),C("onUndocked")];const He=we({fields:g9,name:"docking",active:p9,apis:f9,state:Object.freeze({__proto__:null,init:e=>{const t=v(!1),n=v(!0),s=q(),o=v(e.modes);return jt({isDocked:t.get,setDocked:t.set,getInitialPos:s.get,setInitialPos:s.set,clearInitialPos:s.clear,isVisible:n.get,setVisible:n.set,getModes:o.get,setModes:o.set,readState:()=>`docked:  ${t.get()}, visible: ${n.get()}, modes: ${o.get().join(",")}`})}})}),dd=n(d("toolbar-height-change")),yn={fadeInClass:"tox-editor-dock-fadein",fadeOutClass:"tox-editor-dock-fadeout",transitionClass:"tox-editor-dock-transition"},gg="tox-tinymce--toolbar-sticky-on",pg="tox-tinymce--toolbar-sticky-off",ld=(e,t)=>_e(He.getModes(e),t),cd=e=>{const t=e.element;Ki(t).each(n=>{const s="padding-"+He.getModes(e)[0];if(He.isDocked(e)){const e=et(n);y(t,"width",e+"px"),y(n,s,(e=>Ks(e)+(parseInt(ft(e,"margin-top"),10)||0)+(parseInt(ft(e,"margin-bottom"),10)||0))(t)+"px")}else I(t,"width"),I(n,s)})},mg=(e,t)=>{t?(ie(e,yn.fadeOutClass),zs(e,[yn.transitionClass,yn.fadeInClass])):(ie(e,yn.fadeInClass),zs(e,[yn.fadeOutClass,yn.transitionClass]))},hg=(e,t)=>{const n=l(e.getContainer());t?(me(n,gg),ie(n,pg)):(me(n,pg),ie(n,gg))},lg=(t,n)=>{const s=q(),i=n.getSink,o=e=>{i().each(t=>e(t.element))},a=e=>{t.inline||cd(e),hg(t,He.isDocked(e)),e.getSystem().broadcastOn([ci()],{}),i().each(e=>e.getSystem().broadcastOn([ci()],{}))},r=t.inline?[]:[Vt.config({channels:{[dd()]:{onReceive:cd}}})];return[b.config({}),He.config({contextual:{lazyContext:n=>{const o=Ks(n.element),i=t.inline?t.getContentAreaContainer():t.getContainer(),s=it(l(i)),a=s.height-o,r=s.y+(ld(n,"top")?0:o);return e.some(Ve(s.x,r,s.width,a))},onShow:()=>{o(e=>mg(e,!0))},onShown:e=>{o(e=>mn(e,[yn.transitionClass,yn.fadeInClass])),s.get().each(t=>{((e,t)=>{const n=rn(t);Wn(n).filter(e=>!G(t,e)).filter(t=>G(t,l(n.dom.body))||Zr(e,t)).each(()=>Xn(t))})(e.element,t),s.clear()})},onHide:e=>{((e,t)=>Jt(e).orThunk(()=>t().toOptional().bind(e=>Jt(e.element))))(e.element,i).fold(s.clear,s.set),o(e=>mg(e,!1))},onHidden:()=>{o(e=>mn(e,[yn.transitionClass]))},...yn},lazyViewport:e=>{const n=Sn(),s=g3(t),o=n.y+(ld(e,"top")?s:0),i=n.height-(ld(e,"bottom")?s:0);return Ve(n.x,o,n.width,i)},modes:[n.header.getDockingMode()],onDocked:a,onUndocked:a}),...r]};ng=Object.freeze({__proto__:null,setup:(e,t,n)=>{e.inline||(t.header.isPositionedAtTop()||e.on("ResizeEditor",()=>{n().each(He.reset)}),e.on("ResizeWindow ResizeEditor",()=>{n().each(cd)}),e.on("SkinLoaded",()=>{n().each(e=>{He.isDocked(e)?He.reset(e):He.refresh(e)})}),e.on("FullscreenStateChanged",()=>{n().each(He.reset)})),e.on("AfterScrollIntoView",e=>{n().each(t=>{He.refresh(t);const n=t.element;f8(n)&&((e,t)=>{const i=rn(t),d=Vi(t).dom.innerHeight,n=bn(i),r=l(e.elm),h=Is(r),c=Pe(r),s=h.y,m=s+c,f=ls(t),o=Pe(t),a=f.top,u=a+o,p=Math.abs(a-n.top)<2,g=Math.abs(u-(n.top+d))<2;if(p&&s<u)H3(n.left,s-o,i);else if(g&&m>a){const e=s-d+c+o;H3(n.left,e,i)}})(e,n)})}),e.on("PostRender",()=>{hg(e,!1)})},isDocked:e=>e().map(He.isDocked).getOr(!1),getBehaviours:lg});const A9=m([se,vt("items",td([od([C1,St("items",Ee)]),Ee]))].concat(_a)),S9=[nt("text"),nt("tooltip"),nt("icon"),Mt("search",!1,td([ca,m([nt("placeholder")])],t=>Tn(t)?t?e.some({placeholder:e.none()}):e.none():e.some(t))),Rt("fetch"),ue("onSetup",()=>c)],M9=m([se,...S9]),eg=e=>X("menubutton",M9,e),T9=m([se,qa,un,Do,N_,G_,io,zn("presets","normal",["normal","color","listpreview"]),im(1),No,K_]);cr=pt({factory:(t,n)=>{const s={focus:u.focusIn,setMenus:(t,s)=>{const o=a(s,t=>{const s={type:"menubutton",text:t.text,fetch:e=>{e(t.getItems())}},o=eg(s).mapError(e=>Bo(e)).getOrDie();return Td(o,"tox-mbtn",n.backstage,e.some("menuitem"))});j.set(t,o)}};return{uid:t.uid,dom:t.dom,components:[],behaviours:i([j.config({}),w("menubar-events",[Q(e=>{t.onSetup(e)}),o(As(),(e,t)=>{pe(e.element,".tox-mbtn--active").each(n=>{hn(t.event.target,".tox-mbtn").each(t=>{G(n,t)||e.getSystem().getByDom(n).each(n=>{e.getSystem().getByDom(t).each(e=>{Et.expand(e),Et.close(n),b.focus(e)})})})})}),o(jp(),(e,t)=>{t.event.prevFocus.bind(t=>e.getSystem().getByDom(t).toOptional()).each(n=>{t.event.newFocus.bind(t=>e.getSystem().getByDom(t).toOptional()).each(e=>{Et.isOpen(n)&&(Et.expand(e),Et.close(n))})})})]),u.config({mode:"flow",selector:".tox-mbtn",onEscape:n=>(t.onEscape(n),e.some(!0))}),Z.config({})]),apis:s,domModification:{attributes:{role:"menubar"}}}},name:"silver.Menubar",configFields:[s("dom"),s("uid"),s("onEscape"),s("backstage"),t("onSetup",c)],apis:{focus:(e,t)=>{e.focus(t)},setMenus:(e,t,n)=>{e.setMenus(t,n)}}});const ha=(e,t)=>t.getAnimationRoot.fold(()=>e.element,t=>t(e)),Qn=e=>e.dimension.property,Ds=(e,t)=>e.dimension.getDimension(t),vr=(e,t)=>{const n=ha(e,t);mn(n,[t.shrinkingClass,t.growingClass])},ad=(e,t)=>{ie(e.element,t.openClass),me(e.element,t.closedClass),y(e.element,Qn(t),"0px"),Ai(e.element)},id=(e,t)=>{ie(e.element,t.closedClass),me(e.element,t.openClass),I(e.element,Qn(t))},Vp=(e,t,n)=>{n.setCollapsed(),y(e.element,Qn(t),Ds(t,e.element)),vr(e,t),ad(e,t),t.onStartShrink(e),t.onShrunk(e)},B9=(e,t,n,s)=>{const i=s.getOrThunk(()=>Ds(t,e.element));n.setCollapsed(),y(e.element,Qn(t),i),Ai(e.element);const o=ha(e,t);ie(o,t.growingClass),me(o,t.shrinkingClass),ad(e,t),t.onStartShrink(e)},Bp=(t,n,s)=>{const o=Ds(n,t.element);("0px"===o?Vp:B9)(t,n,s,e.some(o))},Np=(e,t,n)=>{const s=ha(e,t),o=mt(s,t.shrinkingClass),i=Ds(t,e.element);id(e,t);const a=Ds(t,e.element);(o?()=>{y(e.element,Qn(t),i),Ai(e.element)}:()=>{ad(e,t)})(),ie(s,t.shrinkingClass),me(s,t.growingClass),id(e,t),y(e.element,Qn(t),a),n.setExpanded(),t.onStartGrow(e)},Cp=(e,t)=>{const s=ha(e,t);return!0===mt(s,t.growingClass)},xp=(e,t)=>{const s=ha(e,t);return!0===mt(s,t.shrinkingClass)};var K9=Object.freeze({__proto__:null,refresh:(e,t,n)=>{if(n.isExpanded()){I(e.element,Qn(t));const n=Ds(t,e.element);y(e.element,Qn(t),n)}},grow:(e,t,n)=>{n.isExpanded()||Np(e,t,n)},shrink:(e,t,n)=>{n.isExpanded()&&Bp(e,t,n)},immediateShrink:(e,t,n)=>{n.isExpanded()&&Vp(e,t,n)},hasGrown:(e,t,n)=>n.isExpanded(),hasShrunk:(e,t,n)=>n.isCollapsed(),isGrowing:Cp,isShrinking:xp,isTransitioning:(e,t)=>Cp(e,t)||xp(e,t),toggleGrow:(e,t,n)=>{(n.isExpanded()?Bp:Np)(e,t,n)},disableTransitions:vr,immediateGrow:(e,t,n)=>{n.isExpanded()||(id(e,t),y(e.element,Qn(t),Ds(t,e.element)),vr(e,t),n.setExpanded(),t.onStartGrow(e),t.onGrown(e))}}),q9=Object.freeze({__proto__:null,exhibit:(e,t)=>{const s=t.expanded;return Zt(s?{classes:[t.openClass],styles:{}}:{classes:[t.closedClass],styles:jo(t.dimension.property,"0px")})},events:(e,t)=>$([Ko(Di(),(n,s)=>{s.event.raw.propertyName===e.dimension.property&&(vr(n,e),t.isExpanded()&&I(n.element,e.dimension.property),(t.isExpanded()?e.onGrown:e.onShrunk)(n))})])}),Y9=[s("closedClass"),s("openClass"),s("shrinkingClass"),s("growingClass"),D("getAnimationRoot"),C("onShrunk"),C("onStartShrink"),C("onGrown"),C("onStartGrow"),t("expanded",!1),vt("dimension",lt("property",{width:[W("property","width"),W("getDimension",e=>et(e)+"px")],height:[W("property","height"),W("getDimension",e=>Pe(e)+"px")]}))];const $t=we({fields:Y9,name:"sliding",active:q9,apis:K9,state:Object.freeze({__proto__:null,init:e=>{const t=v(e.expanded);return jt({isExpanded:()=>!0===t.get(),isCollapsed:()=>!1===t.get(),setCollapsed:Nt(t.set,!1),setExpanded:Nt(t.set,!0),readState:()=>"expanded: "+t.get()})}})}),wp="container",Q9=[fe("slotBehaviours",[])],_p=e=>"<alloy.field."+e+">",J9=(e,t)=>{const o=t=>rf(e),n=(t,n)=>(s,o)=>P(s,e,o).map(e=>t(e,o)).getOr(n),s=(e)=>"true"!==Ne(e.element,"aria-hidden"),r=n(s,!1),i=n((e,t)=>{if(s(e)){const n=e.element;y(n,"display","none"),_(n,"aria-hidden","true"),p(e,_u(),{name:t,visible:!1})}}),c=(a=i,(e,t)=>{h(t,t=>a(e,t))});var a;const l=n((e,t)=>{if(!s(e)){const n=e.element;I(n,"display"),ve(n,"aria-hidden"),p(e,_u(),{name:t,visible:!0})}}),d={getSlotNames:o,getSlot:(t,n)=>P(t,e,n),isShowing:r,hideSlot:i,hideAllSlots:e=>c(e,o()),showSlot:l};return{uid:e.uid,dom:e.dom,components:t,behaviours:iu(e.slotBehaviours),apis:d}},eb=je({getSlotNames:(e,t)=>e.getSlotNames(t),getSlot:(e,t,n)=>e.getSlot(t,n),isShowing:(e,t,n)=>e.isShowing(t,n),hideSlot:(e,t,n)=>e.hideSlot(t,n),hideAllSlots:(e,t)=>e.hideAllSlots(t),showSlot:(e,t,n)=>e.showSlot(t,n)},e=>or(e)),Te={...eb,sketch:e=>{const t=(()=>{const e=[];return{slot:(t,n)=>(e.push(t),Iu(wp,_p(t),n)),record:n(e)}})(),s=e(t),o=t.record(),i=a(o,e=>Fe({name:e,pname:_p(e)}));return t1(wp,Q9,i,J9,s)}},nb=m([un,qa,ue("onShow",c),ue("onHide",c),io]),sb=e=>({element:()=>e.element.dom}),ob=(e,t)=>{const n=a(ce(t),e=>{const s=t[e],n=an((e=>X("sidebar",nb,e))(s));return{name:e,getApi:sb,onSetup:n.onSetup,onShow:n.onShow,onHide:n.onHide}});return a(n,t=>{const s=v(c);return e.slot(t.name,{dom:{tag:"div",classes:["tox-sidebar__pane"]},behaviours:ja([na(t,s),ka(t,s),o(_u(),(e,t)=>{const s=t.event,o=ne(n,e=>e.name===s.name);o.each(t=>{(s.visible?t.onShow:t.onHide)(t.getApi(e))})})])})})},ib=e=>Te.sketch(t=>({dom:{tag:"div",classes:["tox-sidebar__pane-container"]},components:ob(t,e),slotBehaviours:ja([Q(e=>Te.hideAllSlots(e))])})),ab=t=>O.getCurrent(t).bind(t=>$t.isGrowing(t)||$t.hasGrown(t)?O.getCurrent(t).bind(e=>ne(Te.getSlotNames(e),t=>Te.isShowing(e,t))):e.none()),sd=d("FixSizeEvent"),nd=d("AutoSizeEvent");mp=Object.freeze({__proto__:null,block:(t,n,s,o)=>{_(t.element,"aria-busy",!0);const a=n.getRoot(t).getOr(t),c=i([u.config({mode:"special",onTab:()=>e.some(!0),onShiftTab:()=>e.some(!0)}),b.config({})]),l=o(a,c),r=a.getSystem().build(l);j.append(a,Pt(r)),r.hasConfigured(u)&&n.focus&&u.focusIn(r),s.isBlocked()||n.onBlock(t),s.blockWith(()=>j.remove(a,r))},unblock:(e,t,n)=>{ve(e.element,"aria-busy"),n.isBlocked()&&t.onUnblock(e),n.clear()}}),hp=[ue("getRoot",e.none),ht("focus",!0),C("onBlock"),C("onUnblock")];const Jn=we({fields:hp,name:"blocking",apis:mp,state:Object.freeze({__proto__:null,init:()=>{const e=cl(e=>e.destroy());return jt({readState:e.isSet,blockWith:t=>{e.set({destroy:t})},clear:e.clear,isBlocked:e.isSet})}})}),ss=e=>{const t=C9(e),n=On(t),s=(e=>{const t=void 0!==e.dom.attributes?e.dom.attributes:[];return Ie(t,(e,t)=>"class"===t.name?e:{...e,[t.name]:t.value},{})})(t),o=(e=>Array.prototype.slice.call(e.dom.classList,0))(t),i=0===n.length?{}:{innerHtml:Vu(t)};return{tag:qn(t),classes:o,attributes:s,...i}},dp=e=>O.getCurrent(e).each(e=>Xn(e.element)),fb=(t,n,s)=>{const o=v(!1),i=q(),a=s=>{var i;o.get()&&(!(e=>"focusin"===e.type)(i=s)||!(i.composed?Zn(i.composedPath()):e.from(i.target)).map(l).filter(Ot).exists(e=>mt(e,"mce-pastebin")))&&(s.preventDefault(),dp(n()),t.editorManager.setActive(t))};t.inline||t.on("PreInit",()=>{t.dom.bind(t.getWin(),"focusin",a),t.on("BeforeExecCommand",e=>{"mcefocus"===e.command.toLowerCase()&&!0!==e.value&&a(e)})});const r=i=>{i!==o.get()&&(o.set(i),((t,n,s,o)=>{const i=n.element;if(((t,n)=>{const s="tabindex",o="data-mce-tabindex";e.from(t.iframeElement).map(l).each(e=>{n?(_t(e,s).each(t=>_(e,o,t)),_(e,s,-1)):(ve(e,s),_t(e,o).each(t=>{_(e,s,t),ve(e,o)}))})})(t,s),s)Jn.block(n,(e=>()=>({dom:{tag:"div",attributes:{"aria-label":e.translate("Loading..."),tabindex:"0"},classes:["tox-throbber__busy-spinner"]},components:[{dom:ss('<div class="tox-spinner"><div></div><div></div><div></div></div>')}]}))(o)),I(i,"display"),ve(i,"aria-hidden"),t.hasFocus()&&dp(n);else{const e=O.getCurrent(n).exists(e=>jg(e.element));Jn.unblock(n),y(i,"display","none"),_(i,"aria-hidden","true"),e&&t.focus()}})(t,n(),i,s.providers),((e,t)=>{e.dispatch("AfterProgressState",{state:t})})(t,i))};t.on("ProgressState",e=>{if(i.on(clearTimeout),Ss(e.time)){const n=ia.setEditorTimeout(t,()=>r(e.state),e.time);i.set(n)}else r(e.state),i.clear()})},ed=(e,t,n)=>({within:e,extra:t,withinWidth:n}),cp=(t,s,o)=>{const a=Ie(t,(t,s)=>((t,n)=>{const s=o(t);return e.some({element:t,start:n,finish:n+s,width:s})})(s,t.len).fold(n(t),e=>({len:e.finish,list:t.list.concat([e])})),{len:0,list:[]}).list,i=K(a,e=>e.finish<=s),r=To(i,(e,t)=>e+t.width,0);return{within:i,extra:a.slice(i.length),withinWidth:r}},xr=e=>a(e,e=>e.element),ep=(e,t)=>{const n=a(t,e=>Pt(e));pn.setGroups(e,n)},J6=(t,n,s)=>{const r=n.builtGroups.get();if(0===r.length)return;const o=kn(t,n,"primary"),i=Y.getCoupled(t,"overflowGroup");y(o.element,"visibility","hidden");const c=r.concat([i]),l=wn(c,e=>Jt(e.element).bind(t=>e.getSystem().getByDom(t).toOptional()));s([]),ep(o,c);const a=((t,n,s,o)=>{const a=((t,n,s)=>{const o=cp(n,t,s);return 0===o.extra.length?e.some(o):e.none()})(t,n,s).getOrThunk(()=>cp(n,t-s(o),s)),r=a.within,i=a.extra,c=a.withinWidth;return 1===i.length&&i[0].width<=s(o)?((e,t,n)=>{const s=xr(e.concat(t));return ed(s,[],n)})(r,i,c):i.length>=1?((e,t,n,s)=>{const o=xr(e).concat([n]);return ed(o,xr(t),s)})(r,i,o,c):((e,t,n)=>ed(xr(e),[],n))(r,0,c)})(et(o.element),n.builtGroups.get(),e=>et(e.element),i);0===a.extra.length?(j.remove(o,i),s([])):(ep(o,a.within),s(a.extra)),I(o.element,"visibility"),Ai(o.element),l.each(b.focus)},Z6=n([fe("splitToolbarBehaviours",[Y]),We("builtGroups",()=>v([]))]),_b=n([$s(["overflowToggledClass"]),Ia("getOverflowBounds"),s("lazySink"),We("overflowGroups",()=>v([])),C("onOpened"),C("onClosed")].concat(Z6())),wb=n([Fe({factory:pn,schema:yo(),name:"primary"}),Lt({schema:yo(),name:"overflow"}),Lt({name:"overflow-button"}),Lt({name:"overflow-group"})]),Jl=n((e,t)=>{((e,t)=>{const n=Xa.max(e,t,["margin-left","border-left-width","padding-left","padding-right","border-right-width","margin-right"]);y(e,"max-width",n+"px")})(e,Math.floor(t))}),xb=n([$s(["toggledClass"]),s("lazySink"),Rt("fetch"),Ia("getBounds"),bt("fireDismissalEventInstead",[t("event",di())]),hs(),C("onToggled")]),Cb=n([Lt({name:"button",overrides:e=>({dom:{attributes:{"aria-haspopup":"true"}},buttonBehaviours:i([A.config({toggleClass:e.markers.toggledClass,aria:{mode:"expanded"},toggleOnExecute:!1,onToggled:e.onToggled})])})}),Lt({factory:pn,schema:yo(),name:"toolbar",overrides:t=>({toolbarBehaviours:i([u.config({mode:"cyclic",onEscape:n=>(P(n,t,"button").each(b.focus),e.none())})])})})]),K6=(e,t)=>{const n=Y.getCoupled(e,"toolbarSandbox");k.isOpen(n)?k.close(n):k.open(n,t.toolbar())},Zl=(e,t,n,s)=>{const o=n.getBounds.map(e=>e()),i=n.lazySink(e).getOrDie();Ye.positionWithinBounds(i,t,{anchor:{type:"hotspot",hotspot:e,layouts:s,overrides:{maxWidthFunction:Jl()}}},o)},V6=(e,t,n,s,o)=>{pn.setGroups(t,o),Zl(e,t,n,s),A.on(e)},eo=Be({name:"FloatingToolbarButton",factory:(t,n,s,o)=>({...Je.sketch({...o.button(),action:e=>{K6(e,o)},buttonBehaviours:ni({dump:o.button().buttonBehaviours},[Y.config({others:{toolbarSandbox:n=>((t,n,s)=>{const o=G2();return{dom:{tag:"div",attributes:{id:o.id}},behaviours:i([u.config({mode:"special",onEscape:t=>(k.close(t),e.some(!0))}),k.config({onOpen:(e,i)=>{s.fetch().get(e=>{V6(t,i,s,n.layouts,e),o.link(t.element),u.focusIn(i)})},onClose:()=>{A.off(t),b.focus(t),o.unlink(t.element)},isPartOf:(e,n,s)=>Ps(n,s)||Ps(t,s),getAttachPoint:()=>s.lazySink(t).getOrDie()}),Vt.config({channels:{...Vd({isExtraPart:U,...s.fireDismissalEventInstead.map(e=>({fireEventInstead:{event:e.event}})).getOr({})}),...Wd({doReposition:()=>{k.getState(Y.getCoupled(t,"toolbarSandbox")).each(e=>{Zl(t,e,s,n.layouts)})}})}})])}})(n,s,t)}})])}),apis:{setGroups:(e,n)=>{k.getState(Y.getCoupled(e,"toolbarSandbox")).each(o=>{V6(e,o,t,s.layouts,n)})},reposition:e=>{k.getState(Y.getCoupled(e,"toolbarSandbox")).each(n=>{Zl(e,n,t,s.layouts)})},toggle:e=>{K6(e,o)},getToolbar:e=>k.getState(Y.getCoupled(e,"toolbarSandbox")),isOpen:e=>k.isOpen(Y.getCoupled(e,"toolbarSandbox"))}}),configFields:xb(),partFields:Cb(),apis:{setGroups:(e,t,n)=>{e.setGroups(t,n)},reposition:(e,t)=>{e.reposition(t)},toggle:(e,t)=>{e.toggle(t)},getToolbar:(e,t)=>e.getToolbar(t),isOpen:(e,t)=>e.isOpen(t)}}),Mb=n([s("items"),$s(["itemSelector"]),fe("tgroupBehaviours",[u])]),Fb=n([dc({name:"items",unit:"item"})]),Cr=Be({name:"ToolbarGroup",configFields:Mb(),partFields:Fb(),factory:(e,t)=>({uid:e.uid,dom:e.dom,components:t,behaviours:ye(e.tgroupBehaviours,[u.config({mode:"flow",selector:e.markers.itemSelector})]),domModification:{attributes:{role:"toolbar"}}})}),H6=e=>a(e,e=>Pt(e)),R6=(e,t,n)=>{J6(e,n,s=>{n.overflowGroups.set(s),t.getOpt(e).each(e=>{eo.setGroups(e,H6(s))})})},D6=Be({name:"SplitFloatingToolbar",configFields:_b(),partFields:wb(),factory:(e,t,n,s)=>{const o=V(eo.sketch({fetch:()=>Fs(t=>{t(H6(e.overflowGroups.get()))}),layouts:{onLtr:()=>[De,ze],onRtl:()=>[ze,De],onBottomLtr:()=>[Xe,Qe],onBottomRtl:()=>[Qe,Xe]},getBounds:n.getOverflowBounds,lazySink:e.lazySink,fireDismissalEventInstead:{},markers:{toggledClass:e.markers.overflowToggledClass},parts:{button:s["overflow-button"](),toolbar:s.overflow()},onToggled:(t,n)=>e[n?"onOpened":"onClosed"](t)}));return{uid:e.uid,dom:e.dom,components:t,behaviours:ye(e.splitToolbarBehaviours,[Y.config({others:{overflowGroup:()=>Cr.sketch({...s["overflow-group"](),items:[o.asSpec()]})}})]),apis:{setGroups:(t,n)=>{e.builtGroups.set(a(n,t.getSystem().build)),R6(t,o,e)},refresh:t=>R6(t,o,e),toggle:e=>{o.getOpt(e).each(e=>{eo.toggle(e)})},isOpen:e=>o.getOpt(e).map(eo.isOpen).getOr(!1),reposition:e=>{o.getOpt(e).each(e=>{eo.reposition(e)})},getOverflow:e=>o.getOpt(e).bind(eo.getToolbar)},domModification:{attributes:{role:"group"}}}},apis:{setGroups:(e,t,n)=>{e.setGroups(t,n)},refresh:(e,t)=>{e.refresh(t)},reposition:(e,t)=>{e.reposition(t)},toggle:(e,t)=>{e.toggle(t)},isOpen:(e,t)=>e.isOpen(t),getOverflow:(e,t)=>e.getOverflow(t)}}),Lb=n([$s(["closedClass","openClass","shrinkingClass","growingClass","overflowToggledClass"]),C("onOpened"),C("onClosed")].concat(Z6())),Rb=n([Fe({factory:pn,schema:yo(),name:"primary"}),Fe({factory:pn,schema:yo(),name:"overflow",overrides:t=>({toolbarBehaviours:i([$t.config({dimension:{property:"height"},closedClass:t.markers.closedClass,openClass:t.markers.openClass,shrinkingClass:t.markers.shrinkingClass,growingClass:t.markers.growingClass,onShrunk:e=>{P(e,t,"overflow-button").each(e=>{A.off(e),b.focus(e)}),t.onClosed(e)},onGrown:e=>{u.focusIn(e),t.onOpened(e)},onStartGrow:e=>{P(e,t,"overflow-button").each(A.on)}}),u.config({mode:"acyclic",onEscape:n=>(P(n,t,"overflow-button").each(b.focus),e.some(!0))})])})}),Lt({name:"overflow-button",overrides:e=>({buttonBehaviours:i([A.config({toggleClass:e.markers.overflowToggledClass,aria:{mode:"pressed"},toggleOnExecute:!1})])})}),Lt({name:"overflow-group"})]),F6=(e,t)=>{P(e,t,"overflow-button").bind(()=>P(e,t,"overflow")).each(n=>{Ql(e,t),$t.toggleGrow(n)})},Ql=(e,t)=>{P(e,t,"overflow").each(n=>{J6(e,t,e=>{const t=a(e,e=>Pt(e));pn.setGroups(n,t)}),P(e,t,"overflow-button").each(e=>{$t.hasGrown(n)&&A.on(e)}),$t.refresh(n)})},Xl=Be({name:"SplitSlidingToolbar",configFields:Lb(),partFields:Rb(),factory:(e,t,n,s)=>{const i="alloy.toolbar.toggle";return{uid:e.uid,dom:e.dom,components:t,behaviours:ye(e.splitToolbarBehaviours,[Y.config({others:{overflowGroup:e=>Cr.sketch({...s["overflow-group"](),items:[Je.sketch({...s["overflow-button"](),action:t=>{T(e,i)}})]})}}),w("toolbar-toggle-events",[o(i,t=>{F6(t,e)})])]),apis:{setGroups:(t,n)=>{((t,n)=>{const s=a(n,t.getSystem().build);e.builtGroups.set(s)})(t,n),Ql(t,e)},refresh:t=>Ql(t,e),toggle:t=>F6(t,e),isOpen:t=>((e,t)=>P(e,t,"overflow").map($t.hasGrown).getOr(!1))(t,e)},domModification:{attributes:{role:"group"}}}},apis:{setGroups:(e,t,n)=>{e.setGroups(t,n)},refresh:(e,t)=>{e.refresh(t)},toggle:(e,t)=>{e.toggle(t)},isOpen:(e,t)=>e.isOpen(t)}}),O6=e=>{const t=e.title.fold(()=>({}),e=>({attributes:{title:e}}));return{dom:{tag:"div",classes:["tox-toolbar__group"],...t},components:[Cr.parts.items({})],items:e.items,markers:{itemSelector:"*:not(.tox-split-button) > .tox-tbtn:not([disabled]), .tox-split-button:not([disabled]), .tox-toolbar-nav-js:not([disabled])"},tgroupBehaviours:i([Z.config({}),b.config({})])}},Er=e=>Cr.sketch(O6(e)),m6=(e,t)=>{const n=Q(t=>{const n=a(e.initGroups,Er);pn.setGroups(t,n)});return i([h1(e.providers.isDisabled),re(),u.config({mode:t,onEscape:e.onEscape,selector:".tox-toolbar__group"}),w("toolbar-events",[n])])},d6=t=>{const n=t.cyclicKeying?"cyclic":"acyclic";return{uid:t.uid,dom:{tag:"div",classes:["tox-toolbar-overlord"]},parts:{"overflow-group":O6({title:e.none(),items:[]}),"overflow-button":U7({name:"more",icon:e.some("more-drawer"),enabled:!0,tooltip:e.some("More..."),primary:!1,buttonType:e.none(),borderless:!1},e.none(),t.providers)},splitToolbarBehaviours:m6(t,n)}},Ub=e=>{const t=d6(e),n=D6.parts.primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}});return D6.sketch({...t,lazySink:e.getSink,getOverflowBounds:()=>{const t=e.moreDrawerData.lazyHeader().element,n=Is(t),s=B1(t),o=Is(s),i=Math.max(s.dom.scrollHeight,o.height);return Ve(n.x+4,o.y,n.width-8,i)},parts:{...t.parts,overflow:{dom:{tag:"div",classes:["tox-toolbar__overflow"],attributes:e.attributes}}},components:[n],markers:{overflowToggledClass:"tox-tbtn--enabled"},onOpened:t=>e.onToggled(t,!0),onClosed:t=>e.onToggled(t,!1)})},Kb=e=>{const t=Xl.parts.primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}}),n=Xl.parts.overflow({dom:{tag:"div",classes:["tox-toolbar__overflow"]}}),s=d6(e);return Xl.sketch({...s,components:[t,n],markers:{openClass:"tox-toolbar__overflow--open",closedClass:"tox-toolbar__overflow--closed",growingClass:"tox-toolbar__overflow--growing",shrinkingClass:"tox-toolbar__overflow--shrinking",overflowToggledClass:"tox-tbtn--enabled"},onOpened:t=>{t.getSystem().broadcastOn([dd()],{type:"opened"}),e.onToggled(t,!0)},onClosed:t=>{t.getSystem().broadcastOn([dd()],{type:"closed"}),e.onToggled(t,!1)}})},Gl=e=>{const t=e.cyclicKeying?"cyclic":"acyclic";return pn.sketch({uid:e.uid,dom:{tag:"div",classes:["tox-toolbar"].concat(e.type===kt.scrolling?["tox-toolbar--scrolling"]:[])},components:[pn.parts.groups({})],toolbarBehaviours:m6(e,t)})},Yb=[pi("type",["button"]),In,zn("buttonType","secondary",["primary","secondary"]),Rt("onAction")],Gb=lt("type",{button:Yb}),Xb=m([rr("buttons",[],Gb),Rt("onShow"),Rt("onHide")]);no=Be({name:"silver.View",configFields:[s("viewConfig")],partFields:[wt({factory:{sketch:t=>{const n=a(t.buttons,n=>((t,n)=>Fd({text:t.text,enabled:!0,primary:!1,name:"name",icon:e.none(),borderless:!1,buttonType:e.some(t.buttonType)},e=>{t.onAction()},n))(n,t.providers));return{uid:t.uid,dom:{tag:"div",classes:["tox-view__header"]},components:[tn.sketch({dom:{tag:"div",classes:["tox-view__header-start"]},components:[]}),tn.sketch({dom:{tag:"div",classes:["tox-view__header-end"]},components:n})]}}},schema:[s("buttons"),s("providers")],name:"header"}),wt({factory:{sketch:e=>({uid:e.uid,dom:{tag:"div",classes:["tox-view__pane"]}})},schema:[],name:"pane"})],factory:(e,t)=>{const o={getPane:t=>ge.getPart(t,e,"pane"),getOnShow:t=>e.viewConfig.onShow,getOnHide:t=>e.viewConfig.onHide};return{uid:e.uid,dom:e.dom,components:t,apis:o}},apis:{getPane:(e,t)=>e.getPane(t),getOnShow:(e,t)=>e.getOnShow(t),getOnHide:(e,t)=>e.getOnHide(t)}});const Zb=(e,t,n)=>Kr(t,(t,s)=>{const o=an(X("view",Xb,t));return e.slot(s,no.sketch({dom:{tag:"div",classes:["tox-view"]},viewConfig:o,components:[...o.buttons.length>0?[no.parts.header({buttons:o.buttons,providers:n})]:[],no.parts.pane({})]}))}),Jb=(e,t)=>Te.sketch(n=>({dom:{tag:"div",classes:["tox-view-wrap__slot-container"]},components:Zb(n,e,t),slotBehaviours:ja([Q(e=>Te.hideAllSlots(e))])})),c6=e=>ne(Te.getSlotNames(e),t=>Te.isShowing(e,t)),r6=(e,t,s)=>{Te.getSlot(e,t).each(e=>{no.getPane(e).each(t=>{var o;s(e)((o=t.element.dom,{getContainer:n(o)}))})})};Gi=pt({factory:(e,t)=>{const n={setViews:(e,n)=>{j.set(e,[Jb(n,t.backstage.shared.providers)])},whichView:e=>O.getCurrent(e).bind(c6),toggleView:(e,t,n,s)=>O.getCurrent(e).exists(o=>{const i=c6(o),r=i.exists(e=>s===e),a=Te.getSlot(o,s).isSome();return a&&(Te.hideAllSlots(o),r?((e=>{const t=e.element;y(t,"display","none"),_(t,"aria-hidden","true")})(e),t()):(n(),(e=>{const t=e.element;I(t,"display"),ve(t,"aria-hidden")})(e),Te.showSlot(o,s),((e,t)=>{r6(e,t,no.getOnShow)})(o,s)),i.each(e=>((e,t)=>r6(e,t,no.getOnHide))(o,e))),a})};return{uid:e.uid,dom:{tag:"div",classes:["tox-view-wrap"],attributes:{"aria-hidden":"true"},styles:{display:"none"}},components:[],behaviours:i([j.config({}),O.config({find:e=>{const t=j.contents(e);return Zn(t)}})]),apis:n}},name:"silver.ViewWrapper",configFields:[s("backstage")],apis:{setViews:(e,t,n)=>e.setViews(t,n),toggleView:(e,t,n,s,o)=>e.toggleView(t,n,s,o),whichView:(e,t)=>e.whichView(t)}});const sj=vn.optional({factory:cr,name:"menubar",schema:[s("backstage")]}),oj=vn.optional({factory:{sketch:t=>Jg.sketch({uid:t.uid,dom:t.dom,listBehaviours:i([u.config({mode:"acyclic",selector:".tox-toolbar"})]),makeItem:()=>Gl({type:t.type,uid:d("multiple-toolbar-item"),cyclicKeying:!1,initGroups:[],providers:t.providers,onEscape:()=>(t.onEscape(),e.some(!0))}),setupItem:(e,t,n)=>{pn.setGroups(t,n)},shell:!0})},name:"multiple-toolbar",schema:[s("dom"),s("onEscape")]}),ij=vn.optional({factory:{sketch:t=>{const n=(e=>e.type===kt.sliding?Kb:e.type===kt.floating?Ub:Gl)(t);return n({type:t.type,uid:t.uid,onEscape:()=>(t.onEscape(),e.some(!0)),onToggled:(e,n)=>t.onToolbarToggled(n),cyclicKeying:!1,initGroups:[],getSink:t.getSink,providers:t.providers,moreDrawerData:{lazyToolbar:t.lazyToolbar,lazyMoreButton:t.lazyMoreButton,lazyHeader:t.lazyHeader},attributes:t.attributes})}},name:"toolbar",schema:[s("dom"),s("onEscape"),s("getSink")]}),aj=vn.optional({factory:{sketch:e=>{const t=e.editor,n=e.sticky?lg:Kg;return{uid:e.uid,dom:e.dom,components:e.components,behaviours:i(n(t,e.sharedBackstage))}}},name:"header",schema:[s("dom")]}),rj=vn.optional({factory:{sketch:e=>({uid:e.uid,dom:e.dom,components:[{dom:{tag:"a",attributes:{href:"https://www.tiny.cloud/tinymce-self-hosted-premium-features/?utm_source=TinyMCE&utm_medium=SPAP&utm_campaign=SPAP&utm_id=editorreferral",rel:"noopener",target:"_blank","aria-hidden":"true"},classes:["tox-promotion-link"],innerHtml:"Upgrade"}}]})},name:"promotion",schema:[s("dom")]}),cj=vn.optional({name:"socket",schema:[s("dom")]}),lj=vn.optional({factory:{sketch:e=>({uid:e.uid,dom:{tag:"div",classes:["tox-sidebar"],attributes:{role:"complementary"}},components:[{dom:{tag:"div",classes:["tox-sidebar__slider"]},components:[],behaviours:i([Z.config({}),b.config({}),$t.config({dimension:{property:"width"},closedClass:"tox-sidebar--sliding-closed",openClass:"tox-sidebar--sliding-open",shrinkingClass:"tox-sidebar--sliding-shrinking",growingClass:"tox-sidebar--sliding-growing",onShrunk:e=>{O.getCurrent(e).each(Te.hideAllSlots),T(e,nd)},onGrown:e=>{T(e,nd)},onStartGrow:e=>{p(e,sd,{width:Le(e.element,"width").getOr("")})},onStartShrink:e=>{p(e,sd,{width:et(e.element)+"px"})}}),j.config({}),O.config({find:e=>{const t=j.contents(e);return Zn(t)}})])}],behaviours:i([Zd(0),w("sidebar-sliding-events",[o(sd,(e,t)=>{y(e.element,"width",t.event.width)}),o(nd,(e)=>{I(e.element,"width")})])])})},name:"sidebar",schema:[s("dom")]}),dj=vn.optional({factory:{sketch:e=>({uid:e.uid,dom:{tag:"div",attributes:{"aria-hidden":"true"},classes:["tox-throbber"],styles:{display:"none"}},behaviours:i([j.config({}),Jn.config({focus:!1}),O.config({find:e=>Zn(e.components())})]),components:[]})},name:"throbber",schema:[s("dom")]}),uj=vn.optional({factory:Gi,name:"viewWrapper",schema:[s("backstage")]}),hj=vn.optional({factory:{sketch:e=>({uid:e.uid,dom:{tag:"div",classes:["tox-editor-container"]},components:e.components})},name:"editorContainer",schema:[]});H=Be({name:"OuterContainer",factory:(t,n)=>{let i=!1;const o={getSocket:e=>ge.getPart(e,t,"socket"),setSidebar:(e,n,s)=>{ge.getPart(e,t,"sidebar").each(e=>((e,t,n)=>{O.getCurrent(e).each(e=>{j.set(e,[ib(t)]);const s=n?.toLowerCase();L(s)&&R(t,s)&&O.getCurrent(e).each(t=>{Te.showSlot(t,s),$t.immediateGrow(e),I(e.element,"width")})})})(e,n,s))},toggleSidebar:(e,n)=>{ge.getPart(e,t,"sidebar").each(e=>((e,t)=>{O.getCurrent(e).each(e=>{O.getCurrent(e).each(n=>{$t.hasGrown(e)?Te.isShowing(n,t)?$t.shrink(e):(Te.hideAllSlots(n),Te.showSlot(n,t)):(Te.hideAllSlots(n),Te.showSlot(n,t),$t.grow(e))})})})(e,n))},whichSidebar:e=>ge.getPart(e,t,"sidebar").bind(ab).getOrNull(),getHeader:e=>ge.getPart(e,t,"header"),getToolbar:e=>ge.getPart(e,t,"toolbar"),setToolbar:(e,n)=>{ge.getPart(e,t,"toolbar").each(e=>{const t=a(n,Er);e.getApis().setGroups(e,t)})},setToolbars:(e,n)=>{ge.getPart(e,t,"multiple-toolbar").each(e=>{const t=a(n,e=>a(e,Er));Jg.setItems(e,t)})},refreshToolbar:e=>{ge.getPart(e,t,"toolbar").each(e=>e.getApis().refresh(e))},toggleToolbarDrawer:n=>{ge.getPart(n,t,"toolbar").each(t=>{var n,s=e=>e(t);null!=(n=t.getApis().toggle)?e.some(s(n)):e.none()})},isToolbarDrawerToggled:n=>ge.getPart(n,t,"toolbar").bind(t=>e.from(t.getApis().isOpen).map(e=>e(t))).getOr(!1),getThrobber:e=>ge.getPart(e,t,"throbber"),focusToolbar:e=>{ge.getPart(e,t,"toolbar").orThunk(()=>ge.getPart(e,t,"multiple-toolbar")).each(e=>{u.focusIn(e)})},setMenubar:(e,n)=>{ge.getPart(e,t,"menubar").each(e=>{cr.setMenus(e,n)})},focusMenubar:e=>{ge.getPart(e,t,"menubar").each(e=>{cr.focus(e)})},setViews:(e,n)=>{ge.getPart(e,t,"viewWrapper").each(e=>{Gi.setViews(e,n)})},toggleView:(e,n)=>ge.getPart(e,t,"viewWrapper").exists(t=>Gi.toggleView(t,()=>o.showMainView(e),()=>o.hideMainView(e),n)),whichView:e=>ge.getPart(e,t,"viewWrapper").bind(Gi.whichView).getOrNull(),hideMainView:e=>{i=o.isToolbarDrawerToggled(e),i&&o.toggleToolbarDrawer(e),ge.getPart(e,t,"editorContainer").each(e=>{const t=e.element;y(t,"display","none"),_(t,"aria-hidden","true")})},showMainView:e=>{i&&o.toggleToolbarDrawer(e),ge.getPart(e,t,"editorContainer").each(e=>{const t=e.element;I(t,"display"),ve(t,"aria-hidden")})}};return{uid:t.uid,dom:t.dom,components:n,apis:o,behaviours:t.behaviours}},configFields:[s("dom"),s("behaviours")],partFields:[aj,sj,ij,oj,cj,lj,rj,dj,uj,hj],apis:{getSocket:(e,t)=>e.getSocket(t),setSidebar:(e,t,n,s)=>{e.setSidebar(t,n,s)},toggleSidebar:(e,t,n)=>{e.toggleSidebar(t,n)},whichSidebar:(e,t)=>e.whichSidebar(t),getHeader:(e,t)=>e.getHeader(t),getToolbar:(e,t)=>e.getToolbar(t),setToolbar:(e,t,n)=>{e.setToolbar(t,n)},setToolbars:(e,t,n)=>{e.setToolbars(t,n)},refreshToolbar:(e,t)=>e.refreshToolbar(t),toggleToolbarDrawer:(e,t)=>{e.toggleToolbarDrawer(t)},isToolbarDrawerToggled:(e,t)=>e.isToolbarDrawerToggled(t),getThrobber:(e,t)=>e.getThrobber(t),setMenubar:(e,t,n)=>{e.setMenubar(t,n)},focusMenubar:(e,t)=>{e.focusMenubar(t)},focusToolbar:(e,t)=>{e.focusToolbar(t)},setViews:(e,t,n)=>{e.setViews(t,n)},toggleView:(e,t,n)=>e.toggleView(t,n),whichView:(e,t)=>e.whichView(t)}});const n6={file:{title:"File",items:"newdocument restoredraft | preview | export print | deleteallconversations"},edit:{title:"Edit",items:"undo redo | cut copy paste pastetext | selectall | searchreplace"},view:{title:"View",items:"code | visualaid visualchars visualblocks | spellchecker | preview fullscreen | showcomments"},insert:{title:"Insert",items:"image link media addcomment pageembed template codesample inserttable | charmap emoticons hr | pagebreak nonbreaking anchor tableofcontents footnotes | mergetags | insertdatetime"},format:{title:"Format",items:"bold italic underline strikethrough superscript subscript codeformat | styles blocks fontfamily fontsize align lineheight | forecolor backcolor | language | removeformat"},tools:{title:"Tools",items:"spellchecker spellcheckerlanguage | autocorrect capitalization | a11ycheck code wordcount"},table:{title:"Table",items:"inserttable | cell row column | advtablesort | tableprops deletetable"},help:{title:"Help",items:"help"}},Yl=e=>e.split(" "),Gf=(e,t)=>{const n={...n6,...t.menus},s=ce(t.menus).length>0,o=Yl(void 0===t.menubar||!0===t.menubar?"file edit view insert format tools table help":!1===t.menubar?"":t.menubar),i=K(o,e=>{const n=R(n6,e);return s?n||f(t.menus,e).exists(e=>R(e,"items")):n}),r=a(i,s=>{const o=n[s];return((e,t,n)=>{const s=l3(n).split(/[ ,]/);return{text:e.title,getItems:()=>le(e.items,e=>{const n=e.toLowerCase();return 0===n.trim().length||nn(s,e=>e===n)?[]:"separator"===n||"|"===n?[{type:"separator"}]:t.menuItems[n]?[t.menuItems[n]]:[]})}})({title:o.title,items:Yl(o.items)},t,e)});return K(r,e=>e.getItems().length>0&&nn(e.getItems(),e=>L(e)||"separator"!==e.type))},Yf=e=>{const t=()=>{e._skinLoaded=!0,(e=>{e.dispatch("SkinLoaded")})(e)};return()=>{e.initialized?t():e.on("init",t)}},$f=(e,t,n)=>(e.on("remove",()=>n.unload(t)),n.load(t)),jj=(e,t)=>$f(e,t+"/skin.min.css",e.ui.styleSheetLoader),yj=(e,t)=>{var n;return n=l(e.getElement()),Hh(n).isSome()?$f(e,t+"/skin.shadowdom.min.css",ua.DOM.styleSheetLoader):Promise.resolve()},Bf=(e,t)=>{const n=N3(t);n&&t.contentCSS.push(n+(e?"/content.inline":"/content")+".min.css"),!K1(t)&&L(n)?Promise.all([jj(t,n),yj(t,n)]).then(Yf(t),((e)=>()=>((e,t)=>{e.dispatch("SkinLoadError",t)})(e,{message:"Skin could not be loaded"}))(t)):Yf(t)()},wj=Nt(Bf,!1),Oj=Nt(Bf,!0),Pr=(e,t)=>n=>{const o=ui(),s=()=>{n.setActive(e.formatter.match(t));const s=e.formatter.formatChanged(t,n.setActive);o.set(s)};return e.initialized?s():e.once("init",s),()=>{e.off("init",s),o.clear()}},Hr=(e,t,n)=>s=>{const i=()=>n(s),o=()=>{n(s),e.on(t,i)};return e.initialized?o():e.once("init",o),()=>{e.off("init",o),e.off(t,i)}},Rf=e=>t=>()=>{e.undoManager.transact(()=>{e.focus(),e.execCommand("mceToggleFormat",!1,t.format)})},Dt=(e,t)=>()=>e.execCommand(t),Aj=(t,n,s)=>{const i=(t,i,a,r)=>{const c=n.shared.providers.translate(t.title);if("separator"===t.type)return e.some({type:"separator",text:c});if("submenu"===t.type){const n=le(t.getStyleItems(),e=>o(e,i,r));return 0===i&&n.length<=0?e.none():e.some({type:"nestedmenuitem",text:c,enabled:n.length>0,getSubmenuItems:()=>le(t.getStyleItems(),e=>o(e,i,r))})}return e.some({type:"togglemenuitem",text:c,icon:t.icon,active:t.isSelected(r),enabled:!a,onAction:s.onAction(t),...t.getStylePreview().fold(()=>({}),e=>({meta:{style:e}}))})},o=(e,t,n)=>{const o="formatter"===e.type&&s.isInvalid(e);return 0===t?o?[]:i(e,t,!1,n).toArray():i(e,t,o,n).toArray()},a=e=>{const t=s.getCurrentValue(),n=s.shouldHide?0:1;return le(e,e=>o(e,n,t))};return{validateItems:a,getFetch:(t,n)=>(s,o)=>{const i=n(),r=a(i);o(So(r,Ut.CLOSE_ON_EXECUTE,t,{isHorizontalMenu:!1,search:e.none()}))}}},Qo=(e,t,n)=>{const s=n.dataset,o="basic"===s.type?()=>a(s.data,e=>G5(e,n.isSelectedFor,n.getPreviewFor)):s.getData;return{items:Aj(0,t,n),getStyleItems:o}},Wi=(t,s,o)=>{const{items:i,getStyleItems:a}=Qo(0,s,o),r=Hr(t,"NodeChange",e=>{const t=e.getComponent();o.updateText(t)});return qd({text:o.icon.isSome()?e.none():o.text,icon:o.icon,tooltip:e.from(o.tooltip),role:e.none(),fetch:i.getFetch(s,a),onSetup:r,getApi:e=>({getComponent:n(e)}),columns:1,presets:"normal",classes:o.icon.isSome()?[]:["bespoke"],dropdownBehaviours:[]},"tox-tbtn",s.shared)};!function(e){e[e.SemiColon=0]="SemiColon",e[e.Space=1]="Space"}(Jo||(Jo={}));const Ul=(e,t,n)=>{const o=(s=((e,t)=>t===Jo.SemiColon?e.replace(/;$/,"").split(";"):e.split(" "))(e.options.get(t),n),a(s,e=>{let n=e,s=e;const t=e.split("=");return t.length>1&&(n=t[0],s=t[1]),{title:n,format:s}}));var s;return{type:"basic",data:o}},Wl=[{title:"Left",icon:"align-left",format:"alignleft",command:"JustifyLeft"},{title:"Center",icon:"align-center",format:"aligncenter",command:"JustifyCenter"},{title:"Right",icon:"align-right",format:"alignright",command:"JustifyRight"},{title:"Justify",icon:"align-justify",format:"alignjustify",command:"JustifyFull"}],Ff=t=>{const s={type:"basic",data:Wl};return{tooltip:"Align",text:e.none(),icon:e.some("align-left"),isSelectedFor:e=>()=>t.formatter.match(e),getCurrentValue:e.none,getPreviewFor:t=>e.none,onAction:e=>()=>ne(Wl,t=>t.format===e.format).each(e=>t.execCommand(e.command)),updateText:e=>{const s=ne(Wl,e=>t.formatter.match(e.format)).fold(n("left"),e=>e.title.toLowerCase());p(e,C5,{icon:`align-${s}`})},dataset:s,shouldHide:!1,isInvalid:e=>!t.formatter.canApply(e.format)}},Mf=(t,n)=>{const s=n(),o=a(s,e=>e.format);return e.from(t.formatter.closest(o)).bind(e=>ne(s,t=>t.format===e)).orThunk(()=>Li(t.formatter.match("p"),{title:"Paragraph",format:"p"}))},kf=t=>{const s="Paragraph",o=Ul(t,"block_formats",Jo.SemiColon);return{tooltip:"Blocks",text:e.some(s),icon:e.none(),isSelectedFor:e=>()=>t.formatter.match(e),getCurrentValue:e.none,getPreviewFor:n=>()=>{const s=t.formatter.get(n);return s?e.some({tag:s.length>0&&(s[0].inline||s[0].block)||"div",styles:t.dom.parseStyle(t.formatter.getCssText(n))}):e.none()},onAction:Rf(t),updateText:e=>{const i=Mf(t,()=>o.data).fold(n(s),e=>e.title);p(e,wo,{text:i})},dataset:o,shouldHide:!1,isInvalid:e=>!t.formatter.canApply(e.format)}},Rj=["-apple-system","Segoe UI","Roboto","Helvetica Neue","sans-serif"],Ef=e=>{const t=e.split(/\s*,\s*/);return a(t,e=>e.replace(/^['"]+|['"]+$/g,""))},pf=t=>{const s="System Font",o=()=>{const o=e=>e?Ef(e)[0]:"",n=t.queryCommandValue("FontName"),a=i.data,e=n?n.toLowerCase():"",r=ne(a,t=>{const n=t.format;return n.toLowerCase()===e||o(n).toLowerCase()===o(e).toLowerCase()}).orThunk(()=>Li((e=>0===e.indexOf("-apple-system")&&(()=>{const t=Ef(e.toLowerCase());return Ho(Rj,e=>t.indexOf(e.toLowerCase())>-1)})())(e),{title:s,format:e}));return{matchOpt:r,font:n}},i=Ul(t,"font_family_formats",Jo.SemiColon);return{tooltip:"Fonts",text:e.some(s),icon:e.none(),isSelectedFor:e=>t=>t.exists(t=>t.format===e),getCurrentValue:()=>{const{matchOpt:e}=o();return e},getPreviewFor:t=>()=>e.some({tag:"div",styles:-1===t.indexOf("dings")?{"font-family":t}:{}}),onAction:e=>()=>{t.undoManager.transact(()=>{t.focus(),t.execCommand("FontName",!1,e.format)})},updateText:e=>{const{matchOpt:t,font:s}=o(),i=t.fold(n(s),e=>e.title);p(e,wo,{text:i})},dataset:i,shouldHide:!1,isInvalid:U}},Ij={"8pt":"1","10pt":"2","12pt":"3","14pt":"4","18pt":"5","24pt":"6","36pt":"7"},Bj={"xx-small":"7pt","x-small":"8pt",small:"10pt",medium:"12pt",large:"14pt","x-large":"18pt","xx-large":"24pt"},Vj=(e,t)=>/[0-9.]+px$/.test(e)?((e,t)=>{const n=Math.pow(10,t);return Math.round(e*n)/n})(72*parseInt(e,10)/96,t||0)+"pt":f(Bj,e).getOr(e),$j=e=>f(Ij,e).getOr(""),ff=t=>{const s=()=>{let s=e.none();const i=o.data,n=t.queryCommandValue("FontSize");if(n)for(let e=3;s.isNone()&&e>=0;e--){const t=Vj(n,e),o=$j(t);s=ne(i,e=>e.format===n||e.format===t||e.format===o)}return{matchOpt:s,size:n}},i=n(e.none),o=Ul(t,"font_size_formats",Jo.Space);return{tooltip:"Font sizes",text:e.some("12pt"),icon:e.none(),isSelectedFor:e=>t=>t.exists(t=>t.format===e),getPreviewFor:i,getCurrentValue:()=>{const{matchOpt:e}=s();return e},onAction:e=>()=>{t.undoManager.transact(()=>{t.focus(),t.execCommand("FontSize",!1,e.format)})},updateText:e=>{const{matchOpt:t,size:o}=s(),i=t.fold(n(o),e=>e.title);p(e,wo,{text:i})},dataset:o,shouldHide:!1,isInvalid:U}},mf=(t,s)=>{const o="Paragraph";return{tooltip:"Formats",text:e.some(o),icon:e.none(),isSelectedFor:e=>()=>t.formatter.match(e),getCurrentValue:e.none,getPreviewFor:n=>()=>{const s=t.formatter.get(n);return void 0!==s?e.some({tag:s.length>0&&(s[0].inline||s[0].block)||"div",styles:t.dom.parseStyle(t.formatter.getCssText(n))}):e.none()},onAction:Rf(t),updateText:e=>{const s=e=>n7(e)?le(e.items,s):t7(e)?[{title:e.title,format:e.format}]:[],i=le(X5(t),s),a=Mf(t,n(i)).fold(n(o),e=>e.title);p(e,wo,{text:a})},shouldHide:r3(t),isInvalid:e=>!t.formatter.canApply(e.format),dataset:s}};var Kj=Object.freeze({__proto__:null,events:(e,t)=>{const n=(n,s)=>{e.updateState.each(e=>{const o=e(n,s);t.set(o)}),e.renderComponents.each(o=>{const i=o(s,t.get());(e.reuseDom?M0:S0)(n,i)})};return $([o(Ns(),(t,s)=>{const o=s;if(!o.universal){const s=e.channel;_e(o.channels,s)&&n(t,o.data)}}),Q((t)=>{e.initialData.each(e=>{n(t,e)})})])}}),qj=Object.freeze({__proto__:null,getState:(e,t,n)=>n}),Yj=[s("channel"),D("renderComponents"),D("updateState"),D("initialData"),ht("reuseDom",!0)];const rt=we({fields:Yj,name:"reflecting",active:Kj,apis:qj,state:Object.freeze({__proto__:null,init:()=>{const t=v(e.none());return{readState:()=>t.get().getOr("none"),get:t.get,set:t.set,clear:()=>t.set(e.none())}}})}),Xj=n([s("toggleClass"),s("fetch"),Xs("onExecute"),t("getHotspot",e.some),t("getAnchorOverrides",n({})),hs(),Xs("onItemExecute"),D("lazySink"),s("dom"),C("onOpen"),fe("splitDropdownBehaviours",[Y,u,b]),t("matchWidth",!1),t("useMinWidth",!1),t("eventOrder",{}),D("role")].concat(Lu())),Qj=Fe({factory:Je,schema:[s("dom")],name:"arrow",defaults:()=>({buttonBehaviours:i([b.revoke()])}),overrides:e=>({dom:{tag:"span",attributes:{role:"presentation"}},action:t=>{t.getSystem().getByUid(e.uid).each(Js)},buttonBehaviours:i([A.config({toggleOnExecute:!1,toggleClass:e.toggleClass})])})}),Zj=Fe({factory:Je,schema:[s("dom")],name:"button",defaults:()=>({buttonBehaviours:i([b.revoke()])}),overrides:e=>({dom:{tag:"span",attributes:{role:"presentation"}},action:t=>{t.getSystem().getByUid(e.uid).each(n=>{e.onExecute(n,t)})}})}),Jj=n([Qj,Zj,wt({factory:{sketch:e=>({uid:e.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:e.text}})},schema:[s("text")],name:"aria-descriptor"}),Lt({schema:[jr()],name:"menu",defaults:e=>({onExecute:(t,n)=>{t.getSystem().getByUid(e.uid).each(s=>{e.onItemExecute(s,t,n)})}})}),Kf()]),tc=Be({name:"SplitDropdown",configFields:Xj(),partFields:Jj(),factory:(t,n,s,o)=>{const r=e=>{O.getCurrent(e).each(e=>{F.highlightFirst(e),u.focusIn(e)})},i=e=>{Bu(t,z,e,o,r,Ue.HighlightMenuAndItem).get(c)},a=n=>{const s=kn(n,t,"button");return Js(s),e.some(!0)},l={...$([Q((e)=>{P(e,t,"aria-descriptor").each(t=>{const n=d("aria");_(t.element,"id",n),_(e.element,"aria-describedby",n)})})]),...wr(e.some(i))},h={repositionMenus:e=>{A.isOn(e)&&e6(e)}};return{uid:t.uid,dom:t.dom,components:n,apis:h,eventOrder:{...t.eventOrder,[ut()]:["disabling","toggling","alloy.base.behaviour"]},events:l,behaviours:ye(t.splitDropdownBehaviours,[Y.config({others:{sandbox:e=>{const n=kn(e,t,"arrow");return Hu(t,e,{onOpen:()=>{A.on(n),A.on(e)},onClose:()=>{A.off(n),A.off(e)}})}}}),u.config({mode:"special",onSpace:a,onEnter:a,onDown:t=>(i(t),e.some(!0))}),b.config({}),A.config({toggleOnExecute:!1,aria:{mode:"expanded"}})]),domModification:{attributes:{role:t.role.getOr("button"),"aria-haspopup":!0}}}},apis:{repositionMenus:(e,t)=>e.repositionMenus(t)}}),ty=e=>({isEnabled:()=>!g.isDisabled(e),setEnabled:t=>g.set(e,!t)}),ny=e=>({setActive:t=>{A.set(e,t)},isActive:()=>A.isOn(e),isEnabled:()=>!g.isDisabled(e),setEnabled:t=>g.set(e,!t)}),Y8=(e,t)=>e.map(e=>({"aria-label":t.translate(e),title:t.translate(e)})).getOr({}),V8=d("focus-button"),Vl=(e,t,n,s,a,r)=>({dom:{tag:"button",classes:["tox-tbtn"].concat(t.isSome()?["tox-tbtn--select"]:[]),attributes:Y8(n,r)},components:da([e.map(e=>pr(e,r.icons)),t.map(e=>Yd(e,"tox-tbtn",r))]),eventOrder:{[It()]:["focusing","alloy.base.behaviour","common-button-display-events"]},buttonBehaviours:i([h1(r.isDisabled),re(),w("common-button-display-events",[o(It(),(e,t)=>{t.event.prevent(),T(e,V8)})])].concat(s.map(n=>rt.config({channel:n,initialData:{icon:e,text:t},renderComponents:(e)=>da([e.icon.map(e=>pr(e,r.icons)),e.text.map(e=>Yd(e,"tox-tbtn",r))])})).toArray()).concat(a.getOr([])))}),H8=(t,n,s)=>{const a=v(c),r=Vl(t.icon,t.text,t.tooltip,e.none(),e.none(),s);return Je.sketch({dom:r.dom,components:r.components,eventOrder:j5,buttonBehaviours:i([w("toolbar-button-events",[(o={onAction:t.onAction,getApi:n.getApi},Vn((e)=>{ur(o,e)(t=>{p(e,b5,{buttonApi:t}),o.onAction(t)})})),na(n,a),ka(n,a)]),h1(()=>!t.enabled||s.isDisabled()),re()].concat(n.toolbarButtonBehaviours))});var o},P8=(e,t,n)=>H8(e,{toolbarButtonBehaviours:n.length>0?[w("toolbarButtonWith",n)]:[],getApi:ty,onSetup:e.onSetup},t),R8=(e,t,n)=>H8(e,{toolbarButtonBehaviours:[j.config({}),A.config({toggleClass:"tox-tbtn--enabled",aria:{mode:"pressed"},toggleOnExecute:!1})].concat(n.length>0?[w("toolbarToggleButtonWith",n)]:[]),getApi:ny,onSetup:e.onSetup},t),ly=(t,n,s)=>o=>Fs(e=>n.fetch(e)).map(i=>e.from(Mu(te(Ku(d("menu-value"),i,e=>{n.onItemAction(t(o),e)},n.columns,n.presets,Ut.CLOSE_ON_EXECUTE,n.select.getOr(U),s),{movement:Lr(n.columns,n.presets),menuBehaviours:ja("auto"!==n.columns?[]:[Q((e)=>{f1(e,4,ch(n.presets)).each(({numRows:t,numColumns:n})=>{u.setGridSize(e,t,n)})})])})))),dy=[{name:"history",items:["undo","redo"]},{name:"styles",items:["styles"]},{name:"formatting",items:["bold","italic"]},{name:"alignment",items:["alignleft","aligncenter","alignright","alignjustify"]},{name:"indentation",items:["outdent","indent"]},{name:"permanent pen",items:["permanentpen"]},{name:"comments",items:["addcomment"]}],Pi=(e,t)=>(n,s,o)=>{const i=e(n).mapError(e=>Bo(e)).getOrDie();return t(i,s,o)},hy={button:Pi(fm,(e,t)=>{return n=e,s=t.shared.providers,P8(n,s,[]);var n,s}),togglebutton:Pi(vm,(e,t)=>{return n=e,s=t.shared.providers,R8(n,s,[]);var n,s}),menubutton:Pi(eg,(t,n)=>Td(t,"tox-tbtn",n,e.none())),splitbutton:Pi(e=>X("SplitButton",T9,e),(t,n)=>((t,n)=>{const l=d("channel-update-split-dropdown-display"),s=e=>({isEnabled:()=>!g.isDisabled(e),setEnabled:t=>g.set(e,!t),setIconFill:(t,n)=>{pe(e.element,'svg path[id="'+t+'"], rect[id="'+t+'"]').each(e=>{_(e,"fill",n)})},setActive:t=>{_(e.element,"aria-pressed",t),pe(e.element,"span").each(n=>{e.getSystem().getByDom(n).each(e=>A.set(e,t))})},isActive:()=>pe(e.element,"span").exists(t=>e.getSystem().getByDom(t).exists(A.isOn))}),a=v(c),r={getApi:s,onSetup:t.onSetup};return tc.sketch({dom:{tag:"div",classes:["tox-split-button"],attributes:{"aria-pressed":!1,...Y8(t.tooltip,n.providers)}},onExecute:e=>{t.onAction(s(e))},onItemExecute:()=>{},splitDropdownBehaviours:i([o8(n.providers.isDisabled),re(),w("split-dropdown-events",[o(V8,b.focus),na(r,a),ka(r,a)]),Oi.config({})]),eventOrder:{[Vs()]:["alloy.base.behaviour","split-dropdown-events"]},toggleClass:"tox-tbtn--enabled",lazySink:n.getSink,fetch:ly(s,t,n.providers),parts:{menu:Ua(0,t.columns,t.presets)},components:[tc.parts.button(Vl(t.icon,t.text,e.none(),e.some(l),e.some([A.config({toggleClass:"tox-tbtn--enabled",toggleOnExecute:!1})]),n.providers)),tc.parts.arrow({dom:{tag:"button",classes:["tox-tbtn","tox-split-button__chevron"],innerHtml:P2("chevron-down",n.providers.icons)},buttonBehaviours:i([o8(n.providers.isDisabled),re(),a4()])}),tc.parts["aria-descriptor"]({text:n.providers.translate("To open the popup, press Shift+Enter")})]})})(t,n.shared)),grouptoolbarbutton:Pi(e=>X("GroupToolbarButton",A9,e),(t,n,s)=>{const o=s.ui.registry.getAll().buttons,i={[ll]:n.shared.header.isPositionedAtTop()?ns.TopToBottom:ns.BottomToTop};if(Vo(s)===kt.floating)return((t,n,s,o)=>{const i=n.shared;return eo.sketch({lazySink:i.getSink,fetch:()=>Fs(e=>{e(a(s(t.items),Er))}),markers:{toggledClass:"tox-tbtn--enabled"},parts:{button:Vl(t.icon,t.text,t.tooltip,e.none(),e.none(),i.providers),toolbar:{dom:{tag:"div",classes:["tox-toolbar__overflow"],attributes:o}}}})})(t,n,t=>sc(s,{buttons:o,toolbar:t,allowToolbarGroups:!1},n,e.none()),i);throw new Error("Toolbar groups are only supported when using floating toolbar mode")})},L8={styles:(e,t)=>{const n={type:"advanced",...t.styles};return Wi(e,t,mf(e,n))},fontsize:(e,t)=>Wi(e,t,ff(e)),fontfamily:(e,t)=>Wi(e,t,pf(e)),blocks:(e,t)=>Wi(e,t,kf(e)),align:(e,t)=>Wi(e,t,Ff(e))},sc=(t,n,s,o)=>{const i=(e=>{const t=e.toolbar,n=e.buttons;return!1===t?[]:void 0===t||!0===t?(e=>{const t=a(dy,t=>{const n=K(t.items,t=>R(e,t)||R(L8,t));return{name:t.name,items:n}});return K(t,e=>e.items.length>0)})(n):L(t)?(e=>{const t=e.split("|");return a(t,e=>({items:e.trim().split(" ")}))})(t):(e=>ga(e,e=>R(e,"name")&&R(e,"items")))(t)?t:(console.error("Toolbar type should be string, string[], boolean or ToolbarGroup[]"),[])})(n),r=a(i,i=>{const a=le(i.items,i=>0===i.trim().length?[]:((t,n,s,o,i,a)=>f(n,s.toLowerCase()).orThunk(()=>a.bind(e=>wn(e,e=>f(n,e+s.toLowerCase())))).fold(()=>f(L8,s.toLowerCase()).map(e=>e(t,i)),n=>"grouptoolbarbutton"!==n.type||o?((t,n,s)=>f(hy,t.type).fold(()=>(console.error("skipping button defined by",t),e.none()),o=>e.some(o(t,n,s))))(n,i,t):(console.warn(`Ignoring the '${s}' toolbar button. Group toolbar buttons are only supported when using floating toolbar mode and cannot be nested.`),e.none())))(t,n.buttons,i,n.allowToolbarGroups,s,o).toArray());return{title:e.from(t.translate(i.name)),items:a}});return K(r,e=>e.items.length>0)},F8=(t,n,s,o)=>{const i=n.mainUi.outerContainer,a=s.toolbar,r=s.buttons;if(ga(a,L)){const n=a.map(n=>{const i={toolbar:n,buttons:r,allowToolbarGroups:s.allowToolbarGroups};return sc(t,i,o,e.none())});H.setToolbars(i,n)}else H.setToolbar(i,sc(t,s,o,e.none()))},j8=bo(),vy=j8.os.isiOS()&&j8.os.version.major<=12;b8=Object.freeze({__proto__:null,render:(e,t,n,s,o)=>{const{mainUi:a,uiMotherships:m}=t,r=v(0),i=a.outerContainer;wj(e);const d=l(o.targetNode),f=Ka(Tt(d));((e,t)=>{C7(e,t,xx)})(d,a.mothership),((e,t)=>{xd(e,t.dialogUi.mothership)})(f,t),e.on("PostRender",()=>{H.setSidebar(i,n.sidebar,F3(e)),F8(e,t,n,s),r.set(e.getWin().innerWidth),H.setMenubar(i,Gf(e,n)),H.setViews(i,n.views),((e,t)=>{const{uiMotherships:o}=t,s=e.dom;let n=e.getWin();const i=e.getDoc().documentElement,a=v(ee(n.innerWidth,n.innerHeight)),r=v(ee(i.offsetWidth,i.offsetHeight)),c=()=>{const t=a.get();t.left===n.innerWidth&&t.top===n.innerHeight||(a.set(ee(n.innerWidth,n.innerHeight)),n1(e))},d=()=>{const t=e.getDoc().documentElement,n=r.get();n.left===t.offsetWidth&&n.top===t.offsetHeight||(r.set(ee(t.offsetWidth,t.offsetHeight)),n1(e))},u=t=>{((e,t)=>{e.dispatch("ScrollContent",t)})(e,t)};s.bind(n,"resize",c),s.bind(n,"scroll",u);const m=V0(l(e.getBody()),"load",d);e.on("hide",()=>{h(o,e=>{y(e.element,"display","none")})}),e.on("show",()=>{h(o,e=>{I(e.element,"display")})}),e.on("NodeChange",d),e.on("remove",()=>{m.unbind(),s.unbind(n,"resize",c),s.unbind(n,"scroll",u),n=null})})(e,t)});const c=H.getSocket(i).getOrDie("Could not find expected socket element");if(vy){Go(c.element,{overflow:"scroll","-webkit-overflow-scrolling":"touch"});const t=((e)=>{let n=null;return{cancel:()=>{qr(n)||(clearTimeout(n),n=null)},throttle:(...t)=>{qr(n)&&(n=setTimeout(()=>{n=null,e.apply(null,t)},20))}}})(()=>{e.dispatch("ScrollContent")}),n=Ke(c.element,"scroll",t.throttle);e.on("remove",n.unbind)}t8(e,t),e.addCommand("ToggleSidebar",(t,n)=>{H.toggleSidebar(i,n),e.dispatch("ToggleSidebar")}),e.addQueryValueHandler("ToggleSidebar",()=>{var e;return null!==(e=H.whichSidebar(i))&&void 0!==e?e:""}),e.addCommand("ToggleView",(t,n)=>{if(H.toggleView(i,n)){const t=i.element;a.mothership.broadcastOn([Es()],{target:t}),h(m,e=>{e.broadcastOn([Es()],{target:t})}),qr(H.whichView(i))&&(e.focus(),e.nodeChanged())}}),e.addQueryValueHandler("ToggleView",()=>{var e;return null!==(e=H.whichView(i))&&void 0!==e?e:""});const u=Vo(e);u!==kt.sliding&&u!==kt.floating||e.on("ResizeWindow ResizeEditor ResizeContent",()=>{const n=e.getWin().innerWidth;n!==r.get()&&(H.refreshToolbar(t.mainUi.outerContainer),r.set(n))});const p={setEnabled:e=>{ar(t,!e)},isEnabled:()=>!g.isDisabled(i)};return{iframeContainer:c.element.dom,editorContainer:i.element.dom,api:p}}});const Bl=t=>/^[0-9.]+(|px)$/i.test(""+t)?e.some(parseInt(""+t,10)):e.none(),Il=e=>Ss(e)?e+"px":e,rc=(e,t,n)=>{const s=t.filter(t=>e<t),o=n.filter(t=>e>t);return s.or(o).getOr(e)},h8=e=>{const t=e4(e),n=J1(e),s=ir(e);return Bl(t).map(e=>rc(e,n,s))},{ToolbarLocation:Hl,ToolbarMode:u8}=q3,d8=(e,t)=>{const n=it(e);return{pos:t?n.y:n.bottom,bounds:n}};c8=Object.freeze({__proto__:null,render:(e,t,s,o,i)=>{const{mainUi:r}=t,d=q(),m=l(i.targetNode),a=((e,t,s,o,i)=>{const{mainUi:a,uiMotherships:r}=s,O=ua.DOM,l=wa(e),b=Oa(e),C=ir(e).or(h8(e)),m=o.shared.header,f=m.isPositionedAtTop,p=Vo(e),g=p===u8.sliding||p===u8.floating,u=v(!1),d=()=>u.get()&&!e.removed,j=e=>g?e.fold(n(0),e=>e.components().length>1?Pe(e.components()[1].element):0):0,w=()=>{h(r,e=>{e.broadcastOn([ci()],{})})},c=(e=!1)=>{if(d()){if(l||i.on(e=>{const n=C.getOrThunk(()=>{const e=Bl(ft(Hn(),"margin-left")).getOr(0);return et(Hn())-ls(t).left+e});y(e.element,"max-width",n+"px")}),g&&H.refreshToolbar(a.outerContainer),l||i.on(e=>{const s=H.getToolbar(a.outerContainer),o=j(s),n=it(t),i=f()?Math.max(n.y-Pe(e.element)+o,0):n.bottom;Go(a.outerContainer.element,{position:"absolute",top:Math.round(i)+"px",left:Math.round(n.x)+"px"})}),b){const t=e?He.reset:He.refresh;i.on(t)}w()}},x=(n=!0)=>{!l&&b&&d()&&i.on(s=>{const l=m.getDockingMode(),r=(n=>{switch(q1(e)){case Hl.auto:const o=H.getToolbar(a.outerContainer),i=j(o),e=Pe(n.element)-i,s=it(t);if(s.y>e)return"top";{const n=B1(t),o=Math.max(n.dom.scrollHeight,Pe(n));return s.bottom<o-e||Sn().bottom<s.bottom-e?"bottom":"top"}case Hl.bottom:return"bottom";case Hl.top:default:return"top"}})(s);var o;r!==l&&(o=r,i.on(e=>{He.setModes(e,[o]),m.setDockingMode(o);const t=f()?ns.TopToBottom:ns.BottomToTop;_(e.element,ll,t)}),n&&c(!0))})};return{isVisible:d,isPositionedAtTop:f,show:()=>{u.set(!0),y(a.outerContainer.element,"display","flex"),O.addClass(e.getBody(),"mce-edit-focus"),h(r,e=>{I(e.element,"display")}),x(!1),c()},hide:()=>{u.set(!1),y(a.outerContainer.element,"display","none"),O.removeClass(e.getBody(),"mce-edit-focus"),h(r,e=>{y(e.element,"display","none")})},update:c,updateMode:x,repositionPopups:w}})(e,m,t,o,d),u=p3(e);Oj(e);const c=()=>{if(d.isSet())return void a.show();d.set(H.getHeader(r.outerContainer).getOrDie());const n=I1(e);xd(n,r.mothership),((e,t)=>{xd(e,t.dialogUi.mothership)})(n,t),F8(e,t,s,o),H.setMenubar(r.outerContainer,Gf(e,s)),a.show(),((e,t,n,s)=>{const o=v(d8(t,n.isPositionedAtTop())),i=s=>{const{pos:a,bounds:i}=d8(t,n.isPositionedAtTop()),{pos:l,bounds:r}=o.get(),c=i.height!==r.height||i.width!==r.width;o.set({pos:a,bounds:i}),c&&n1(e,s),n.isVisible()&&(l!==a?n.update(!0):c&&(n.updateMode(),n.repositionPopups()))};s||(e.on("activate",n.show),e.on("deactivate",n.hide)),e.on("SkinLoaded ResizeWindow",()=>n.update(!0)),e.on("NodeChange keydown",e=>{requestAnimationFrame(()=>i(e))}),e.on("ScrollWindow",()=>n.updateMode());const a=ui();a.set(V0(l(e.getBody()),"load",e=>i(e.raw))),e.on("remove",()=>{a.clear()})})(e,m,a,u),e.nodeChanged()};e.on("show",c),e.on("hide",a.hide),u||(e.on("focus",c),e.on("blur",a.hide)),e.on("init",()=>{(e.hasFocus()||u)&&c()}),t8(e,t);const f={show:c,hide:a.hide,setEnabled:e=>{ar(t,!e)},isEnabled:()=>!g.isDisabled(r.outerContainer)};return{editorContainer:r.outerContainer.element.dom,api:f}}});const a8="contexttoolbar-hide",Jm=(e,t)=>o(b5,(n,s)=>{const o=(e=>({hide:()=>T(e,Tc()),getValue:()=>r.getValue(e)}))(e.get(n));t.onAction(o,s.event.buttonApi)}),Sy=(t,n)=>{const r=t.label.fold(()=>({}),e=>({"aria-label":e})),s=V(Io.sketch({inputClasses:["tox-toolbar-textfield","tox-toolbar-nav-js"],data:t.initValue(),inputAttributes:r,selectOnFocus:!0,inputBehaviours:i([u.config({mode:"special",onEnter:e=>o.findPrimary(e).map(e=>(Js(e),!0)),onLeft:(t,n)=>(n.cut(),e.none()),onRight:(t,n)=>(n.cut(),e.none())})])})),o=((t,n,s)=>{const o=a(n,e=>V(((e,t,n)=>(e=>"contextformtogglebutton"===e.type)(t)?((e,t,n)=>{const{primary:i,...s}=t.original,o=an(vm({...s,type:"togglebutton",onAction:c}));return R8(o,n,[Jm(e,t)])})(e,t,n):((e,t,n)=>{const{primary:i,...s}=t.original,o=an(fm({...s,type:"button",onAction:c}));return P8(o,n,[Jm(e,t)])})(e,t,n))(t,e,s)));return{asSpecs:()=>a(o,e=>e.asSpec()),findPrimary:t=>wn(n,(n,s)=>n.primary?e.from(o[s]).bind(e=>e.getOpt(t)).filter(Ta(g.isDisabled)):e.none())}})(s,t.commands,n);return[{title:e.none(),items:[s.asSpec()]},{title:e.none(),items:o.asSpecs()}]},Xm=(e,t,n)=>t.bottom-e.y>=n&&e.bottom-t.y>=n,Pl=t=>{const n=(t=>{const n=t.getBoundingClientRect();if(n.height<=0&&n.width<=0){const s=X2(l(t.startContainer),t.startOffset).element;return(to(s)?Cn(s):e.some(s)).filter(Ot).map(e=>e.dom.getBoundingClientRect()).getOr(n)}return n})(t.selection.getRng());if(t.inline){const e=bn();return Ve(e.left+n.left,e.top+n.top,n.width,n.height)}{const e=Is(l(t.getBody()));return Ve(e.x+n.left,e.y+n.top,n.width,n.height)}},Ym=(e,t,n,s=0)=>{const o=lh(window),i=it(l(e.getContentAreaContainer())),c=tr(e)||er(e)||ya(e),{x:a,width:r}=((e,t,n)=>{const s=Math.max(e.x+n,t.x);return{x:s,width:Math.min(e.right-n,t.right)-s}})(i,o,s);if(e.inline&&!c)return Ve(a,o.y,r,o.height);{const d=t.header.isPositionedAtTop(),{y:c,bottom:u}=((e,t,n,s,o,i)=>{const r=l(e.getContainer()),u=pe(r,".tox-editor-header").getOr(r),a=it(u),h=a.y>=t.bottom,c=s&&!h;if(e.inline&&c)return{y:Math.max(a.bottom+i,n.y),bottom:n.bottom};if(e.inline&&!c)return{y:n.y,bottom:Math.min(a.y-i,n.bottom)};const d="line"===o?it(r):t;return c?{y:Math.max(a.bottom+i,n.y),bottom:Math.min(d.bottom-i,n.bottom)}:{y:Math.max(d.y+i,n.y),bottom:Math.min(a.y-i,n.bottom)}})(e,i,o,d,n,s);return Ve(a,c,r,u-c)}},Vm={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"],inset:["tox-pop--inset"]},Bm={maxHeightFunction:gi(),maxWidthFunction:Jl()},Im=e=>"node"===e,Ly=(e,t,n,s,o)=>{const i=Pl(e),a=s.lastElement().exists(e=>G(n,e));return((e,t)=>{const n=e.selection.getRng(),s=X2(l(n.startContainer),n.startOffset);return n.startContainer===n.endContainer&&n.startOffset===n.endOffset-1&&G(s.element,t)})(e,n)?a?i7:jn:a?((e,n)=>{const a=Le(e,"position");y(e,"position",n);const r=Xm(i,it(t),-20)&&!s.isReposition()?X7:i7;return a.each(t=>y(e,"position",t)),r})(t,s.getMode()):("fixed"===s.getMode()?o.y+bn().top:o.y)+(Pe(t)+12)<=i.y?jn:Aa},Ry=(e,t,n,s)=>{const i=t=>(s,o,i,a,r)=>({...Ly(e,a,t,n,r)({...s,y:r.y,height:r.height},o,i,a,r),alwaysFit:!0}),o=e=>Im(s)?[i(e)]:[];return t?{onLtr:e=>[ke,ze,De,Qe,Xe,dt].concat(o(e)),onRtl:e=>[ke,De,ze,Xe,Qe,dt].concat(o(e))}:{onLtr:e=>[dt,ke,Qe,ze,Xe,De].concat(o(e)),onRtl:e=>[dt,ke,Xe,De,Qe,ze].concat(o(e))}},Rl=(e,t)=>{const n=K(t,t=>t.predicate(e.dom)),{pass:s,fail:o}=n8(n,e=>"contexttoolbar"===e.type);return{contextToolbars:s,contextForms:o}},Hy=(e,t)=>{const i={},n=[],s=[],a={},o={},r=ce(e);return h(r,r=>{const c=e[r];"contextform"===c.type?((e,r)=>{const c=an(X("ContextForm",l_,r));i[e]=c,c.launch.map(n=>{a["form:"+e]={...r.launch,type:"contextformtogglebutton"===n.type?"togglebutton":"button",onAction:()=>{t(c)}}}),"editor"===c.scope?s.push(c):n.push(c),o[e]=c})(r,c):"contexttoolbar"===c.type&&((e,t)=>{var i;(i=t,X("ContextToolbar",c_,i)).each(i=>{"editor"===t.scope?s.push(i):n.push(i),o[e]=i})})(r,c)}),{forms:i,inNodeScope:n,inEditorScope:s,lookupTable:o,formNavigators:a}},Hm=d("forward-slide"),Pm=d("backward-slide"),Ll=d("change-slide-event"),Nl="tox-pop--resizing",Dl="tox-pop--transition",Uy=(t,n,s,r)=>{const A=r.backstage,b=A.shared,D=bo().deviceType.isTouch,g=q(),_=q(),O=q(),h=qe((t=>{const n=v([]);return J.sketch({dom:{tag:"div",classes:["tox-pop"]},fireDismissalEventInstead:{event:"doNotDismissYet"},onShow:e=>{n.set([]),J.getContent(e).each(e=>{I(e.element,"visibility")}),ie(e.element,Nl),I(e.element,"width")},inlineBehaviours:i([w("context-toolbar-events",[Ko(Di(),(e,t)=>{"width"===t.event.raw.propertyName&&(ie(e.element,Nl),I(e.element,"width"))}),o(Ll,(e,t)=>{const n=e.element;I(n,"width");const s=et(n);J.setContent(e,t.event.contents),me(n,Nl);const o=et(n);y(n,"width",s+"px"),J.getContent(e).each(e=>{t.event.focus.bind(e=>(Xn(e),Jt(n))).orThunk(()=>(u.focusIn(e),Wn(Tt(n))))}),setTimeout(()=>{y(e.element,"width",o+"px")},0)}),o(Hm,(t,s)=>{J.getContent(t).each(e=>{n.set(n.get().concat([{bar:e,focus:Wn(Tt(t.element))}]))}),p(t,Ll,{contents:s.event.forwardContents,focus:e.none()})}),o(Pm,(e)=>{d4(n.get()).each(t=>{n.set(n.get().slice(0,n.get().length-1)),p(e,Ll,{contents:Pt(t.bar),focus:t.focus})})})]),u.config({mode:"special",onEscape:s=>d4(n.get()).fold(()=>t.onEscape(),t=>(T(s,Pm),e.some(!0)))})]),lazySink:()=>x.value(t.sink)})})({sink:s,onEscape:()=>(t.focus(),e.some(!0))})),M=()=>{const e=O.get().getOr("node"),n=Im(e)?1:0;return Ym(t,b,e,n)},E=()=>!(t.removed||D()&&A.isContextMenuOpen()),k=()=>{if(E()){const e=M(),n=sn(O.get(),"node")?((e,t)=>t.filter(e=>Xt(e)&&(e=>Ot(e)&&Ix(e.dom))(e)).map(Is).getOrThunk(()=>Pl(e)))(t,g.get()):Pl(t);return e.height<=0||!Xm(n,e,.01)}return!0},m=()=>{g.clear(),_.clear(),O.clear(),J.hide(h)},N=()=>{if(J.isOpen(h)){const e=h.element;I(e,"display"),k()?y(e,"display","none"):(_.set(0),J.reposition(h))}},S=e=>({dom:{tag:"div",classes:["tox-pop__dialog"]},components:[e],behaviours:i([u.config({mode:"acyclic"}),w("pop-dialog-wrap-events",[Q(e=>{t.shortcuts.add("ctrl+F9","focus statusbar",()=>u.focusIn(e))}),_n(e=>{t.shortcuts.remove("ctrl+F9")})])])}),C=vs(()=>Hy(n,e=>{const t=F([e]);p(h,Hm,{forwardContents:S(t)})})),F=n=>{const{buttons:s}=t.ui.registry.getAll(),o={...s,...C().formNavigators},i=Vo(t)===kt.scrolling?kt.scrolling:kt.default,c=Se(a(n,n=>"contexttoolbar"===n.type?((n,s)=>sc(t,{buttons:n,toolbar:s.items,allowToolbarGroups:!1},r.backstage,e.some(["form:"])))(o,n):((e,t)=>Sy(e,t))(n,b.providers)));return Gl({type:i,uid:d("context-toolbar"),initGroups:c,onEscape:e.none,cyclicKeying:!0,providers:b.providers})},z=(n,o)=>{if(j.cancel(),!E())return;const r=F(n),a=n[0].position,c=((e,n)=>{const o="node"===e?b.anchors.node(n):b.anchors.cursor(),i=((e,t,n,s)=>"line"===t?{bubble:hi(12,0,Vm),layouts:{onLtr:()=>[R1],onRtl:()=>[L1]},overrides:Bm}:{bubble:hi(0,12,Vm,1/12),layouts:Ry(e,n,s,t),overrides:Bm})(t,e,D(),{lastElement:g.get,isReposition:()=>sn(_.get(),0),getMode:()=>Ye.getMode(s)});return te(o,i)})(a,o);O.set(a),_.set(1);const i=h.element;I(i,"display"),(e=>sn(ic(e,g.get(),G),!0))(o)||(ie(i,Dl),Ye.reset(s,h)),J.showWithinBounds(h,S(r),{anchor:c,transition:{classes:[Dl],mode:"placement"}},()=>e.some(M())),o.fold(g.clear,g.set),k()&&y(i,"display","none")},j=U5(()=>{t.hasFocus()&&!t.removed&&(mt(h.element,Dl)?j.throttle():((t,n)=>{const o=l(n.getBody()),i=e=>G(e,o),s=l(n.selection.getNode());return(e=>!i(e)&&!Zr(o,e))(s)?e.none():((t,n,s)=>{const o=Rl(t,n);if(o.contextForms.length>0)return e.some({elem:t,toolbars:[o.contextForms[0]]});{const n=Rl(t,s);if(n.contextForms.length>0)return e.some({elem:t,toolbars:[n.contextForms[0]]});if(o.contextToolbars.length>0||n.contextToolbars.length>0){const s=(e=>{if(e.length<=1)return e;{const s=t=>nn(e,e=>e.position===t),t=t=>K(e,e=>e.position===t),n=s("selection"),o=s("node");if(n||o){if(o&&n){const e=t("node"),n=a(t("selection"),e=>({...e,position:"node"}));return e.concat(n)}return t(n?"selection":"node")}return t("line")}})(o.contextToolbars.concat(n.contextToolbars));return e.some({elem:t,toolbars:s})}return e.none()}})(s,t.inNodeScope,t.inEditorScope).orThunk(()=>((t,n,s)=>t(n)?e.none():d5(n,t=>{if(Ot(t)){const{contextToolbars:i,contextForms:n}=Rl(t,s.inNodeScope),o=n.length>0?n:(e=>{if(e.length<=1)return e;{const t=t=>ne(e,e=>e.position===t);return t("selection").orThunk(()=>t("node")).orThunk(()=>t("line")).map(e=>e.position).fold(()=>[],t=>K(e,e=>e.position===t))}})(i);return o.length>0?e.some({elem:t,toolbars:o}):e.none()}return e.none()},t))(i,s,t))})(C(),t).fold(m,t=>{z(t.toolbars,e.some(t.elem))}))},17);t.on("init",()=>{t.on("remove",m),t.on("ScrollContent ScrollWindow ObjectResized ResizeEditor longpress",N),t.on("click keyup focus SetContent",j.throttle),t.on(a8,m),t.on("contexttoolbar-show",e=>{const n=C();f(n.lookupTable,e.toolbarKey).each(n=>{z([n],Li(e.target!==t,e.target)),J.getContent(h).each(u.focusIn)})}),t.on("focusout",e=>{ia.setEditorTimeout(t,()=>{Jt(s.element).isNone()&&Jt(h.element).isNone()&&m()},0)}),t.on("SwitchMode",()=>{t.mode.isReadOnly()&&m()}),t.on("AfterProgressState",e=>{e.state?m():t.hasFocus()&&j.throttle()}),t.on("NodeChange",e=>{Jt(h.element).fold(j.throttle,c)})})},Ky={unsupportedLength:["em","ex","cap","ch","ic","rem","lh","rlh","vw","vh","vi","vb","vmin","vmax","cm","mm","Q","in","pc","pt","px"],fixed:["px","pt"],relative:["%"],empty:[""]},qy=(()=>{const n="[0-9]+",t="[eE][+-]?[0-9]+",e=e=>`(?:${e})?`,s=["Infinity","[0-9]+\\."+e(n)+e(t),"\\.[0-9]+"+e(t),n+e(t)].join("|");return new RegExp(`^([+-]?(?:${s}))(.*)$`)})(),Dm=(e,t)=>{const n=()=>{const s=t.getOptions(e),o=t.getCurrent(e).map(t.hash),n=q();return a(s,s=>({type:"togglemenuitem",text:t.display(s),onSetup:i=>{const a=e=>{e&&(n.on(e=>e.setActive(!1)),n.set(i)),i.setActive(e)};a(sn(o,t.hash(s)));const r=t.watcher(e,s,a);return()=>{n.clear(),r()}},onAction:()=>t.setCurrent(e,s)}))};e.ui.registry.addMenuButton(t.name,{tooltip:t.text,icon:t.icon,fetch:e=>e(n()),onSetup:t.onToolbarSetup}),e.ui.registry.addNestedMenuItem(t.name,{type:"nestedmenuitem",text:t.text,getSubmenuItems:n,onSetup:t.onMenuSetup})},Gy={name:"lineheight",text:"Line height",icon:"line-height",getOptions:L3,hash:t=>((t)=>((t,n)=>e.from(qy.exec(t)).bind(t=>{const o=Number(t[1]),s=t[2];return((e,t)=>nn(t,t=>nn(Ky[t],t=>e===t)))(s,n)?e.some({value:o,unit:s}):e.none()}))(t,["fixed","relative","empty"]).map(({value:e,unit:t})=>e+t))(t).getOr(t),display:z,watcher:(e,t,n)=>e.formatter.formatChanged("lineheight",n,!1,{value:t}).unbind,getCurrent:t=>e.from(t.queryCommandValue("LineHeight")),setCurrent:(e,t)=>e.execCommand("LineHeight",!1,t)},Xy=e=>Hr(e,"NodeChange",t=>{t.setEnabled(e.queryCommandState("outdent"))}),zm=(e,t)=>n=>{n.setActive(t.get());const s=e=>{t.set(e.state),n.setActive(e.state)};return e.on("PastePlainTextToggle",s),()=>e.off("PastePlainTextToggle",s)},zl=(e,t)=>()=>{e.execCommand("mceToggleFormat",!1,t)},Jy=e=>{(e=>{(e=>{is.each([{name:"bold",text:"Bold",icon:"bold"},{name:"italic",text:"Italic",icon:"italic"},{name:"underline",text:"Underline",icon:"underline"},{name:"strikethrough",text:"Strikethrough",icon:"strike-through"},{name:"subscript",text:"Subscript",icon:"subscript"},{name:"superscript",text:"Superscript",icon:"superscript"}],(t)=>{e.ui.registry.addToggleButton(t.name,{tooltip:t.text,icon:t.icon,onSetup:Pr(e,t.name),onAction:zl(e,t.name)})});for(let t=1;t<=6;t++){const n="h"+t;e.ui.registry.addToggleButton(n,{text:n.toUpperCase(),tooltip:"Heading "+t,onSetup:Pr(e,n),onAction:zl(e,n)})}})(e),(e=>{is.each([{name:"cut",text:"Cut",action:"Cut",icon:"cut"},{name:"copy",text:"Copy",action:"Copy",icon:"copy"},{name:"paste",text:"Paste",action:"Paste",icon:"paste"},{name:"help",text:"Help",action:"mceHelp",icon:"help"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all"},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document"},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting"},{name:"remove",text:"Remove",action:"Delete",icon:"remove"},{name:"print",text:"Print",action:"mcePrint",icon:"print"},{name:"hr",text:"Horizontal line",action:"InsertHorizontalRule",icon:"horizontal-rule"}],t=>{e.ui.registry.addButton(t.name,{tooltip:t.text,icon:t.icon,onAction:Dt(e,t.action)})})})(e),(e=>{is.each([{name:"blockquote",text:"Blockquote",action:"mceBlockQuote",icon:"quote"}],t=>{e.ui.registry.addToggleButton(t.name,{tooltip:t.text,icon:t.icon,onAction:Dt(e,t.action),onSetup:Pr(e,t.name)})})})(e)})(e),(e=>{is.each([{name:"bold",text:"Bold",action:"Bold",icon:"bold",shortcut:"Meta+B"},{name:"italic",text:"Italic",action:"Italic",icon:"italic",shortcut:"Meta+I"},{name:"underline",text:"Underline",action:"Underline",icon:"underline",shortcut:"Meta+U"},{name:"strikethrough",text:"Strikethrough",action:"Strikethrough",icon:"strike-through"},{name:"subscript",text:"Subscript",action:"Subscript",icon:"subscript"},{name:"superscript",text:"Superscript",action:"Superscript",icon:"superscript"},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting"},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document"},{name:"cut",text:"Cut",action:"Cut",icon:"cut",shortcut:"Meta+X"},{name:"copy",text:"Copy",action:"Copy",icon:"copy",shortcut:"Meta+C"},{name:"paste",text:"Paste",action:"Paste",icon:"paste",shortcut:"Meta+V"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all",shortcut:"Meta+A"},{name:"print",text:"Print...",action:"mcePrint",icon:"print",shortcut:"Meta+P"},{name:"hr",text:"Horizontal line",action:"InsertHorizontalRule",icon:"horizontal-rule"}],t=>{e.ui.registry.addMenuItem(t.name,{text:t.text,icon:t.icon,shortcut:t.shortcut,onAction:Dt(e,t.action)})}),e.ui.registry.addMenuItem("codeformat",{text:"Code",icon:"sourcecode",onAction:zl(e,"code")})})(e)},lc=(e,t)=>Hr(e,"Undo Redo AddUndo TypingUndo ClearUndos SwitchMode",n=>{n.setEnabled(!e.mode.isReadOnly()&&e.undoManager[t]())}),t_=e=>Hr(e,"VisualAid",t=>{t.setActive(e.hasVisual)}),n_=(t,s)=>{(e=>{h([{name:"alignleft",text:"Align left",cmd:"JustifyLeft",icon:"align-left"},{name:"aligncenter",text:"Align center",cmd:"JustifyCenter",icon:"align-center"},{name:"alignright",text:"Align right",cmd:"JustifyRight",icon:"align-right"},{name:"alignjustify",text:"Justify",cmd:"JustifyFull",icon:"align-justify"}],t=>{e.ui.registry.addToggleButton(t.name,{tooltip:t.text,icon:t.icon,onAction:Dt(e,t.cmd),onSetup:Pr(e,t.name)})}),e.ui.registry.addButton("alignnone",{tooltip:"No alignment",icon:"align-none",onAction:Dt(e,"JustifyNone")})})(t),Jy(t),((e,t)=>{((e,t)=>{const n=Qo(0,t,Ff(e));e.ui.registry.addNestedMenuItem("align",{text:t.shared.providers.translate("Align"),getSubmenuItems:()=>n.items.validateItems(n.getStyleItems())})})(e,t),((e,t)=>{const n=Qo(0,t,pf(e));e.ui.registry.addNestedMenuItem("fontfamily",{text:t.shared.providers.translate("Fonts"),getSubmenuItems:()=>n.items.validateItems(n.getStyleItems())})})(e,t),((e,t)=>{const s={type:"advanced",...t.styles},n=Qo(0,t,mf(e,s));e.ui.registry.addNestedMenuItem("styles",{text:"Formats",getSubmenuItems:()=>n.items.validateItems(n.getStyleItems())})})(e,t),((e,t)=>{const n=Qo(0,t,kf(e));e.ui.registry.addNestedMenuItem("blocks",{text:"Blocks",getSubmenuItems:()=>n.items.validateItems(n.getStyleItems())})})(e,t),((e,t)=>{const n=Qo(0,t,ff(e));e.ui.registry.addNestedMenuItem("fontsize",{text:"Font sizes",getSubmenuItems:()=>n.items.validateItems(n.getStyleItems())})})(e,t)})(t,s),(e=>{(e=>{e.ui.registry.addMenuItem("undo",{text:"Undo",icon:"undo",shortcut:"Meta+Z",onSetup:lc(e,"hasUndo"),onAction:Dt(e,"undo")}),e.ui.registry.addMenuItem("redo",{text:"Redo",icon:"redo",shortcut:"Meta+Y",onSetup:lc(e,"hasRedo"),onAction:Dt(e,"redo")})})(e),(e=>{e.ui.registry.addButton("undo",{tooltip:"Undo",icon:"undo",enabled:!1,onSetup:lc(e,"hasUndo"),onAction:Dt(e,"undo")}),e.ui.registry.addButton("redo",{tooltip:"Redo",icon:"redo",enabled:!1,onSetup:lc(e,"hasRedo"),onAction:Dt(e,"redo")})})(e)})(t),(e=>{(e=>{e.addCommand("mceApplyTextcolor",(t,n)=>{((e,t,n)=>{e.undoManager.transact(()=>{e.focus(),e.formatter.apply(t,{value:n}),e.nodeChanged()})})(e,t,n)}),e.addCommand("mceRemoveTextcolor",t=>{((e,t)=>{e.undoManager.transact(()=>{e.focus(),e.formatter.remove(t,{value:null},void 0,!0),e.nodeChanged()})})(e,t)})})(e);const t=Wj(e),n=Hj(e),s=v(t),o=v(n);wf(e,"forecolor","forecolor","Text color",s),wf(e,"backcolor","hilitecolor","Background color",o),Of(e,"forecolor","forecolor","Text color"),Of(e,"backcolor","hilitecolor","Background color")})(t),(e=>{(e=>{e.ui.registry.addButton("visualaid",{tooltip:"Visual aids",text:"Visual aids",onAction:Dt(e,"mceToggleVisualAid")})})(e),(e=>{e.ui.registry.addToggleMenuItem("visualaid",{text:"Visual aids",onSetup:t_(e),onAction:Dt(e,"mceToggleVisualAid")})})(e)})(t),(e=>{(e=>{e.ui.registry.addButton("outdent",{tooltip:"Decrease indent",icon:"outdent",onSetup:Xy(e),onAction:Dt(e,"outdent")}),e.ui.registry.addButton("indent",{tooltip:"Increase indent",icon:"indent",onAction:Dt(e,"indent")})})(e)})(t),(t=>{Dm(t,Gy),(t=>e.from(c3(t)).map(s=>({name:"language",text:"Language",icon:"language",getOptions:n(s),hash:e=>ts(e.customCode)?e.code:`${e.code}/${e.customCode}`,display:e=>e.title,watcher:(e,t,n)=>{var s;return e.formatter.formatChanged("lang",n,!1,{value:t.code,customValue:null!==(s=t.customCode)&&void 0!==s?s:null}).unbind},getCurrent:t=>{const n=l(t.selection.getNode());return Qd(n,t=>e.some(t).filter(Ot).bind(e=>_t(e,"lang").map(t=>({code:t,customCode:_t(e,"data-mce-lang").getOrUndefined(),title:""}))))},setCurrent:(e,t)=>e.execCommand("Lang",!1,t),onToolbarSetup:e=>{const n=ui();return e.setActive(t.formatter.match("lang",{},void 0,!0)),n.set(t.formatter.formatChanged("lang",e.setActive,!0)),n.clear}})))(t).each(e=>Dm(t,e))})(t),(e=>{const t=v(M3(e)),n=()=>e.execCommand("mceTogglePlainTextPaste");e.ui.registry.addToggleButton("pastetext",{active:!1,icon:"paste-text",tooltip:"Paste as text",onAction:n,onSetup:zm(e,t)}),e.ui.registry.addToggleMenuItem("pastetext",{text:"Paste as text",icon:"paste-text",onAction:n,onSetup:zm(e,t)})})(t)},s_=e=>L(e)?e.split(/[ ,]/):e,Am=e=>t=>t.options.get(e),km=Am("contextmenu_never_use_native"),a_=Am("contextmenu_avoid_overlap"),Em=e=>{const n=e.ui.registry.getAll().contextMenus,t=e.options.get("contextmenu");return e.options.isSet("contextmenu")?t:K(t,e=>R(n,e))},Fi=(e,t)=>({type:"makeshift",x:e,y:t}),xm=e=>"longpress"===e.type||0===e.type.indexOf("touch"),d_=(e,t)=>"contextmenu"===t.type||"longpress"===t.type?e.inline?(e=>{if(xm(e)){const t=e.touches[0];return Fi(t.pageX,t.pageY)}return Fi(e.pageX,e.pageY)})(t):((e,t)=>{const n=ua.DOM.getPos(e);return((e,t,n)=>Fi(e.x+t,e.y+n))(t,n.x,n.y)})(e.getContentAreaContainer(),(e=>{if(xm(e)){const t=e.touches[0];return Fi(t.clientX,t.clientY)}return Fi(e.clientX,e.clientY)})(t)):Om(e),Om=e=>({type:"selection",root:l(e.selection.getNode())}),wm=(t,n,s)=>{switch(s){case"node":return(t=>({type:"node",node:e.some(l(t.selection.getNode())),root:l(t.getBody())}))(t);case"point":return d_(t,n);case"selection":return Om(t)}},m_=(t,n,s,o,i,a)=>{const r=s(),c=wm(t,n,a);So(r,Ut.CLOSE_ON_EXECUTE,o,{isHorizontalMenu:!1,search:e.none()}).map(e=>{n.preventDefault(),J.showMenuAt(i,{anchor:c},{menu:{markers:Ws("normal")},data:e})})},f_={onLtr:()=>[ke,ze,De,Qe,Xe,dt,jn,Aa,Sa,Br,za,Pa],onRtl:()=>[ke,De,ze,Xe,Qe,dt,jn,Aa,za,Pa,Sa,Br]},p_={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"]},g_=(t,n,s,o,i,a)=>{const r=bo(),c=r.os.isiOS(),l=r.os.isMacOS(),u=r.os.isAndroid(),h=r.deviceType.isTouch(),d=()=>{const r=s();((t,n,s,o,i,a,r)=>{const c=((e,t,n)=>{const s=wm(e,t,n);return{bubble:hi(0,"point"===n?12:0,p_),layouts:f_,overrides:{maxWidthFunction:Jl(),maxHeightFunction:gi()},...s}})(t,n,a);So(s,Ut.CLOSE_ON_EXECUTE,o,{isHorizontalMenu:!0,search:e.none()}).map(s=>{n.preventDefault();const l=r?Ue.HighlightMenuAndItem:Ue.HighlightNone;J.showMenuWithinBounds(i,{anchor:c},{menu:{markers:Ws("normal"),highlightOnOpen:l},data:s,type:"horizontal"},()=>e.some(Ym(t,o.shared,"node"===a?"node":"selection"))),t.dispatch(a8)})})(t,n,r,o,i,a,!(u||c||l&&h))};if((l||c)&&"node"!==a){const e=()=>{(e=>{const i=e.selection.getRng(),t=()=>{ia.setEditorTimeout(e,()=>{e.selection.setRng(i)},10),o()};e.once("touchend",t);const n=e=>{e.preventDefault(),e.stopImmediatePropagation()};e.on("mousedown",n,!0);const s=()=>o();e.once("longpresscancel",s);const o=()=>{e.off("touchend",t),e.off("longpresscancel",s),e.off("mousedown",n)}})(t),d()};((e,t)=>{const n=e.selection;if(n.isCollapsed()||t.touches.length<1)return!1;{const s=t.touches[0],o=n.getRng();return O4(e.getWin(),bi.domRange(o)).exists(e=>e.left<=s.clientX&&e.right>=s.clientX&&e.top<=s.clientY&&e.bottom>=s.clientY)}})(t,n)?e():(t.once("selectionchange",e),t.once("touchend",()=>t.off("selectionchange",e)))}else d()},_m=e=>L(e)?"|"===e:"separator"===e.type,Fl={type:"separator"},jm=e=>{const t=e=>({text:e.text,icon:e.icon,enabled:e.enabled,shortcut:e.shortcut});if(L(e))return e;switch(e.type){case"separator":return Fl;case"submenu":return{type:"nestedmenuitem",...t(e),getSubmenuItems:()=>{const t=e.getSubmenuItems();return L(t)?t:a(t,jm)}};default:const s=e;return{type:"menuitem",...t(s),onAction:(n=s.onAction,()=>n())}}var n},gm=(e,t)=>{if(0===t.length)return e;const n=d4(e).filter(e=>!_m(e)).fold(()=>[],e=>[Fl]);return e.concat(n).concat(t).concat([Fl])},pm=(e,t)=>!(e=>"longpress"===e.type||R(e,"touches"))(t)&&(2!==t.button||t.target===e.getBody()&&""===t.pointerType),mm=(e,t)=>pm(e,t)?e.selection.getStart(!0):t.target,O_=(e,t,n)=>{const s=bo().deviceType.isTouch,r=qe(J.sketch({dom:{tag:"div"},lazySink:t,onEscape:()=>e.focus(),onShow:()=>n.setContextMenuState(!0),onHide:()=>n.setContextMenuState(!1),fireDismissalEventInstead:{},inlineBehaviours:i([w("dismissContextMenu",[o(di(),(t)=>{k.close(t),e.focus()})])])})),c=()=>J.hide(r),d=t=>{if(km(e)&&t.preventDefault(),((e,t)=>t.ctrlKey&&!km(e))(e,t)||(e=>0===Em(e).length)(e))return;const o=((e,t)=>{const n=a_(e),s=pm(e,t)?"selection":"point";if(zu(n)){const o=mm(e,t);return Ni(l(o),n)?"node":s}return s})(e,t);(s()?g_:m_)(e,t,()=>{const n=mm(e,t),s=e.ui.registry.getAll(),o=Em(e);return((e,t,n)=>{const s=Ie(t,(t,s)=>f(e,s.toLowerCase()).map(e=>{const s=e.update(n);if(L(s))return gm(t,s.split(" "));if(s.length>0){const e=a(s,jm);return gm(t,e)}return t}).getOrThunk(()=>t.concat([s])),[]);return s.length>0&&_m(s[s.length-1])&&s.pop(),s})(s.contextMenus,o,n)},n,r,o)};e.on("init",()=>{const t="ResizeEditor ScrollContent ScrollWindow longpresscancel"+(s()?"":" ResizeWindow");e.on(t,c),e.on("longpress contextmenu",d)})},Ml=Ft([{offset:["x","y"]},{absolute:["x","y"]},{fixed:["x","y"]}]),_c=e=>t=>t.translate(-e.left,-e.top),wc=e=>t=>t.translate(e.left,e.top),Gn=e=>(t,n)=>Ie(e,(e,t)=>t(e),ee(t,n)),Oc=(e,t,n)=>e.fold(Gn([wc(n),_c(t)]),Gn([_c(t)]),Gn([])),ai=(e,t,n)=>e.fold(Gn([wc(n)]),Gn([]),Gn([wc(t)])),om=(e,t,n)=>e.fold(Gn([]),Gn([_c(n)]),Gn([wc(t),_c(n)])),sm=(t,n,s)=>{const o=t.fold((t,n)=>({position:e.some("absolute"),left:e.some(t+"px"),top:e.some(n+"px")}),(t,n)=>({position:e.some("absolute"),left:e.some(t-s.left+"px"),top:e.some(n-s.top+"px")}),(t,n)=>({position:e.some("fixed"),left:e.some(t+"px"),top:e.some(n+"px")}));return{right:e.none(),bottom:e.none(),...o}},Al=(e,t,n,s)=>{const o=(e,o)=>(i,a)=>{const r=e(t,n,s);return o(i.getOr(r.left),a.getOr(r.top))};return e.fold(o(om,xc),o(ai,ks),o(Oc,Gs))},xc=Ml.offset,ks=Ml.absolute,Gs=Ml.fixed,Jh=(e,t)=>{const n=Ne(e,t);return ts(n)?NaN:parseInt(n,10)},R_=(t,n,s,o,i,a)=>{const r=((t,n,s,o)=>((t,n)=>{const s=t.element,o=Jh(s,n.leftAttr),i=Jh(s,n.topAttr);return isNaN(o)||isNaN(i)?e.none():e.some(ee(o,i))})(t,n).fold(()=>s,e=>Gs(e.left+o.left,e.top+o.top)))(t,n,s,o),l=n.mustSnap?H_(t,n,r,i,a):I_(t,n,r,i,a),c=Oc(r,i,a);return((e,t,n)=>{const s=e.element;_(s,t.leftAttr,n.left+"px"),_(s,t.topAttr,n.top+"px")})(t,n,c),l.fold(()=>({coord:Gs(c.left,c.top),extra:e.none()}),e=>({coord:e.output,extra:e.extra}))},Zh=(t,n,s,o)=>wn(t,t=>{const i=t.sensor,a=((e,t,n,s,o,i)=>{const a=ai(e,o,i),r=ai(t,o,i);return Math.abs(a.left-r.left)<=n&&Math.abs(a.top-r.top)<=s})(n,i,t.range.left,t.range.top,s,o);return a?e.some({output:Al(t.output,n,s,o),extra:t.extra}):e.none()}),H_=(t,n,s,o,i)=>{const a=n.getSnapPoints(t);return Zh(a,s,o,i).orThunk(()=>{const t=Ie(a,(t,n)=>{const r=n.sensor,a=((e,t,n,s,o,i)=>{const a=ai(e,o,i),r=ai(t,o,i),c=Math.abs(a.left-r.left),l=Math.abs(a.top-r.top);return ee(c,l)})(s,r,n.range.left,n.range.top,o,i);return t.deltas.fold(()=>({deltas:e.some(a),snap:e.some(n)}),s=>(a.left+a.top)/2<=(s.left+s.top)/2?{deltas:e.some(a),snap:e.some(n)}:t)},{deltas:e.none(),snap:e.none()});return t.snap.map(e=>({output:Al(e.output,s,o,i),extra:e.extra}))})},I_=(e,t,n,s,o)=>{const i=t.getSnapPoints(e);return Zh(i,n,s,o)};Qh=Object.freeze({__proto__:null,snapTo:(e,t,n,s)=>{const o=t.getTarget(e.element);if(t.repositionTarget){const n=rn(e.element),i=bn(n),t=Lg(o),a=((e,t,n)=>({coord:Al(e.output,e.output,t,n),extra:e.extra}))(s,i,t),r=sm(a.coord,0,t);yc(o,r)}}});const xl="data-initial-z-index",Gh=(e,t)=>{e.getSystem().addToGui(t),(e=>{Cn(e.element).filter(Ot).each(t=>{Le(t,"z-index").each(e=>{_(t,xl,e)}),y(t,"z-index",ft(e.element,"z-index"))})})(t)},W_=e=>{(e=>{Cn(e.element).filter(Ot).each(e=>{_t(e,xl).fold(()=>I(e,"z-index"),t=>y(e,"z-index",t)),ve(e,xl)})})(e),e.getSystem().removeFromGui(e)},Yh=(e,t,n)=>e.getSystem().build(tn.sketch({dom:{styles:{left:"0px",top:"0px",width:"100%",height:"100%",position:"fixed","z-index":"1000000000000000"},classes:[t]},events:n}));Kh=bt("snaps",[s("getSnapPoints"),C("onSensor"),s("leftAttr"),s("topAttr"),t("lazyViewport",Sn),t("mustSnap",!1)]);const Ol=[t("useFixed",U),s("blockerClass"),t("getTarget",z),t("onDrag",c),t("repositionTarget",!0),t("onDrop",c),ue("getBounds",Sn),Kh],Wh=(e,t)=>({bounds:e.getBounds(),height:Ks(t.element),width:Ea(t.element)}),wl=(t,s,o,i,a)=>{const r=o.update(i,a),c=o.getStartData().getOrThunk(()=>Wh(s,t));r.each(o=>{((t,s,o,i)=>{const a=s.getTarget(t.element);if(s.repositionTarget){const c=rn(t.element),l=bn(c),r=Lg(a),d=(t=>{return(n=Le(t,"left"),s=Le(t,"top"),o=Le(t,"position"),i=(e,t,n)=>("fixed"===n?Gs:xc)(parseInt(e,10),parseInt(t,10)),n.isSome()&&s.isSome()&&o.isSome()?e.some(i(n.getOrDie(),s.getOrDie(),o.getOrDie())):e.none()).getOrThunk(()=>{const e=ls(t);return ks(e.left,e.top)});var n,s,o,i})(a),u=((e,t,s,o,i,a,r)=>((e,t,s,o,i)=>{const a=i.bounds,c=ai(t,s,o),l=zt(c.left,a.x,a.x+a.width-i.width),d=zt(c.top,a.y,a.y+a.height-i.height),r=ks(l,d);return t.fold(()=>{const e=om(r,s,o);return xc(e.left,e.top)},n(r),()=>{const e=Oc(r,s,o);return Gs(e.left,e.top)})})(0,t.fold(()=>{const c=(n=s,e=a.left,t=a.top,n.fold((n,s)=>xc(n+e,s+t),(n,s)=>ks(n+e,s+t),(n,s)=>Gs(n+e,s+t)));var e,t,n;const r=Oc(c,o,i);return Gs(r.left,r.top)},t=>{const n=R_(e,t,s,a,o,i);return n.extra.each(n=>{t.onSensor(e,n)}),n.coord}),o,i,r))(t,s.snaps,d,l,r,i,o),h=sm(u,0,r);yc(a,h)}s.onDrag(t,a,i)})(t,s,c,o)})},Vh=(e,t,n,s)=>{t.each(W_),n.snaps.each(t=>{((e,t)=>{((e,t)=>{const n=e.element;ve(n,t.leftAttr),ve(n,t.topAttr)})(e,t)})(e,t)});const o=n.getTarget(e.element);s.reset(),n.onDrop(e,o)},_l=e=>(t,n)=>{const s=e=>{n.setStartData(Wh(t,e))};return $([o(ju(),e=>{n.getStartData().each(()=>s(e))}),...e(t,n,s)])};Ih=Object.freeze({__proto__:null,getData:t=>e.from(ee(t.x,t.y)),getDelta:(e,t)=>ee(t.left-e.left,t.top-e.top)});const Dh=(t,n,s)=>[o(It(),(i,a)=>{if(0!==a.event.raw.button)return;a.stop();const r=()=>Vh(i,e.some(l),t,n),c=p6(r,200),d={drop:r,delayDrop:c.schedule,forceDrop:r,move:e=>{c.cancel(),wl(i,t,n,Ih,e)}},l=Yh(i,t.blockerClass,(e=>$([o(It(),e.forceDrop),o(ou(),e.drop),o(Rr(),(t,n)=>{e.move(n.event)}),o(tu(),e.delayDrop)]))(d));s(i),Gh(i,l)})],ew=[...Ol,W("dragger",{handlers:_l(Dh)})];yl=Object.freeze({__proto__:null,getData:t=>{const n=t.raw.touches;return 1===n.length?(t=>{const n=t[0];return e.some(ee(n.clientX,n.clientY))})(n):e.none()},getDelta:(e,t)=>ee(t.left-e.left,t.top-e.top)});const Ch=(e,t,n)=>{const s=q(),i=n=>{Vh(n,s.get(),e,t),s.clear()};return[o(Nn(),(a,r)=>{r.stop();const l=()=>i(a),u={drop:l,delayDrop:c,forceDrop:l,move:n=>{wl(a,e,t,yl,n)}},d=Yh(a,e.blockerClass,(e=>$([o(Nn(),e.forceDrop),o(Ji(),e.drop),o(Fg(),e.drop),o(ta(),(t,n)=>{e.move(n.event)})]))(u));s.set(d),n(a),Gh(a,d)}),o(ta(),(n,s)=>{s.stop(),wl(n,e,t,yl,s.event)}),o(Ji(),(e,t)=>{t.stop(),i(e)}),o(Fg(),i)]},sw=ew,ow=[...Ol,W("dragger",{handlers:_l(Ch)})],iw=[...Ol,W("dragger",{handlers:_l((e,t,n)=>[...Dh(e,t,n),...Ch(e,t,n)])})];wh=Object.freeze({__proto__:null,mouse:sw,touch:ow,mouseOrTouch:iw}),jh=Object.freeze({__proto__:null,init:()=>{let t=e.none(),s=e.none();const o=n({});return jt({readState:o,reset:()=>{t=e.none(),s=e.none()},update:(n,s)=>n.getData(s).bind(s=>((n,s)=>{const o=t.map(e=>n.getDelta(e,s));return t=e.some(s),o})(n,s)),getStartData:()=>s,setStartData:t=>{s=e.some(t)}})}});const Qs=kp({branchKey:"mode",branches:wh,name:"dragging",active:{events:(e,t)=>e.dragger.handlers(e,t)},extra:{snap:t=>({sensor:t.sensor,range:t.range,output:t.output,extra:e.from(t.extra)})},state:jh,apis:Qh}),fh=(t,n,s,o,i,a)=>t.fold(()=>Qs.snap({sensor:ks(s-20,o-20),range:ee(i,a),output:ks(e.some(s),e.some(o)),extra:{td:n}}),t=>{const a=s-20,r=o-20,i=t.element.dom.getBoundingClientRect();return Qs.snap({sensor:ks(a,r),range:ee(40,40),output:ks(e.some(s-i.width/2),e.some(o-i.height/2)),extra:{td:n}})}),mh=(e,t,n)=>({getSnapPoints:e,leftAttr:"data-drag-left",topAttr:"data-drag-top",onSensor:(e,s)=>{const o=s.td;((e,t)=>e.exists(e=>G(e,t)))(t.get(),o)||(t.set(o),n(o))},mustSnap:!0}),hh=e=>V(Je.sketch({dom:{tag:"div",classes:["tox-selector"]},buttonBehaviours:i([Qs.config({mode:"mouseOrTouch",blockerClass:"blocker",snaps:e}),Oi.config({})]),eventOrder:{mousedown:["dragging","alloy.base.behaviour"],touchstart:["dragging","alloy.base.behaviour"]}})),hw=(e,t)=>{const f=v([]),c=v([]),o=v(!1),n=q(),s=q(),d=e=>{const n=Is(e);return fh(h.getOpt(t),e,n.x,n.y,n.width,n.height)},u=e=>{const n=Is(e);return fh(m.getOpt(t),e,n.right,n.bottom,n.width,n.height)},j=mh(()=>a(f.get(),e=>d(e)),n,t=>{s.get().each(n=>{e.dispatch("TableSelectorChange",{start:t,finish:n})})}),_=mh(()=>a(c.get(),e=>u(e)),s,t=>{n.get().each(n=>{e.dispatch("TableSelectorChange",{start:n,finish:t})})}),h=hh(j),m=hh(_),r=qe(h.asSpec()),i=qe(m.asSpec()),p=(t,n,s,o)=>{const i=s(n);Qs.snapTo(t,i),((t,n)=>{const a=n.dom.getBoundingClientRect();I(t.element,"display");const r=Vi(l(e.getBody())).dom.innerHeight,c=a[o]<0,d=((e,t)=>e[o]>t)(a,r);(c||d)&&y(t.element,"display","none")})(t,n)},g=e=>p(r,e,d,"top"),b=e=>p(i,e,u,"bottom");bo().deviceType.isTouch()&&(e.on("TableSelectionChange",e=>{o.get()||(Ys(t,r),Ys(t,i),o.set(!0)),n.set(e.start),s.set(e.finish),e.otherCells.each(t=>{f.set(t.upOrLeftCells),c.set(t.downOrRightCells),g(e.start),b(e.finish)})}),e.on("ResizeEditor ResizeWindow ScrollContent",()=>{n.get().each(g),s.get().each(b)}),e.on("TableSelectionClear",()=>{o.get()&&(Un(r),Un(i),o.set(!1)),n.clear(),s.clear()}))},mw=(e,t,n)=>{var s;const o=null!==(s=t.delimiter)&&void 0!==s?s:"";return{dom:{tag:"div",classes:["tox-statusbar__path"],attributes:{role:"navigation"}},behaviours:i([u.config({mode:"flow",selector:"div[role=button]"}),g.config({disabled:n.isDisabled}),re(),Z.config({}),j.config({}),w("elementPathEvents",[Q((t)=>{e.shortcuts.add("alt+F11","focus statusbar elementpath",()=>u.focusIn(t)),e.on("NodeChange",s=>{const a=(t=>{const s=[];let o=t.length;for(var n;o-- >0;){const i=t[o];if(1===i.nodeType&&"BR"!==(n=i).nodeName&&!n.getAttribute("data-mce-bogus")&&"bookmark"!==n.getAttribute("data-mce-type")){const t=sy(e,i);if(t.isDefaultPrevented()||s.push({name:t.name,element:i}),t.isPropagationStopped())break}}return s})(s.parents),r=a.length>0?Ie(a,(t,s,a)=>{const r=((t,s,o)=>Je.sketch({dom:{tag:"div",classes:["tox-statusbar__path-item"],attributes:{"data-index":o,"aria-level":o+1}},components:[be(t)],action:t=>{e.focus(),e.selection.select(s),e.nodeChanged()},buttonBehaviours:i([Oo(n.isDisabled),re()])}))(s.name,s.element,a);return 0===a?t.concat([r]):t.concat([{dom:{tag:"div",classes:["tox-statusbar__path-divider"],attributes:{"aria-hidden":!0}},components:[be(` ${o} `)]},r])},[]):[];j.set(t,r)})})])]),components:[]}};!function(e){e[e.None=0]="None",e[e.Both=1]="Both",e[e.Vertical=2]="Vertical"}(Zs||(Zs={}));const ih=(e,t,n)=>{const s=l(e.getContainer()),o=((e,t,n,s,o)=>{const i={height:rc(s+t.top,Z1(e),X1(e))};return n===Zs.Both&&(i.width=rc(o+t.left,J1(e),ir(e))),i})(e,t,n,Pe(s),et(s));Re(o,(e,t)=>{Ss(e)&&y(s,t,Il(e))}),(e=>{e.dispatch("ResizeEditor")})(e)},Cc=(t,n,s,o)=>{const i=ee(20*s,20*o);return ih(t,i,n),e.some(!0)},vw=(t,n)=>({dom:{tag:"div",classes:["tox-statusbar"]},components:(()=>{const s=(()=>{const e=[];return k3(t)&&e.push(mw(t,{},n)),t.hasPlugin("wordcount")&&e.push(((e,t)=>{const n=(e,n,s)=>j.set(e,[be(t.translate(["{0} "+s,n[s]]))]);return Je.sketch({dom:{tag:"button",classes:["tox-statusbar__wordcount"]},components:[],buttonBehaviours:i([Oo(t.isDisabled),re(),Z.config({}),j.config({}),r.config({store:{mode:"memory",initialValue:{mode:"words",count:{words:0,characters:0}}}}),w("wordcount-events",[Vn(e=>{const t=r.getValue(e),s="words"===t.mode?"characters":"words";r.setValue(e,{mode:s,count:t.count}),n(e,t.count,s)}),Q(t=>{e.on("wordCountUpdate",e=>{const{mode:s}=r.getValue(t);r.setValue(t,{mode:s,count:e.wordCount}),n(t,e.wordCount,s)})})])]),eventOrder:{[ut()]:["disabling","alloy.base.behaviour","wordcount-events"]}})})(t,n)),A3(t)&&e.push({dom:{tag:"span",classes:["tox-statusbar__branding"]},components:[{dom:{tag:"a",attributes:{href:"https://www.tiny.cloud/powered-by-tiny?utm_campaign=editor_referral&utm_medium=poweredby&utm_source=tinymce&utm_content=v6",rel:"noopener",target:"_blank","aria-label":xt.translate(["Powered by {0}","Tiny"])},innerHtml:`<svg width="50px" height="16px" viewBox="0 0 50 16" xmlns="http://www.w3.org/2000/svg">
  <path fill-rule="evenodd" clip-rule="evenodd" d="M10.143 0c2.608.015 5.186 2.178 5.186 5.331 0 0 .077 3.812-.084 4.87-.361 2.41-2.164 4.074-4.65 4.496-1.453.284-2.523.49-3.212.623-.373.071-.634.122-.785.152-.184.038-.997.145-1.35.145-2.732 0-5.21-2.04-5.248-5.33 0 0 0-3.514.03-4.442.093-2.4 1.758-4.342 4.926-4.963 0 0 3.875-.752 4.036-.782.368-.07.775-.1 1.15-.1Zm1.826 2.8L5.83 3.989v2.393l-2.455.475v5.968l6.137-1.189V9.243l2.456-.476V2.8ZM5.83 6.382l3.682-.713v3.574l-3.682.713V6.382Zm27.173-1.64-.084-1.066h-2.226v9.132h2.456V7.743c-.008-1.151.998-2.064 2.149-2.072 1.15-.008 1.987.92 1.995 2.072v5.065h2.455V7.359c-.015-2.18-1.657-3.929-3.837-3.913a3.993 3.993 0 0 0-2.908 1.296Zm-6.3-4.266L29.16 0v2.387l-2.456.475V.476Zm0 3.2v9.132h2.456V3.676h-2.456Zm18.179 11.787L49.11 3.676H46.58l-1.612 4.527-.46 1.382-.384-1.382-1.611-4.527H39.98l3.3 9.132L42.15 16l2.732-.537ZM22.867 9.738c0 .752.568 1.075.921 1.075.353 0 .668-.047.998-.154l.537 1.765c-.23.154-.92.537-2.225.537-1.305 0-2.655-.997-2.686-2.686a136.877 136.877 0 0 1 0-4.374H18.8V3.676h1.612v-1.98l2.455-.476v2.456h2.302V5.9h-2.302v3.837Z"/>
</svg>
`.trim()},behaviours:i([b.config({})])}]}),e.length>0?[{dom:{tag:"div",classes:["tox-statusbar__text-container"]},components:e}]:[]})(),o=((t,n)=>{const s=(e=>{const t=S3(e);return!1===t?Zs.None:"both"===t?Zs.Both:Zs.Vertical})(t);return s===Zs.None?e.none():e.some(gn("resize-handle",{tag:"div",classes:["tox-statusbar__resize-handle"],attributes:{title:n.translate("Resize")},behaviours:[Qs.config({mode:"mouse",repositionTarget:!1,onDrag:(e,n,o)=>ih(t,o,s),blockerClass:"tox-blocker"}),u.config({mode:"special",onLeft:()=>Cc(t,s,-1,0),onRight:()=>Cc(t,s,1,0),onUp:()=>Cc(t,s,0,-1),onDown:()=>Cc(t,s,0,1)}),Z.config({}),b.config({})]},n.icons))})(t,n);return s.concat(o.toArray())})()}),Q3=(e,t)=>t.get().getOrDie(`UI for ${e} has not been rendered`),jw=t=>{const a=t.inline,C=a?c8:b8,f=Oa(t)?ng:$g,s=(()=>{const e=q(),n=q(),t=q();return{dialogUi:e,popupUi:n,mainUi:t,getUiMotherships:()=>[...e.get().map(e=>e.mothership).toArray()],setupDialogUi:t=>{e.set(t)},lazyGetInOuterOrDie:(e,n)=>()=>t.get().bind(e=>n(e.outerContainer)).getOrDie(`Could not find ${e} element in OuterContainer`)}})(),j=q(),d=q(),p=bo().deviceType.isTouch()?["tox-platform-touch"]:[],r=V1(t),m=Vo(t),b=V({dom:{tag:"div",classes:["tox-anchorbar"]}}),c=()=>s.mainUi.get().map(e=>e.outerContainer).bind(H.getHeader),_=s.lazyGetInOuterOrDie("anchor bar",b.getOpt),w=s.lazyGetInOuterOrDie("toolbar",H.getToolbar),O=s.lazyGetInOuterOrDie("throbber",H.getThrobber),n=((t,n,s)=>{const i=v(!1),a=(e=>{const t=v(V1(e)?"bottom":"top");return{isPositionedAtTop:()=>"top"===t.get(),getDockingMode:t.get,setDockingMode:t.set}})(n),l={icons:()=>n.ui.registry.getAll().icons,menuItems:()=>n.ui.registry.getAll().menuItems,translate:xt.translate,isDisabled:()=>n.mode.isReadOnly()||!n.ui.isEnabled(),getOption:n.options.get},d=Hv(n),u=(t=>{const n=e=>()=>t.formatter.match(e),s=n=>()=>{const s=t.formatter.get(n);return void 0!==s?e.some({tag:s.length>0&&(s[0].inline||s[0].block)||"div",styles:t.dom.parseStyle(t.formatter.getCssText(n))}):e.none()},o=v([]),i=v([]),a=v(!1);return t.on("PreInit",e=>{const i=X5(t),a=V5(t,i,n,s);o.set(a)}),t.on("addStyleModifications",e=>{const o=V5(t,e.items,n,s);i.set(o),a.set(e.replace)}),{getData:()=>{const e=a.get()?[]:o.get(),t=i.get();return e.concat(t)}}})(n),h=(e=>({colorPicker:sv(e),hasCustomColors:ov(e),getColors:iv(e),getColorCols:av(e)}))(n),m=(e=>({isDraggableModal:rv(e)}))(n),o={shared:{providers:l,anchors:nv(n,s,a.isPositionedAtTop),header:a},urlinput:d,styles:u,colorinput:h,dialog:m,isContextMenuOpen:()=>i.get(),setContextMenuState:e=>i.set(e)},r={...o,shared:{...o.shared,interpreter:e=>F7(e,{},r),getSink:t.popup}},c={...o,shared:{...o.shared,interpreter:e=>F7(e,{},c),getSink:t.dialog}};return{popup:r,dialog:c}})({popup:()=>x.fromOption(s.popupUi.get().map(e=>e.sink),"(popup) UI has not been rendered"),dialog:()=>x.fromOption(s.dialogUi.get().map(e=>e.sink),"UI has not been rendered")},t,_),E=z,k=()=>{const s=(()=>{const e={attributes:{[ll]:r?ns.BottomToTop:ns.TopToBottom}},s=H.parts.menubar({dom:{tag:"div",classes:["tox-menubar"]},backstage:n.popup,onEscape:()=>{t.focus()}}),l=H.parts.toolbar({dom:{tag:"div",classes:["tox-toolbar"]},getSink:n.popup.shared.getSink,providers:n.popup.shared.providers,onEscape:()=>{t.focus()},onToolbarToggled:e=>{((e,t)=>{e.dispatch("ToggleToolbarDrawer",{state:t})})(t,e)},type:m,lazyToolbar:w,lazyHeader:()=>c().getOrDie("Could not find header element"),...e}),d=H.parts["multiple-toolbar"]({dom:{tag:"div",classes:["tox-toolbar-overlord"]},providers:n.popup.shared.providers,onEscape:()=>{t.focus()},type:m}),o=ya(t),i=er(t),a=tr(t),u=T3(t),h=H.parts.promotion({dom:{tag:"div",classes:["tox-promotion"]}}),f=o||i||a,p=u?[h,s]:[s];return H.parts.header({dom:{tag:"div",classes:["tox-editor-header"].concat(f?[]:["tox-editor-header--empty"]),...e},components:Se([a?p:[],o?[d]:i?[l]:[],wa(t)?[]:[b.asSpec()]]),sticky:Oa(t),editor:t,sharedBackstage:n.popup.shared})})(),h={dom:{tag:"div",classes:["tox-sidebar-wrap"]},components:[H.parts.socket({dom:{tag:"div",classes:["tox-edit-area"]}}),H.parts.sidebar({dom:{tag:"div",classes:["tox-sidebar"]}})]},f=H.parts.throbber({dom:{tag:"div",classes:["tox-throbber"]},backstage:n.popup}),v=H.parts.viewWrapper({backstage:n.popup}),y=E3(t)&&!a?e.some(vw(t,n.popup.shared.providers)):e.none(),_=Se([r?[]:[s],a?[]:[h],r?[s]:[]]),O=H.parts.editorContainer({components:Se([_,a?[]:y.toArray()])}),o=N1(t),x={role:"application",...xt.isRtl()?{dir:"rtl"}:{},...o?{"aria-hidden":"true"}:{}},l=qe(H.sketch({dom:{tag:"div",classes:["tox","tox-tinymce"].concat(a?["tox-tinymce-inline"]:[]).concat(r?["tox-tinymce--toolbar-bottom"]:[]).concat(p),styles:{visibility:"hidden",...o?{opacity:"0",border:"0"}:{}},attributes:x},components:[O,...a?[]:[v],f],behaviours:i([re(),g.config({disableClass:"tox-tinymce--disabled"}),u.config({mode:"cyclic",selector:".tox-menubar, .tox-toolbar, .tox-toolbar__primary, .tox-toolbar__overflow--open, .tox-sidebar__overflow--open, .tox-statusbar__path, .tox-statusbar__wordcount, .tox-statusbar__branding a, .tox-statusbar__resize-handle"})])})),d=C6(l);return j.set(d),{mothership:d,outerContainer:l}},A=e=>{const n=Il((e=>{const t=(e=>{const t=n4(e),n=Z1(e),s=X1(e);return Bl(t).map(e=>rc(e,n,s))})(e);return t.getOr(n4(e))})(t)),s=Il((e=>h8(e).getOr(e4(e)))(t));return t.inline||(Fp("div","width",s)&&y(e.element,"width",s),Fp("div","height",n)?y(e.element,"height",n):y(e.element,"height","400px")),n};return{popups:{backstage:n.popup,getMothership:()=>Q3("popups",d)},dialogs:{backstage:n.dialog,getMothership:()=>Q3("dialogs",d)},renderUI:()=>{const r=k(),a=(()=>{const e=I1(t),a=G(Hn(),e)&&"grid"===ft(e,"display"),r={dom:{tag:"div",classes:["tox","tox-silver-sink","tox-tinymce-aux"].concat(p),attributes:{...xt.isRtl()?{dir:"rtl"}:{}}},behaviours:i([Ye.config({useFixed:()=>f.isDocked(c)})])},l={dom:{styles:{width:document.body.clientWidth+"px"}},events:$([o(nr(),e=>{y(e.element,"width",document.body.clientWidth+"px")})])},n=qe(te(r,a?l:{})),s=C6(n);return d.set(s),{sink:n,mothership:s}})(),u=E(a);return s.dialogUi.set(a),s.popupUi.set(u),s.mainUi.set(r),(s=>{const{mainUi:i,popupUi:a,uiMotherships:r}=s;je(u3(t),(e,n)=>{t.ui.registry.addGroupToolbarButton(n,e)});const{buttons:d,menuItems:u,contextToolbars:p,sidebars:g,views:v}=t.ui.registry.getAll(),b=U1(t),j={menuItems:u,menus:K3(t),menubar:v3(t),toolbar:b.getOrThunk(()=>La(t)),allowToolbarGroups:m===kt.floating,buttons:d,sidebar:g,views:v};var o=i.outerContainer;t.addShortcut("alt+F9","focus menubar",()=>{H.focusMenubar(o)}),t.addShortcut("alt+F10","focus toolbar",()=>{H.focusToolbar(o)}),t.addCommand("ToggleToolbarDrawer",()=>{H.toggleToolbarDrawer(o)}),t.addQueryStateHandler("ToggleToolbarDrawer",()=>H.isToolbarDrawerToggled(o)),((e,t,n)=>{const i=(e,s)=>{h([t,...n],t=>{t.broadcastEvent(e,s)})},s=(e,s)=>{h([t,...n],t=>{t.broadcastOn([e],s)})},c=e=>s(Es(),{target:e.target}),o=jl(),v=Ke(o,"touchstart",c),_=Ke(o,"touchmove",e=>i(G9(),e)),y=Ke(o,"touchend",e=>i(X9(),e)),j=Ke(o,"mousedown",c),b=Ke(o,"mouseup",e=>{0===e.raw.button&&s(Id(),{target:e.target})}),a=e=>s(Es(),{target:l(e.target)}),p=e=>{0===e.button&&s(Id(),{target:l(e.target)})},g=()=>{h(e.editorManager.get(),t=>{e!==t&&t.dispatch("DismissPopups",{relatedTarget:e})})},r=e=>i(ju(),F0(e)),f=e=>{s(ci(),{}),i(nr(),F0(e))},m=()=>s(ci(),{}),u=t=>{t.state&&s(Es(),{target:l(e.getContainer())})},d=e=>{s(Es(),{target:l(e.relatedTarget.getContainer())})};e.on("PostRender",()=>{e.on("click",a),e.on("tap",a),e.on("mouseup",p),e.on("mousedown",g),e.on("ScrollWindow",r),e.on("ResizeWindow",f),e.on("ResizeEditor",m),e.on("AfterProgressState",u),e.on("DismissPopups",d)}),e.on("remove",()=>{e.off("click",a),e.off("tap",a),e.off("mouseup",p),e.off("mousedown",g),e.off("ScrollWindow",r),e.off("ResizeWindow",f),e.off("ResizeEditor",m),e.off("AfterProgressState",u),e.off("DismissPopups",d),j.unbind(),v.unbind(),_.unbind(),y.unbind(),b.unbind()}),e.on("detach",()=>{h([t,...n],$y),h([t,...n],e=>e.destroy())})})(t,i.mothership,r),f.setup(t,n.popup.shared,c),n_(t,n.popup),O_(t,n.popup.shared.getSink,n.popup),(t=>{const{sidebars:n}=t.ui.registry.getAll();h(ce(n),s=>{const i=n[s],o=()=>sn(e.from(t.queryCommandValue("ToggleSidebar")),s);t.ui.registry.addToggleButton(s,{icon:i.icon,tooltip:i.tooltip,onAction:e=>{t.execCommand("ToggleSidebar",!1,s),e.setActive(o())},onSetup:e=>{e.setActive(o());const n=()=>e.setActive(o());return t.on("ToggleSidebar",n),()=>{t.off("ToggleSidebar",n)}}})})})(t),fb(t,O,n.popup.shared),Uy(t,p,a.sink,{backstage:n.popup}),hw(t,a.sink);const y={targetNode:t.getElement(),height:A(i.outerContainer)};return C.render(t,s,j,n.popup,y)})({popupUi:u,dialogUi:a,mainUi:r,uiMotherships:s.getUiMotherships()})}}},yw=n([s("lazySink"),D("dragBlockClass"),ue("getBounds",Sn),t("useTabstopAt",Oe),t("eventOrder",{}),fe("modalBehaviours",[u]),ot("onExecute"),m4("onEscape")]),bl={sketch:z},ww=n([wt({name:"draghandle",overrides:(e,t)=>({behaviours:i([Qs.config({mode:"mouse",getTarget:e=>sr(e,'[role="dialog"]').getOr(e),blockerClass:e.dragBlockClass.getOrDie(new Error(`The drag blocker class was not specified for a dialog with a drag handle: 
`+JSON.stringify(t,null,2)).message),getBounds:e.getDragBounds})])})}),Fe({schema:[s("dom")],name:"title"}),Fe({factory:bl,schema:[s("dom")],name:"close"}),Fe({factory:bl,schema:[s("dom")],name:"body"}),wt({factory:bl,schema:[s("dom")],name:"footer"}),Lt({factory:{sketch:(e,t)=>({...e,dom:t.dom,components:t.components})},schema:[t("dom",{tag:"div",styles:{position:"fixed",left:"0px",top:"0px",right:"0px",bottom:"0px"}}),t("components",[])],name:"blocker"})]),ae=Be({name:"ModalDialog",configFields:yw(),partFields:ww(),factory:(t,n,s,o)=>{const a=q(),r=d("modal-events"),c={...t.eventOrder,[Vs()]:[r].concat(t.eventOrder["alloy.system.attached"]||[])};return{uid:t.uid,dom:t.dom,components:n,apis:{show:e=>{a.set(e);const n=t.lazySink(e).getOrDie(),s=o.blocker(),r=n.getSystem().build({...s,components:s.components.concat([Pt(e)]),behaviours:i([b.config({}),w("dialog-blocker-events",[Ko(Ms(),()=>{u.focusIn(e)})])])});Ys(n,r),u.focusIn(e)},hide:e=>{a.clear(),Cn(e.element).each(t=>{e.getSystem().getByDom(t).each(e=>{Un(e)})})},getBody:e=>kn(e,t,"body"),getFooter:e=>kn(e,t,"footer"),setIdle:e=>{Jn.unblock(e)},setBusy:(e,t)=>{Jn.block(e,t)}},eventOrder:c,domModification:{attributes:{role:"dialog","aria-modal":"true"}},behaviours:ye(t.modalBehaviours,[j.config({}),u.config({mode:"cyclic",onEnter:t.onExecute,onEscape:t.onEscape,useTabstopAt:t.useTabstopAt}),Jn.config({getRoot:a.get}),w(r,[Q(n=>{((e,t)=>{const n=_t(e,"id").fold(()=>{const e=d("dialog-label");return _(t,"id",e),e},z);_(e,"aria-labelledby",n)})(n.element,kn(n,t,"title").element),((t,n)=>{const s=e.from(Ne(t,"id")).fold(()=>{const e=d("dialog-describe");return _(n,"id",e),e},z);_(t,"aria-describedby",s)})(n.element,kn(n,t,"body").element)})])])}},apis:{show:(e,t)=>{e.show(t)},hide:(e,t)=>{e.hide(t)},getBody:(e,t)=>e.getBody(t),getFooter:(e,t)=>e.getFooter(t),setBusy:(e,t,n)=>{e.setBusy(t,n)},setIdle:(e,t)=>{e.setIdle(t)}}}),xw=m([se,C1].concat(Eo)),Cw=ca,P3=[v1("button"),un,zn("align","end",["start","end"]),Qa,Kt,m7("buttonType",["primary","secondary"])],z3=[...P3,In],vl=[pi("type",["submit","cancel","custom"]),...z3],Sw=[pi("type",["menu"]),Do,qa,un,St("items",xw),...P3],Mw=lt("type",{submit:vl,cancel:vl,custom:vl,menu:Sw}),Fw=[se,In,pi("level",["info","warn","error","success"]),Bh,t("url","")],Tw=m(Fw),zw=[se,In,Kt,v1("button"),un,z_,m7("buttonType",["primary","secondary","toolbar"]),Qa],Dw=m(zw),ri=[se,C1],on=ri.concat([w1]),Rw=ri.concat([x1,Kt]),Pw=m(Rw),Hw=ca,Iw=on.concat([im("auto")]),Bw=m(Iw),Vw=od([Da,In,Bh]),$w=on.concat([Dn("storageKey","default")]),Ww=m($w),Uw=Ee,Kw=m(on),qw=Ee,Yw=ri.concat([Dn("tag","textarea"),he("scriptId"),he("scriptUrl"),Mt("settings",void 0,D9)]),Gw=ri.concat([Dn("tag","textarea"),Rt("init")]),Xw=ma(e=>X("customeditor.old",gt(Gw),e).orThunk(()=>X("customeditor.new",gt(Yw),e))),Qw=Ee,Zw=m(on),Jw=Cs(s6),eO=e=>[se,B7("columns"),e],tO=[se,he("html"),zn("presets","presentation",["presentation","document"])],nO=m(tO),sO=on.concat([ht("sandboxed",!0),ht("transparent",!0)]),oO=m(sO),iO=Ee,aO=m(ri.concat([nt("height")])),rO=m([he("url"),Fa("zoom"),Fa("cachedWidth"),Fa("cachedHeight")]),cO=on.concat([nt("inputMode"),nt("placeholder"),ht("maximized",!1),Kt]),lO=m(cO),dO=Ee,uO=e=>[se,x1,e],hO=[In,Da],mO=[In,St("items",((e,t)=>{const n=vs(t);return{extract:(e,t)=>n().extract(e,t),toString:()=>n().toString()}})(0,()=>m3))],m3=td([m(hO),m(mO)]),pO=on.concat([St("items",m3),Kt]),gO=m(pO),vO=Ee,bO=on.concat([j7("items",[In,Da]),Kd("size",1),Kt]),jO=m(bO),yO=Ee,_O=on.concat([ht("constrain",!0),Kt]),wO=m(_O),h3=m([he("width"),he("height")]),xO=ri.concat([x1,Kd("min",0),Kd("max",0)]),CO=m(xO),EO=br,kO=[se,St("header",Ee),St("cells",Cs(Ee))],AO=m(kO),SO=on.concat([nt("placeholder"),ht("maximized",!1),Kt]),MO=m(SO),FO=Ee,TO=on.concat([zn("filetype","file",["image","media","file"]),Kt]),zO=m(TO),DO=m([Da,_1]),pl=e=>xe("items","items",{tag:"required",process:{}},Cs(ma(t=>X(`Checking item of ${e}`,fl,t).fold(e=>x.error(Bo(e)),e=>x.value(e))))),fl=v6(()=>{return dr("type",{alertbanner:Tw,bar:m((e=pl("bar"),[se,e])),button:Dw,checkbox:Pw,colorinput:Ww,colorpicker:Kw,dropzone:Zw,grid:m(eO(pl("grid"))),iframe:oO,input:lO,listbox:gO,selectbox:jO,sizeinput:wO,slider:CO,textarea:MO,urlinput:zO,customeditor:Xw,htmlpanel:nO,imagepreview:aO,collection:Bw,label:m(uO(pl("label"))),table:AO,panel:J2});var e}),RO=[se,t("classes",[]),St("items",fl)],J2=m(RO),HO=[v1("tab"),Z_,St("items",fl)],IO=[se,j7("tabs",HO)],BO=m(IO),VO=z3,$O=Mw,WO=m([he("title"),vt("body",dr("type",{panel:J2,tabpanel:BO})),Dn("size","normal"),St("buttons",$O),t("initialData",{}),ue("onAction",c),ue("onChange",c),ue("onSubmit",c),ue("onClose",c),ue("onCancel",c),ue("onTabChange",c)]),UO=m([pi("type",["cancel","custom"]),...VO]),KO=m([he("title"),he("url"),Fa("height"),Fa("width"),s7("buttons",UO),ue("onAction",c),ue("onCancel",c),ue("onClose",c),ue("onMessage",c)]),ml=e=>os(e)?[e].concat(le(H1(e),ml)):bs(e)?le(e,ml):[],YO=e=>L(e.type)&&L(e.name),GO={checkbox:Hw,colorinput:Uw,colorpicker:qw,dropzone:Jw,input:dO,iframe:iO,imagepreview:rO,selectbox:yO,sizeinput:h3,slider:EO,listbox:vO,size:h3,textarea:FO,urlinput:DO,customeditor:Qw,collection:Vw,togglemenuitem:Cw},XO=t=>{const n=(e=>K(ml(e),YO))(t),s=le(n,t=>(t=>e.from(GO[t.type]))(t).fold(()=>[],e=>[vt(t.name,e)]));return m(s)},K2=e=>{var t;return{internalDialog:an(X("dialog",WO,e)),dataValidator:XO(e),initialData:null!==(t=e.initialData)&&void 0!==t?t:{}}},Mi={open:(e,t)=>{const n=K2(t);return e(n.internalDialog,n.initialData,n.dataValidator)},openUrl:(e,t)=>e(an(X("dialog",KO,t))),redial:e=>K2(e)},B2=e=>{const t=[],n={};return Re(e,(e,s)=>{e.fold(()=>{t.push(s)},e=>{n[s]=e})}),t.length>0?x.error(t):x.value(n)},ex=(e,t,n)=>{const s=V(Fo.sketch(s=>({dom:{tag:"div",classes:["tox-form"].concat(e.classes)},components:a(e.items,e=>S7(s,e,t,n))})));return{dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[s.asSpec()]}],behaviours:i([u.config({mode:"acyclic",useTabstopAt:Ta(ra)}),(o=s,O.config({find:o.getOpt})),Iv(s,{postprocess:e=>B2(e).fold(e=>(console.error(e),{}),z)})])};var o},tx=pt({name:"TabButton",configFields:[t("uid",void 0),s("value"),xe("dom","dom",Kl(()=>({attributes:{role:"tab",id:d("aria"),"aria-selected":"false"}})),ln()),D("action"),t("domModification",{}),fe("tabButtonBehaviours",[b,u,r]),s("view")],factory:(e)=>({uid:e.uid,dom:e.dom,components:e.components,events:wr(e.action),behaviours:ye(e.tabButtonBehaviours,[b.config({}),u.config({mode:"execution",useSpace:!0,useEnter:!0}),r.config({store:{mode:"memory",initialValue:e.value}})]),domModification:e.domModification})}),nx=n([s("tabs"),s("dom"),t("clickToDismiss",!1),fe("tabbarBehaviours",[F,u]),$s(["tabClass","selectedClass"])]),sx=dc({factory:tx,name:"tabs",unit:"tab",overrides:e=>{const t=(e,t)=>{F.dehighlight(e,t),p(e,rp(),{tabbar:e,button:t})},n=(e,t)=>{F.highlight(e,t),p(e,gp(),{tabbar:e,button:t})};return{action:s=>{const o=s.getSystem().getByUid(e.uid).getOrDie(),i=F.isHighlighted(o,s);(i&&e.clickToDismiss?t:i?c:n)(o,s)},domModification:{classes:[e.markers.tabClass]}}}}),ox=n([sx]),z2=Be({name:"Tabbar",configFields:nx(),partFields:ox(),factory:(e,t)=>({uid:e.uid,dom:e.dom,components:t,"debug.sketcher":"Tabbar",domModification:{attributes:{role:"tablist"}},behaviours:ye(e.tabbarBehaviours,[F.config({highlightClass:e.markers.selectedClass,itemClass:e.markers.tabClass,onHighlight:(e,t)=>{_(t.element,"aria-selected","true")},onDehighlight:(e,t)=>{_(t.element,"aria-selected","false")}}),u.config({mode:"flow",getInitial:e=>F.getHighlighted(e).map(e=>e.element),selector:"."+e.markers.tabClass,executeOnMove:!0})])})}),ax=pt({name:"Tabview",configFields:[fe("tabviewBehaviours",[j])],factory:(e)=>({uid:e.uid,dom:e.dom,behaviours:ye(e.tabviewBehaviours,[j.config({})]),domModification:{attributes:{role:"tabpanel"}}})}),rx=n([t("selectFirst",!0),C("onChangeTab"),C("onDismissTab"),t("tabs",[]),fe("tabSectionBehaviours",[])]),cx=Fe({factory:z2,schema:[s("dom"),Os("markers",[s("tabClass"),s("selectedClass")])],name:"tabbar",defaults:e=>({tabs:e.tabs})}),lx=Fe({factory:ax,name:"tabview"}),dx=n([cx,lx]),li=Be({name:"TabSection",configFields:rx(),partFields:dx(),factory:(e,t)=>{const i=(t,n)=>{P(t,e,"tabbar").each(e=>{n(e).each(Js)})};return{uid:e.uid,dom:e.dom,components:t,behaviours:iu(e.tabSectionBehaviours),events:$(Se([e.selectFirst?[Q((e)=>{i(e,F.getFirst)})]:[],[o(gp(),(t,n)=>{(t=>{const n=r.getValue(t);P(t,e,"tabview").each(s=>{ne(e.tabs,e=>e.value===n).each(n=>{const o=n.view();_t(t.element,"id").each(e=>{_(s.element,"aria-labelledby",e)}),j.set(s,o),e.onChangeTab(s,t,o)})})})(n.event.button)}),o(rp(),(t,n)=>{const s=n.event.button;e.onDismissTab(t,s)})]])),apis:{getViewItems:t=>P(t,e,"tabview").map(e=>j.contents(e)).getOr([]),showTab:(e,t)=>{i(e,e=>{const n=F.getCandidates(e);return ne(n,e=>r.getValue(e)===t).filter(t=>!F.isHighlighted(e,t))})}}}},apis:{getViewItems:(e,t)=>e.getViewItems(t),showTab:(e,t,n)=>{e.showTab(t,n)}}}),A2=(e,t)=>{y(e,"height",t+"px"),y(e,"flex-basis",t+"px")},Ac=(e,t,n)=>{sr(e,'[role="dialog"]').each(e=>{pe(e,'[role="tablist"]').each(s=>{n.get().map(n=>(y(t,"height","0"),y(t,"flex-basis","0"),Math.min(n,((e,t,n)=>{const s=B1(e).dom,a=sr(e,".tox-dialog-wrap").getOr(e);let o;o="fixed"===ft(a,"position")?Math.max(s.clientHeight,window.innerHeight):Math.max(s.offsetHeight,s.scrollHeight);const i=Pe(t),r=t.dom.offsetLeft>=n.dom.offsetLeft+et(n)?Math.max(Pe(n),i):i,c=parseInt(ft(e,"margin-top"),10)||0,l=parseInt(ft(e,"margin-bottom"),10)||0;return o-(Pe(e)+c+l-r)})(e,t,s)))).each(e=>{A2(t,e)})})})},hl=e=>pe(e,'[role="tabpanel"]'),E2="send-data-to-section",C2="send-data-to-view",vx=(t,n,s)=>{const c=v({}),l=e=>{const t=r.getValue(e),n=B2(t).getOr({}),s=c.get(),o=te(s,n);c.set(o)},d=e=>{const t=c.get();r.setValue(e,t)},h=v(null),m=a(t.tabs,e=>({value:e.name,dom:{tag:"div",classes:["tox-dialog__body-nav-item"]},components:[be(s.shared.providers.translate(e.title))],view:()=>[Fo.sketch(t=>({dom:{tag:"div",classes:["tox-form"]},components:a(e.items,e=>S7(t,e,n,s)),formBehaviours:i([u.config({mode:"acyclic",useTabstopAt:Ta(ra)}),w("TabView.form.events",[Q(d),_n(l)]),Vt.config({channels:xo([{key:E2,value:{onReceive:l}},{key:C2,value:{onReceive:d}}])})])}))]})),f=(e=>{const t=q(),n=[Q(n=>{const s=n.element;hl(s).each(o=>{y(o,"visibility","hidden"),n.getSystem().getByDom(o).toOptional().each(n=>{const s=((e,t,n)=>a(e,(s,o)=>{j.set(n,e[o].view());const i=t.dom.getBoundingClientRect();return j.set(n,[]),i.height}))(e,o,n),i=(e=>Zn(T2(e,(e,t)=>e>t?-1:e<t?1:0)))(s);i.fold(t.clear,t.set)}),Ac(s,o,t),I(o,"visibility"),((e,t)=>{Zn(e).each(e=>li.showTab(t,e.value))})(e,n),requestAnimationFrame(()=>{Ac(s,o,t)})})}),o(nr(),e=>{const n=e.element;hl(n).each(e=>{Ac(n,e,t)})}),o(U6,(e)=>{const s=e.element;hl(s).each(e=>{const i=Wn(Tt(e));y(e,"visibility","hidden");const n=Le(e,"height").map(e=>parseInt(e,10));I(e,"height"),I(e,"flex-basis");const o=e.dom.getBoundingClientRect().height;n.forall(e=>o>e)?(t.set(o),Ac(s,e,t)):n.each(t=>{A2(e,t)}),I(e,"visibility"),i.each(Xn)})})];return{extraEvents:n,selectFirst:!1}})(m);return li.sketch({dom:{tag:"div",classes:["tox-dialog__body"]},onChangeTab:(e,t)=>{const s=r.getValue(t);p(e,W6,{name:s,oldName:h.get()}),h.set(s)},tabs:m,components:[li.parts.tabbar({dom:{tag:"div",classes:["tox-dialog__body-nav"]},components:[z2.parts.tabs({})],markers:{tabClass:"tox-tab",selectedClass:"tox-dialog__body-nav-item--active"},tabbarBehaviours:i([Z.config({})])}),li.parts.tabview({dom:{tag:"div",classes:["tox-dialog__body-content"]}})],selectFirst:f.selectFirst,tabSectionBehaviours:i([w("tabpanel",f.extraEvents),u.config({mode:"acyclic"}),O.config({find:e=>Zn(li.getViewItems(e))}),Ao(e.none(),e=>(e.getSystem().broadcastOn([E2],{}),c.get()),(e,t)=>{c.set(t),e.getSystem().broadcastOn([C2],{})})])})},ul=d("update-dialog"),w2=d("update-title"),_2=d("update-body"),b2=d("update-footer"),g2=d("body-send-message"),p2=(t,n,s,o,a)=>({dom:{tag:"div",classes:["tox-dialog__content-js"],attributes:{...s.map(e=>({id:e})).getOr({}),...a?{"aria-live":"polite"}:{}}},components:[],behaviours:i([Zd(0),rt.config({channel:`${_2}-${n}`,updateState:(t,n)=>e.some({isTabPanel:()=>"tabpanel"===n.body.type}),renderComponents:e=>{const t=e.body;return"tabpanel"===t.type?[vx(t,e.initialData,o)]:[ex(t,e.initialData,o)]},initialData:t})])});function oo(e){return oo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},oo(e)}function dl(e,t){return dl=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},dl(e,t)}function Ex(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function rl(){return rl=Ex()?Reflect.construct:function(e,t,n){var o,s=[null];return s.push.apply(s,t),o=new(Function.bind.apply(e,s)),n&&dl(o,n.prototype),o},rl.apply(null,arguments)}function Qt(e){return function(e){if(Array.isArray(e))return il(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return il(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?il(e,t):void 0}}(e)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function il(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,s=new Array(t);n<t;n++)s[n]=e[n];return s}var Mx=Object.hasOwnProperty,m2=Object.setPrototypeOf,Tx=Object.isFrozen,zx=Object.getPrototypeOf,Dx=Object.getOwnPropertyDescriptor,ct=Object.freeze,An=Object.seal,Rx=Object.create,c2="undefined"!=typeof Reflect&&Reflect,Mc=c2.apply,ol=c2.construct;Mc||(Mc=function(e,t,n){return e.apply(t,n)}),ct||(ct=function(e){return e}),An||(An=function(e){return e}),ol||(ol=function(e,t){return rl(e,Qt(t))});var a2,Vx=fn(Array.prototype.forEach),$x=fn(Array.prototype.pop),vi=fn(Array.prototype.push),Bc=fn(String.prototype.toLowerCase),Kx=fn(String.prototype.match),_s=fn(String.prototype.replace),Yx=fn(String.prototype.indexOf),Gx=fn(String.prototype.trim),st=fn(RegExp.prototype.test),nl=(a2=TypeError,function(){for(var t=arguments.length,n=new Array(t),e=0;e<t;e++)n[e]=arguments[e];return ol(a2,n)});function fn(e){return function(t){for(var s=arguments.length,o=new Array(s>1?s-1:0),n=1;n<s;n++)o[n-1]=arguments[n];return Mc(e,t,o)}}function N(e,t){m2&&m2(e,null);for(var n,s,o=t.length;o--;)n=t[o],"string"==typeof n&&(s=Bc(n),s!==n&&(Tx(t)||(t[o]=s),n=s)),e[n]=!0;return e}function Ts(e){var t,n=Rx(null);for(t in e)Mc(Mx,e,[t])&&(n[t]=e[t]);return n}function Vc(e,t){for(;null!==e;){var n=Dx(e,t);if(n){if(n.get)return fn(n.get);if("function"==typeof n.value)return fn(n.value)}e=zx(e)}return function(e){return console.warn("fallback value for",e),null}}var H,Jp,$0,tm,Ct,lf,J8,V3,W1,$o,Cf,o6,dg,ns,q2,s3,nm,Nf,vp,bp,Cg,E5,O5,r5,t6,sf,p8,J3,Z3,$r,H2,L2,u2,R0,H4,Y4,l0,v0,j0,L0,q0,Y0,X0,Ue,ia,xt,q3,D1,Ut,gs,nc,S6,M6,T6,pp,bg,Ag,Rg,l5,is,W5,q5,Y5,Ug,$g,ng,cr,mp,hp,no,Gi,Jo,b8,c8,Qh,Kh,Ih,yl,wh,jh,Zs,I0=ct(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),el=ct(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Jc=ct(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),iC=ct(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Zc=ct(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),rC=ct(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),k0=ct(["#text"]),E0=ct(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),Qc=ct(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),x0=ct(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),$c=ct(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),mC=An(/\{\{[\w\W]*|[\w\W]*\}\}/gm),fC=An(/<%[\w\W]*|[\w\W]*%>/gm),pC=An(/^data-[-\w.\u00B7-\uFFFF]/),gC=An(/^aria-[-\w]+$/),vC=An(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.-]+(?:[^a-z+.\-:]|$))/i),bC=An(/^(?:\w+script|data):/i),jC=An(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),yC=An(/^html$/i),_C=function(){return"undefined"==typeof window?null:window},wC=function(e,t){if("object"!==oo(e)||"function"!=typeof e.createPolicy)return null;var s,n=null,o="data-tt-policy-suffix";t.currentScript&&t.currentScript.hasAttribute(o)&&(n=t.currentScript.getAttribute(o)),s="dompurify"+(n?"#"+n:"");try{return e.createPolicy(s,{createHTML:function(e){return e}})}catch{return console.warn("TrustedTypes policy "+s+" could not be created."),null}},OC=function e(){if(n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_C(),t=function(t){return e(t)},t.version="2.3.8",t.removed=[],!n||!n.document||9!==n.document.nodeType)return t.isSupported=!1,t;var L=n.document,d=n.document,ae=n.DocumentFragment,Te=n.HTMLTemplateElement,R=n.Node,he=n.Element,P=n.NodeFilter,le=n.NamedNodeMap,Ce=void 0===le?n.NamedNodeMap||n.MozNamedAttrMap:le,Ee=n.HTMLFormElement,ze=n.DOMParser,De=n.trustedTypes,A=he.prototype,Le=Vc(A,"cloneNode"),He=Vc(A,"nextSibling"),Ie=Vc(A,"childNodes"),K=Vc(A,"parentNode");"function"==typeof Te&&(C=d.createElement("template"),C.content&&C.content.ownerDocument&&(d=C.content.ownerDocument));var u=wC(De,L),Z=u?u.createHTML(""):"",x=d,T=x.implementation,xe=x.createNodeIterator,Be=x.createDocumentFragment,Pe=x.getElementsByTagName,Se=L.importNode,pe={};try{pe=Ts(d).documentMode?d.documentMode:{}}catch{}a={},t.isSupported="function"==typeof K&&T&&void 0!==T.createHTMLDocument&&9!==pe;var t,n,a,m,j,O,C,W=mC,D=fC,Re=pC,Fe=gC,Ae=bC,je=jC,I=vC,o=null,fe=N({},[].concat(Qt(I0),Qt(el),Qt(Jc),Qt(Zc),Qt(k0))),i=null,de=N({},[].concat(Qt(E0),Qt(Qc),Qt(x0),Qt($c))),s=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),y=null,q=null,ee=!0,G=!0,J=!1,b=!1,h=!1,z=!1,Y=!1,v=!1,E=!1,k=!1,oe=!0,U=!0,_=!1,p={},f=null,Q=N({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),X=null,ue=N({},["audio","video","img","source","image","track"]),$=null,me=N({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),V="http://www.w3.org/1998/Math/MathML",B="http://www.w3.org/2000/svg",l="http://www.w3.org/1999/xhtml",S=l,be=!1,_e=["application/xhtml+xml","text/html"],Oe="text/html",g=null,we=d.createElement("form"),ye=function(e){return e instanceof RegExp||e instanceof Function},H=function(e){g&&g===e||(e&&"object"===oo(e)||(e={}),e=Ts(e),o="ALLOWED_TAGS"in e?N({},e.ALLOWED_TAGS):fe,i="ALLOWED_ATTR"in e?N({},e.ALLOWED_ATTR):de,$="ADD_URI_SAFE_ATTR"in e?N(Ts(me),e.ADD_URI_SAFE_ATTR):me,X="ADD_DATA_URI_TAGS"in e?N(Ts(ue),e.ADD_DATA_URI_TAGS):ue,f="FORBID_CONTENTS"in e?N({},e.FORBID_CONTENTS):Q,y="FORBID_TAGS"in e?N({},e.FORBID_TAGS):{},q="FORBID_ATTR"in e?N({},e.FORBID_ATTR):{},p="USE_PROFILES"in e&&e.USE_PROFILES,ee=!1!==e.ALLOW_ARIA_ATTR,G=!1!==e.ALLOW_DATA_ATTR,J=e.ALLOW_UNKNOWN_PROTOCOLS||!1,b=e.SAFE_FOR_TEMPLATES||!1,h=e.WHOLE_DOCUMENT||!1,v=e.RETURN_DOM||!1,E=e.RETURN_DOM_FRAGMENT||!1,k=e.RETURN_TRUSTED_TYPE||!1,Y=e.FORCE_BODY||!1,oe=!1!==e.SANITIZE_DOM,U=!1!==e.KEEP_CONTENT,_=e.IN_PLACE||!1,I=e.ALLOWED_URI_REGEXP||I,S=e.NAMESPACE||l,e.CUSTOM_ELEMENT_HANDLING&&ye(e.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(s.tagNameCheck=e.CUSTOM_ELEMENT_HANDLING.tagNameCheck),e.CUSTOM_ELEMENT_HANDLING&&ye(e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(s.attributeNameCheck=e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),e.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(s.allowCustomizedBuiltInElements=e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),j=j=-1===_e.indexOf(e.PARSER_MEDIA_TYPE)?Oe:e.PARSER_MEDIA_TYPE,m="application/xhtml+xml"===j?function(e){return e}:Bc,b&&(G=!1),E&&(v=!0),p&&(o=N({},Qt(k0)),i=[],!0===p.html&&(N(o,I0),N(i,E0)),!0===p.svg&&(N(o,el),N(i,Qc),N(i,$c)),!0===p.svgFilters&&(N(o,Jc),N(i,Qc),N(i,$c)),!0===p.mathMl&&(N(o,Zc),N(i,x0),N(i,$c))),e.ADD_TAGS&&(o===fe&&(o=Ts(o)),N(o,e.ADD_TAGS)),e.ADD_ATTR&&(i===de&&(i=Ts(i)),N(i,e.ADD_ATTR)),e.ADD_URI_SAFE_ATTR&&N($,e.ADD_URI_SAFE_ATTR),e.FORBID_CONTENTS&&(f===Q&&(f=Ts(f)),N(f,e.FORBID_CONTENTS)),U&&(o["#text"]=!0),h&&N(o,["html","head","body"]),o.table&&(N(o,["tbody"]),delete y.tbody),ct&&ct(e),g=e)},ve=N({},["mi","mo","mn","ms","mtext"]),ge=N({},["foreignobject","desc","title","annotation-xml"]),ke=N({},["title","style","font","a","script"]),M=N({},el);N(M,Jc),N(M,iC),O=N({},Zc),N(O,rC);var Me=function(e){t=K(e),t&&t.tagName||(t={namespaceURI:l,tagName:"template"});var t,n=Bc(e.tagName),s=Bc(t.tagName);return e.namespaceURI===B?t.namespaceURI===l?"svg"===n:t.namespaceURI===V?"svg"===n&&("annotation-xml"===s||ve[s]):Boolean(M[n]):e.namespaceURI===V?t.namespaceURI===l?"math"===n:t.namespaceURI===B?"math"===n&&ge[s]:Boolean(O[n]):e.namespaceURI===l&&!(t.namespaceURI===B&&!ge[s])&&!(t.namespaceURI===V&&!ve[s])&&!O[n]&&(ke[n]||!M[n])},c=function(e){vi(t.removed,{element:e});try{e.parentNode.removeChild(e)}catch{try{e.outerHTML=Z}catch{e.remove()}}},F=function(e,n){try{vi(t.removed,{attribute:n.getAttributeNode(e),from:n})}catch{vi(t.removed,{attribute:null,from:n})}if(n.removeAttribute(e),"is"===e&&!i[e])if(v||E)try{c(n)}catch{}else try{n.setAttribute(e,"")}catch{}},ce=function(e){if(Y)e="<remove></remove>"+e;else{var t,n,s,o,i=Kx(e,/^[\r\n\t ]+/);s=i&&i[0]}if("application/xhtml+xml"===j&&(e='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+e+"</body></html>"),o=u?u.createHTML(e):e,S===l)try{t=(new ze).parseFromString(o,j)}catch{}if(!t||!t.documentElement){t=T.createDocument(S,"template",null);try{t.documentElement.innerHTML=be?"":o}catch{}}return n=t.body||t.documentElement,e&&s&&n.insertBefore(d.createTextNode(s),n.childNodes[0]||null),S===l?Pe.call(t,h?"html":"body")[0]:h?t.documentElement:n},re=function(e){return xe.call(e.ownerDocument||e,e,P.SHOW_ELEMENT|P.SHOW_COMMENT|P.SHOW_TEXT,null,!1)},Ne=function(e){return e instanceof Ee&&("string"!=typeof e.nodeName||"string"!=typeof e.textContent||"function"!=typeof e.removeChild||!(e.attributes instanceof Ce)||"function"!=typeof e.removeAttribute||"function"!=typeof e.setAttribute||"string"!=typeof e.namespaceURI||"function"!=typeof e.insertBefore)},w=function(e){return"object"===oo(R)?e instanceof R:e&&"object"===oo(e)&&"number"==typeof e.nodeType&&"string"==typeof e.nodeName},r=function(e,n,s){a[e]&&Vx(a[e],function(e){e.call(t,n,s,g)})},ie=function(e){if(r("beforeSanitizeElements",e,null),Ne(e))return c(e),!0;if(st(/[\u0080-\uFFFF]/,e.nodeName))return c(e),!0;if(n=m(e.nodeName),r("uponSanitizeElement",e,{tagName:n,allowedTags:o}),e.hasChildNodes()&&!w(e.firstElementChild)&&(!w(e.content)||!w(e.content.firstElementChild))&&st(/<[/\w]/g,e.innerHTML)&&st(/<[/\w]/g,e.textContent))return c(e),!0;if("select"===n&&st(/<template/i,e.innerHTML))return c(e),!0;if(!o[n]||y[n]){if(!y[n]&&ne(n)){if(s.tagNameCheck instanceof RegExp&&st(s.tagNameCheck,n))return!1;if(s.tagNameCheck instanceof Function&&s.tagNameCheck(n))return!1}if(U&&!f[n]){var n,i,a,d=K(e)||e.parentNode,l=Ie(e)||e.childNodes;if(l&&d)for(a=l.length-1;a>=0;--a)d.insertBefore(Le(l[a],!0),He(e))}return c(e),!0}return e instanceof he&&!Me(e)?(c(e),!0):"noscript"!==n&&"noembed"!==n||!st(/<\/no(script|embed)/i,e.innerHTML)?(b&&3===e.nodeType&&(i=e.textContent,i=_s(i,W," "),i=_s(i,D," "),e.textContent!==i&&(vi(t.removed,{element:e.cloneNode()}),e.textContent=i)),r("afterSanitizeElements",e,null),!1):(c(e),!0)},se=function(e,t,n){if(oe&&("id"===t||"name"===t)&&(n in d||n in we))return!1;if(G&&!q[t]&&st(Re,t));else if(ee&&st(Fe,t));else if(!i[t]||q[t]){if(!(ne(e)&&(s.tagNameCheck instanceof RegExp&&st(s.tagNameCheck,e)||s.tagNameCheck instanceof Function&&s.tagNameCheck(e))&&(s.attributeNameCheck instanceof RegExp&&st(s.attributeNameCheck,t)||s.attributeNameCheck instanceof Function&&s.attributeNameCheck(t))||"is"===t&&s.allowCustomizedBuiltInElements&&(s.tagNameCheck instanceof RegExp&&st(s.tagNameCheck,n)||s.tagNameCheck instanceof Function&&s.tagNameCheck(n))))return!1}else if($[t]);else if(st(I,_s(n,je,"")));else if("src"!==t&&"xlink:href"!==t&&"href"!==t||"script"===e||0!==Yx(n,"data:")||!X[e])if(J&&!st(Ae,_s(n,je,"")));else if(n)return!1;return!0},ne=function(e){return e.indexOf("-")>0},te=function(e){if(r("beforeSanitizeAttributes",e,null),o=e.attributes,o){n={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:i};for(l=o.length;l--;){var t,n,o,a,c,l,h,f,d=a=o[l],s=d.name,u=d.namespaceURI;if(t="value"===s?a.value:Gx(a.value),c=m(s),h=t,n.attrName=c,n.attrValue=t,n.keepAttr=!0,n.forceKeepAttr=void 0,r("uponSanitizeAttribute",e,n),t=n.attrValue,!n.forceKeepAttr)if(n.keepAttr)if(st(/\/>/i,t))F(s,e);else if(b&&(t=_s(t,W," "),t=_s(t,D," ")),f=m(e.nodeName),se(f,c,t)){if(t!==h)try{u?e.setAttributeNS(u,s,t):e.setAttribute(s,t)}catch{F(s,e)}}else F(s,e);else F(s,e)}r("afterSanitizeAttributes",e,null)}},Ve=function e(t){var n,s=re(t);for(r("beforeSanitizeShadowDOM",t,null);n=s.nextNode();)r("uponSanitizeShadowNode",n,null),ie(n)||(n.content instanceof ae&&e(n.content),te(n));r("afterSanitizeShadowDOM",t,null)};return t.sanitize=function(e,s){if((be=!e)&&(e="<!-->"),"string"!=typeof e&&!w(e)){if("function"!=typeof e.toString)throw nl("toString is not a function");if("string"!=typeof(e=e.toString()))throw nl("dirty is not a string, aborting")}if(!t.isSupported){if("object"===oo(n.toStaticHTML)||"function"==typeof n.toStaticHTML){if("string"==typeof e)return n.toStaticHTML(e);if(w(e))return n.toStaticHTML(e.outerHTML)}return e}if(z||H(s),t.removed=[],"string"==typeof e&&(_=!1),_){if(e.nodeName){var a,r,l,d,f,p,j,g=m(e.nodeName);if(!o[g]||y[g])throw nl("root node is forbidden and cannot be sanitized in-place")}}else if(e instanceof R)1===(f=(a=ce("<!---->")).ownerDocument.importNode(e,!0)).nodeType&&"BODY"===f.nodeName||"HTML"===f.nodeName?a=f:a.appendChild(f);else{if(!v&&!b&&!h&&-1===e.indexOf("<"))return u&&k?u.createHTML(e):e;if(!(a=ce(e)))return v?null:k?Z:""}a&&Y&&c(a.firstChild);for(j=re(_?e:a);l=j.nextNode();)3===l.nodeType&&l===p||ie(l)||(l.content instanceof ae&&Ve(l.content),te(l),p=l);if(p=null,_)return e;if(v){if(E)for(d=Be.call(a.ownerDocument);a.firstChild;)d.appendChild(a.firstChild);else d=a;return i.shadowroot&&(d=Se.call(L,d,!0)),d}return r=h?a.outerHTML:a.innerHTML,h&&o["!doctype"]&&a.ownerDocument&&a.ownerDocument.doctype&&a.ownerDocument.doctype.name&&st(yC,a.ownerDocument.doctype.name)&&(r="<!DOCTYPE "+a.ownerDocument.doctype.name+`>
`+r),b&&(r=_s(r,W," "),r=_s(r,D," ")),u&&k?u.createHTML(r):r},t.setConfig=function(e){H(e),z=!0},t.clearConfig=function(){g=null,z=!1},t.isValidAttribute=function(e,t,n){g||H({});var s=m(e),o=m(t);return se(s,o,n)},t.addHook=function(e,t){"function"==typeof t&&(a[e]=a[e]||[],vi(a[e],t))},t.removeHook=function(e){if(a[e])return $x(a[e])},t.removeHooks=function(e){a[e]&&(a[e]=[])},t.removeAllHooks=function(){a={}},t}(),Kc;const xC=e=>OC().sanitize(e),CC=Wo.deviceType.isTouch(),w0=(e,t)=>({dom:{tag:"div",styles:{display:"none"},classes:["tox-dialog__header"]},components:[e,t]}),_0=(e,t)=>ae.parts.close(Je.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":t.translate("Close")}},action:e,buttonBehaviours:i([Z.config({})])})),y0=()=>ae.parts.title({dom:{tag:"div",classes:["tox-dialog__title"],innerHtml:"",styles:{display:"none"}}}),b0=(e,t)=>ae.parts.body({dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[{dom:ss(`<p>${xC(t.translate(e))}</p>`)}]}]}),g0=e=>ae.parts.footer({dom:{tag:"div",classes:["tox-dialog__footer"]},components:e}),p0=(e,t)=>[tn.sketch({dom:{tag:"div",classes:["tox-dialog__footer-start"]},components:e}),tn.sketch({dom:{tag:"div",classes:["tox-dialog__footer-end"]},components:t})],Xc=t=>{const n="tox-dialog",s=n+"-wrap",o=s+"__backdrop",a=n+"__disable-scroll";return ae.sketch({lazySink:t.lazySink,onEscape:n=>(t.onEscape(n),e.some(!0)),useTabstopAt:e=>!ra(e),dom:{tag:"div",classes:[n].concat(t.extraClasses),styles:{position:"relative",...t.extraStyles}},components:[t.header,t.body,...t.footer.toArray()],parts:{blocker:{dom:ss(`<div class="${s}"></div>`),components:[{dom:{tag:"div",classes:CC?[o,o+"--opaque"]:[o]}}]}},dragBlockClass:s,modalBehaviours:i([b.config({}),w("dialog-events",t.dialogEvents.concat([Ko(Ms(),(e)=>{u.focusIn(e)})])),w("scroll-lock",[Q(()=>{me(Hn(),a)}),_n(()=>{ie(Hn(),a)})]),...t.extraBehaviours]),eventOrder:{[ut()]:["dialog-events"],[Vs()]:["scroll-lock","dialog-events","alloy.base.behaviour"],[mi()]:["alloy.base.behaviour","dialog-events","scroll-lock"],...t.eventOrder}})},h0=e=>Je.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":e.translate("Close"),title:e.translate("Close")}},components:[gn("close",{tag:"div",classes:["tox-icon"]},e.icons)],action:e=>{T(e,vo)}}),d0=(e,t,n,s)=>({dom:{tag:"div",classes:["tox-dialog__title"],attributes:{...n.map(e=>({id:e})).getOr({})}},components:[],behaviours:i([rt.config({channel:`${w2}-${t}`,initialData:e,renderComponents:e=>[be(s.translate(e.title))]})])}),c0=()=>({dom:ss('<div class="tox-dialog__draghandle"></div>')}),r0=(t,n,s)=>((t,n,s)=>{const o=ae.parts.title(d0(t,n,e.none(),s)),i=ae.parts.draghandle(c0()),a=ae.parts.close(h0(s)),r=[o].concat(t.draggable?[i]:[]).concat([a]);return tn.sketch({dom:ss('<div class="tox-dialog__header"></div>'),components:r})})({title:s.shared.providers.translate(t),draggable:s.dialog.isDraggableModal()},n,s.shared.providers),a0=(e,t,n)=>({dom:{tag:"div",classes:["tox-dialog__busy-spinner"],attributes:{"aria-label":n.translate(e)},styles:{left:"0px",right:"0px",bottom:"0px",top:"0px",position:"absolute"}},behaviours:t,components:[{dom:ss('<div class="tox-spinner"><div></div><div></div><div></div></div>')}]}),i0=(e,t,n)=>({onClose:()=>n.closeWindow(),onBlock:n=>{ae.setBusy(e(),(e,s)=>a0(n.message,s,t))},onUnblock:()=>{ae.setIdle(e())}}),t0=(t,n,s,o)=>qe(Xc({...t,lazySink:o.shared.getSink,extraBehaviours:[rt.config({channel:`${ul}-${t.id}`,updateState:(t,n)=>e.some(n),initialData:n}),gr({}),...t.extraBehaviours],onEscape:e=>{T(e,vo)},dialogEvents:s,eventOrder:{[Ns()]:[rt.name(),Vt.name()],[Vs()]:["scroll-lock",rt.name(),"messages","dialog-events","alloy.base.behaviour"],[mi()]:["alloy.base.behaviour","dialog-events","messages",rt.name(),"scroll-lock"]}})),e0=e=>a(e,e=>"menu"===e.type?(e=>{const t=a(e.items,e=>({...e,storage:v(!1)}));return{...e,items:t}})(e):e),q4=e=>Ie(e,(e,t)=>"menu"===t.type?Ie(t.items,(e,t)=>(e[t.name]=t.storage,e),e):e,{}),$4=(e,t)=>[Fu(Ms(),Nv),e(Si,(e,n)=>{t.onClose(),n.onClose()}),e(vo,(e,t,n,s)=>{t.onCancel(e),T(s,Si)}),o(Cu,()=>t.onUnblock()),o(Eu,(e,n)=>t.onBlock(n.event))],B4=(e,t,n)=>{const s=(t,n)=>o(t,(t,s)=>{i(t,(o)=>{n(e(),o,s.event,t)})}),i=(e,t)=>{rt.getState(e).get().each(n=>{t(n.internalDialog,e)})};return[...$4(s,t),s(Ci,(e,t)=>t.onSubmit(e)),s(tt,(e,t,n)=>{t.onChange(e,{name:n.name})}),s(Kn,(e,t,s,o)=>{const i=()=>u.focusIn(o),a=e=>Km(e,"disabled")||_t(e,"aria-disabled").exists(e=>"true"===e),r=Tt(o.element),c=Wn(r);t.onAction(e,{name:s.name,value:s.value}),Wn(r).fold(i,e=>{a(e)||c.exists(t=>Zr(e,t)&&a(t))?i():n().toOptional().filter(t=>!Zr(t.element,e)).each(i)})}),s(W6,(e,t,n)=>{t.onTabChange(e,{newTabName:n.name,oldTabName:n.oldName})}),_n(t=>{const n=e();r.setValue(t,n.getData())})]},WC=(e,t)=>{const o=t.map(e=>e.footerButtons).getOr([]),n=n8(o,e=>"start"===e.align),s=(e,t)=>tn.sketch({dom:{tag:"div",classes:[`tox-dialog__footer-${e}`]},components:a(t,e=>e.memento.asSpec())});return[s("start",n.pass),s("end",n.fail)]},P4=(t,n,s)=>({dom:ss('<div class="tox-dialog__footer"></div>'),components:[],behaviours:i([rt.config({channel:`${b2}-${n}`,initialData:t,updateState:(t,n)=>{const o=a(n.buttons,e=>{const t=V(((e,t)=>Ha(e,e.type,t))(e,s));return{name:e.name,align:e.align,memento:t}});return e.some({lookupByName:e=>((e,t,n)=>ne(t,e=>e.name===n).bind(t=>t.memento.getOpt(e)))(t,o,e),footerButtons:o})},renderComponents:WC})])}),R4=(e,t,n)=>ae.parts.footer(P4(e,t,n)),L4=(t,n)=>{if(t.getRoot().getSystem().isConnected()){const e=O.getCurrent(t.getFormWrapper()).getOr(t.getFormWrapper());return Fo.getField(e,n).orThunk(()=>{const e=t.getFooter();return rt.getState(e).get().bind(e=>e.lookupByName(n))})}return e.none()},N4=(e,t,n)=>{const s=t=>{const n=e.getRoot();n.getSystem().isConnected()&&t(n)},o={getData:()=>{const t=e.getRoot(),s=t.getSystem().isConnected()?e.getFormWrapper():t;return{...r.getValue(s),...je(n,e=>e.get())}},setData:t=>{s(s=>{const a=o.getData(),i=te(a,t),c=((e,t)=>{const n=e.getRoot();return rt.getState(n).get().map(e=>an(X("data",e.dataValidator,t))).getOr(t)})(e,i),l=e.getFormWrapper();r.setValue(l,c),Re(n,(e,t)=>{R(i,t)&&e.set(i[t])})})},setEnabled:(t,n)=>{L4(e,t).each(n?g.enable:g.disable)},focus:t=>{L4(e,t).each(b.focus)},block:e=>{if(!L(e))throw new Error("The dialogInstanceAPI.block function should be passed a blocking message of type string as an argument");s(t=>{p(t,Eu,{message:e})})},unblock:()=>{s(e=>{T(e,Cu)})},showTab:t=>{s(n=>{const s=e.getBody();rt.getState(s).get().exists(e=>e.isTabPanel())&&O.getCurrent(s).each(e=>{li.showTab(e,t)})})},redial:n=>{s(s=>{const a=e.getId(),i=t(n);s.getSystem().broadcastOn([`${ul}-${a}`],i),s.getSystem().broadcastOn([`${w2}-${a}`],i.internalDialog),s.getSystem().broadcastOn([`${_2}-${a}`],i.internalDialog),s.getSystem().broadcastOn([`${b2}-${a}`],i.internalDialog),o.setData(i.initialData)})},close:()=>{s(e=>{T(e,Si)})}};return o};Kc=tinymce.util.Tools.resolve("tinymce.util.URI");const XC=["insertContent","setContent","execCommand","close","block","unblock"],S4=e=>os(e)&&-1!==XC.indexOf(e.mceAction),ZC=(t,n,s,a)=>{const m=d("dialog"),C=r0(t.title,m,a),x=(e=>{const t={dom:{tag:"div",classes:["tox-dialog__content-js"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-iframe"]},components:[f5({dom:{tag:"iframe",attributes:{src:e.url}},behaviours:i([Z.config({}),b.config({})])})]}],behaviours:i([u.config({mode:"acyclic",useTabstopAt:Ta(ra)})])};return ae.parts.body(t)})(t),g=t.buttons.bind(t=>0===t.length?e.none():e.some(R4({buttons:t},m,a))),_=((e,t)=>{const n=(t,n)=>o(t,(t,o)=>{s(t,(s)=>{n(e(),s,o.event,t)})}),s=(e,t)=>{rt.getState(e).get().each(n=>{t(n,e)})};return[...$4(n,t),n(Kn,(e,t,n)=>{t.onAction(e,{name:n.name})})]})(()=>c,i0(()=>h,a.shared.providers,n)),j={...t.height.fold(()=>({}),e=>({height:e+"px","max-height":e+"px"})),...t.width.fold(()=>({}),e=>({width:e+"px","max-width":e+"px"}))},v=t.width.isNone()&&t.height.isNone()?["tox-dialog--width-lg"]:[],r=new Kc(t.url,{base_uri:new Kc(window.location.href)}),y=`${r.protocol}://${r.host}${r.port?":"+r.port:""}`,f=ui(),O=[w("messages",[Q(()=>{const e=Ke(l(window),"message",e=>{if(r.isSameOrigin(new Kc(e.raw.origin))){const n=e.raw.data;S4(n)?((e,t,n)=>{switch(n.mceAction){case"insertContent":e.insertContent(n.content);break;case"setContent":e.setContent(n.content);break;case"execCommand":const s=!!Tn(n.ui)&&n.ui;e.execCommand(n.cmd,s,n.value);break;case"close":t.close();break;case"block":t.block(n.message);break;case"unblock":t.unblock()}})(s,c,n):(e=>!S4(e)&&os(e)&&R(e,"mceAction"))(n)&&t.onMessage(c,n)}});f.set(e)}),_n(f.clear)]),Vt.config({channels:{[g2]:{onReceive:(e,t)=>{pe(e.element,"iframe").each(e=>{const n=e.dom.contentWindow;Wt(n)&&n.postMessage(t,y)})}}}})],h=t0({id:m,header:C,body:x,footer:g,extraClasses:v,extraBehaviours:O,extraStyles:j},t,_,a),c=(e=>{const t=t=>{e.getSystem().isConnected()&&t(e)};return{block:e=>{if(!L(e))throw new Error("The urlDialogInstanceAPI.block function should be passed a blocking message of type string as an argument");t(t=>{p(t,Eu,{message:e})})},unblock:()=>{t(e=>{T(e,Cu)})},close:()=>{t(e=>{T(e,Si)})},sendMessage:e=>{t(t=>{t.getSystem().broadcastOn([g2],e)})}}})(h);return{dialog:h,instanceApi:c}},JC=(t,n,s)=>n&&s?[]:[He.config({contextual:{lazyContext:()=>e.some(it(l(t.getContentAreaContainer()))),fadeInClass:"tox-dialog-dock-fadein",fadeOutClass:"tox-dialog-dock-fadeout",transitionClass:"tox-dialog-dock-transition"},modes:["top"]})],eE=t=>{const s=t.editor,a=Oa(s),c=(t=>{const n=t.shared;return{open:(s,i)=>{const a=()=>{ae.hide(r),i()},c=V(Ha({name:"close-alert",text:"OK",primary:!0,buttonType:e.some("primary"),align:"end",enabled:!0,icon:e.none()},"cancel",t)),l=y0(),d=_0(a,n.providers),r=qe(Xc({lazySink:()=>n.getSink(),header:w0(l,d),body:b0(s,n.providers),footer:e.some(g0(p0([],[c.asSpec()]))),onEscape:a,extraClasses:["tox-alert-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[o(vo,a)],eventOrder:{}}));ae.show(r);const u=c.get(r);b.focus(u)}}})(t.backstages.dialog),l=(t=>{const n=t.shared;return{open:(s,i)=>{const a=e=>{ae.hide(r),i(e)},c=V(Ha({name:"yes",text:"Yes",primary:!0,buttonType:e.some("primary"),align:"end",enabled:!0,icon:e.none()},"submit",t)),l=Ha({name:"no",text:"No",primary:!1,buttonType:e.some("secondary"),align:"end",enabled:!0,icon:e.none()},"cancel",t),d=y0(),u=_0(()=>a(!1),n.providers),r=qe(Xc({lazySink:()=>n.getSink(),header:w0(d,u),body:b0(s,n.providers),footer:e.some(g0(p0([],[l,c.asSpec()]))),onEscape:()=>a(!1),extraClasses:["tox-confirm-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[o(vo,()=>a(!1)),o(Ci,()=>a(!0))],eventOrder:{}}));ae.show(r);const h=c.get(r);b.focus(h)}}})(t.backstages.dialog),h=(s,o)=>Mi.open((s,i,a)=>{const c=i,r=((t,s,o)=>{const a=d("dialog"),r=t.internalDialog,b=r0(r.title,a,o),g=((t,n,s)=>{const o=p2(t,n,e.none(),s,!1);return ae.parts.body(o)})({body:r.body,initialData:r.initialData},a,o),l=e0(r.buttons),h=q4(l),u=R4({buttons:l},a,o),m=B4(()=>c,i0(()=>i,o.shared.providers,s),o.shared.getSink),f=(e=>{switch(e){case"large":return["tox-dialog--width-lg"];case"medium":return["tox-dialog--width-md"];default:return[]}})(r.size),p={id:a,header:b,body:g,footer:e.some(u),extraClasses:f,extraBehaviours:[],extraStyles:{}},i=t0(p,t,m,o),v={getId:n(a),getRoot:n(i),getBody:()=>ae.getBody(i),getFooter:()=>ae.getFooter(i),getFormWrapper:()=>{const e=ae.getBody(i);return O.getCurrent(e).getOr(e)}},c=N4(v,s.redial,h);return{dialog:i,instanceApi:c}})({dataValidator:a,initialData:c,internalDialog:s},{redial:Mi.redial,closeWindow:()=>{ae.hide(r.dialog),o(r.instanceApi)}},t.backstages.dialog);return ae.show(r.dialog),r.instanceApi.setData(c),r.instanceApi},s),r=(r,c,l,h=!1)=>Mi.open((r,m,f)=>{const _=an(X("data",f,m)),g=q(),v=t.backstages.popup.shared.header.isPositionedAtTop(),x=()=>g.on(e=>{J.reposition(e),He.refresh(e)}),p=((t,s,o,a)=>{const c=d("dialog"),m=d("dialog-label"),f=d("dialog-content"),l=t.internalDialog,y=V(((t,n,s,o)=>tn.sketch({dom:ss('<div class="tox-dialog__header"></div>'),components:[d0(t,n,e.some(s),o),c0(),h0(o)],containerBehaviours:i([Qs.config({mode:"mouse",blockerClass:"blocker",getTarget:e=>hn(e,'[role="dialog"]').getOrDie(),snaps:{getSnapPoints:()=>[],leftAttr:"data-drag-left",topAttr:"data-drag-top"}})])}))({title:l.title,draggable:!0},c,m,o.shared.providers)),h=V(((t,n,s,o,i)=>p2(t,n,e.some(s),o,i))({body:l.body,initialData:l.initialData},c,f,o,a)),p=e0(l.buttons),_=q4(p),g=V(((e,t,n)=>P4(e,t,n))({buttons:p},c,o)),x=B4(()=>v,{onBlock:e=>{Jn.block(r,(t,n)=>a0(e.message,n,o.shared.providers))},onUnblock:()=>{Jn.unblock(r)},onClose:()=>s.closeWindow()},o.shared.getSink),r=qe({dom:{tag:"div",classes:["tox-dialog","tox-dialog-inline"],attributes:{role:"dialog","aria-labelledby":m,"aria-describedby":f}},eventOrder:{[Ns()]:[rt.name(),Vt.name()],[ut()]:["execute-on-form"],[Vs()]:["reflecting","execute-on-form"]},behaviours:i([u.config({mode:"cyclic",onEscape:t=>(T(t,Si),e.some(!0)),useTabstopAt:e=>!ra(e)&&("button"!==qn(e)||"disabled"!==Ne(e,"disabled"))}),rt.config({channel:`${ul}-${c}`,updateState:(t,n)=>e.some(n),initialData:t}),b.config({}),w("execute-on-form",x.concat([Ko(Ms(),(e)=>{u.focusIn(e)})])),Jn.config({getRoot:()=>e.some(r)}),j.config({}),gr({})]),components:[y.asSpec(),h.asSpec(),g.asSpec()]}),v=N4({getId:n(c),getRoot:n(r),getFooter:()=>g.get(r),getBody:()=>h.get(r),getFormWrapper:()=>{const e=h.get(r);return O.getCurrent(e).getOr(e)}},s.redial,_);return{dialog:r,instanceApi:v}})({dataValidator:f,initialData:_,internalDialog:r},{redial:Mi.redial,closeWindow:()=>{g.on(J.hide),s.off("ResizeEditor",x),g.clear(),l(p.instanceApi)}},t.backstages.popup,h),y=qe(J.sketch({lazySink:t.backstages.popup.shared.getSink,dom:{tag:"div",classes:[]},fireDismissalEventInstead:{},...v?{}:{fireRepositionEventInstead:{}},inlineBehaviours:i([w("window-manager-inline-events",[o(di(),()=>{T(p.dialog,vo)})]),...JC(s,a,v)]),isExtraPart:(e,t)=>(e=>Ni(e,".tox-alert-dialog")||Ni(e,".tox-confirm-dialog"))(t)}));return g.set(y),J.showWithin(y,Pt(p.dialog),{anchor:c},e.some(Hn())),a&&v||(He.refresh(y),s.on("ResizeEditor",x)),p.instanceApi.setData(_),u.focusIn(p.dialog),p.instanceApi},r);return{open:(e,n,s)=>void 0!==n&&"toolbar"===n.inline?r(e,t.backstages.popup.shared.anchors.inlineDialog(),s,n.ariaAttrs):void 0!==n&&"cursor"===n.inline?r(e,t.backstages.popup.shared.anchors.cursor(),s,n.ariaAttrs):h(e,s),openUrl:(e,n)=>((e,n)=>Mi.openUrl(e=>{const o=ZC(e,{closeWindow:()=>{ae.hide(o.dialog),n(o.instanceApi)}},s,t.backstages.dialog);return ae.show(o.dialog),o.instanceApi},e))(e,n),alert:(e,t)=>{c.open(e,t)},close:e=>{e.close()},confirm:(e,t)=>{l.open(e,t)}}};Jp.add("silver",t=>{(e=>{Q2(e),(e=>{const t=e.options.register,n=e=>ga(e,L)?{value:Gj(e),valid:!0}:{valid:!1,message:"Must be an array of strings."};t("color_map",{processor:n,default:["#BFEDD2","Light Green","#FBEEB8","Light Yellow","#F8CAC6","Light Red","#ECCAFA","Light Purple","#C2E0F4","Light Blue","#2DC26B","Green","#F1C40F","Yellow","#E03E2D","Red","#B96AD9","Purple","#3598DB","Blue","#169179","Dark Turquoise","#E67E23","Orange","#BA372A","Dark Red","#843FA1","Dark Purple","#236FA1","Dark Blue","#ECF0F1","Light Gray","#CED4D9","Medium Gray","#95A5A6","Gray","#7E8C8D","Dark Gray","#34495E","Navy Blue","#000000","Black","#ffffff","White"]}),t("color_map_background",{processor:n}),t("color_map_foreground",{processor:n}),t("color_cols",{processor:"number",default:Gu(Xi(e,"default").length)}),t("color_cols_foreground",{processor:"number",default:Gu(Xi(e,Ju).length)}),t("color_cols_background",{processor:"number",default:Gu(Xi(e,Qu).length)}),t("custom_colors",{processor:"boolean",default:!0}),t("color_default_foreground",{processor:"string",default:Yu}),t("color_default_background",{processor:"string",default:Yu})})(e),(e=>{const t=e.options.register;t("contextmenu_avoid_overlap",{processor:"string",default:""}),t("contextmenu_never_use_native",{processor:"boolean",default:!1}),t("contextmenu",{processor:e=>!1===e?{value:[],valid:!0}:L(e)||ga(e,L)?{value:s_(e),valid:!0}:{valid:!1,message:"Must be false or a string."},default:"link linkchecker image editimage table spellchecker configurepermanentpen"})})(e)})(t);const{dialogs:o,popups:s,renderUI:i}=jw(t);$b(t,s.backstage.shared);const a=eE({editor:t,backstages:{popup:s.backstage,dialog:o.backstage}});return{renderUI:i,getWindowManagerImpl:n(a),getNotificationManagerImpl:()=>((t,n,s)=>{const o=n.backstage.shared,i=()=>{const n=it(l(t.getContentAreaContainer())),s=Sn(),o=zt(s.x,n.x,n.right),i=zt(s.y,n.y,n.bottom),a=Math.max(n.right,s.right),r=Math.max(n.bottom,s.bottom);return e.some(Ve(o,i,a-o,r-i))};return{open:(n,a)=>{const d=()=>{a(),J.hide(c)},r=qe(i4.sketch({text:n.text,level:_e(["success","error","warning","warn","info"],n.type)?n.type:void 0,progress:!0===n.progressBar,icon:n.icon,closeButton:n.closeButton,onAction:d,iconProvider:o.providers.icons,translationProvider:o.providers.translate})),c=qe(J.sketch({dom:{tag:"div",classes:["tox-notifications-container"]},lazySink:o.getSink,fireDismissalEventInstead:{},...o.header.isPositionedAtTop()?{}:{fireRepositionEventInstead:{}}}));s.add(c),Ss(n.timeout)&&n.timeout>0&&ia.setEditorTimeout(t,()=>{d()},n.timeout);const u={close:d,reposition:()=>{const s=Pt(r),a={maxHeightFunction:gi()},n=t.notificationManager.getNotifications();if(n[0]===u){const e={...o.anchors.banner(),overrides:a};J.showWithinBounds(c,s,{anchor:e},i)}else x6(n,u).each(t=>{const o=n[t-1].getEl(),r={type:"node",root:Hn(),node:e.some(l(o)),overrides:a,layouts:{onRtl:()=>[ke],onLtr:()=>[ke]}};J.showWithinBounds(c,s,{anchor:r},i)})},text:e=>{i4.updateText(r,e)},settings:n,getEl:()=>r.element.dom,progressBar:{value:e=>{i4.updateProgress(r,e)}}};return u},close:e=>{e.close()},getArgs:e=>e.settings}})(t,{backstage:s.backstage},s.getMothership())}})}()